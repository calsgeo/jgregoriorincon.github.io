!function(a,b){function c(a){var b=a.length,c=ia.type(a);return ia.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function d(a){var b=xa[a]={};return ia.each(a.match(ka)||[],function(a,c){b[c]=!0}),b}function e(a,c,d,e){if(ia.acceptData(a)){var f,g,h=ia.expando,i="string"==typeof c,j=a.nodeType,k=j?ia.cache:a,l=j?a[h]:a[h]&&h;if(l&&k[l]&&(e||k[l].data)||!i||d!==b)return l||(j?a[h]=l=_.pop()||ia.guid++:l=h),k[l]||(k[l]={},j||(k[l].toJSON=ia.noop)),("object"==typeof c||"function"==typeof c)&&(e?k[l]=ia.extend(k[l],c):k[l].data=ia.extend(k[l].data,c)),f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[ia.camelCase(c)]=d),i?(g=f[c],null==g&&(g=f[ia.camelCase(c)])):g=f,g}}function f(a,b,c){if(ia.acceptData(a)){var d,e,f,g=a.nodeType,i=g?ia.cache:a,j=g?a[ia.expando]:ia.expando;if(i[j]){if(b&&(f=c?i[j]:i[j].data)){ia.isArray(b)?b=b.concat(ia.map(b,ia.camelCase)):b in f?b=[b]:(b=ia.camelCase(b),b=b in f?[b]:b.split(" "));for(d=0,e=b.length;e>d;d++)delete f[b[d]];if(!(c?h:ia.isEmptyObject)(f))return}(c||(delete i[j].data,h(i[j])))&&(g?ia.cleanData([a],!0):ia.support.deleteExpando||i!=i.window?delete i[j]:i[j]=null)}}}function g(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(za,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:ya.test(d)?ia.parseJSON(d):d}catch(f){}ia.data(a,c,d)}else d=b}return d}function h(a){var b;for(b in a)if(("data"!==b||!ia.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function i(){return!0}function j(){return!1}function k(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}function l(a,b,c){if(b=b||0,ia.isFunction(b))return ia.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return ia.grep(a,function(a){return a===b===c});if("string"==typeof b){var d=ia.grep(a,function(a){return 1===a.nodeType});if(Ra.test(b))return ia.filter(b,d,!c);b=ia.filter(b,d)}return ia.grep(a,function(a){return ia.inArray(a,b)>=0===c})}function m(a){var b=Ua.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function n(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function o(a){var b=a.getAttributeNode("type");return a.type=(b&&b.specified)+"/"+a.type,a}function p(a){var b=eb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function q(a,b){for(var c,d=0;null!=(c=a[d]);d++)ia._data(c,"globalEval",!b||ia._data(b[d],"globalEval"))}function r(a,b){if(1===b.nodeType&&ia.hasData(a)){var c,d,e,f=ia._data(a),g=ia._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)ia.event.add(b,c,h[c][d])}g.data&&(g.data=ia.extend({},g.data))}}function s(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!ia.support.noCloneEvent&&b[ia.expando]){e=ia._data(b);for(d in e.events)ia.removeEvent(b,d,e.handle);b.removeAttribute(ia.expando)}"script"===c&&b.text!==a.text?(o(b).text=a.text,p(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),ia.support.html5Clone&&a.innerHTML&&!ia.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&bb.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}function t(a,c){var d,e,f=0,g=typeof a.getElementsByTagName!==V?a.getElementsByTagName(c||"*"):typeof a.querySelectorAll!==V?a.querySelectorAll(c||"*"):b;if(!g)for(g=[],d=a.childNodes||a;null!=(e=d[f]);f++)!c||ia.nodeName(e,c)?g.push(e):ia.merge(g,t(e,c));return c===b||c&&ia.nodeName(a,c)?ia.merge([a],g):g}function u(a){bb.test(a.type)&&(a.defaultChecked=a.checked)}function v(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=yb.length;e--;)if(b=yb[e]+c,b in a)return b;return d}function w(a,b){return a=b||a,"none"===ia.css(a,"display")||!ia.contains(a.ownerDocument,a)}function x(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=ia._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&w(d)&&(f[g]=ia._data(d,"olddisplay",B(d.nodeName)))):f[g]||(e=w(d),(c&&"none"!==c||!e)&&ia._data(d,"olddisplay",e?c:ia.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function y(a,b,c){var d=rb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=ia.css(a,c+xb[f],!0,e)),d?("content"===c&&(g-=ia.css(a,"padding"+xb[f],!0,e)),"margin"!==c&&(g-=ia.css(a,"border"+xb[f]+"Width",!0,e))):(g+=ia.css(a,"padding"+xb[f],!0,e),"padding"!==c&&(g+=ia.css(a,"border"+xb[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=kb(a),g=ia.support.boxSizing&&"border-box"===ia.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=lb(a,b,f),(0>e||null==e)&&(e=a.style[b]),sb.test(e))return e;d=g&&(ia.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a){var b=W,c=ub[a];return c||(c=C(a,b),"none"!==c&&c||(jb=(jb||ia("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(jb[0].contentWindow||jb[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=C(a,b),jb.detach()),ub[a]=c),c}function C(a,b){var c=ia(b.createElement(a)).appendTo(b.body),d=ia.css(c[0],"display");return c.remove(),d}function D(a,b,c,d){var e;if(ia.isArray(b))ia.each(b,function(b,e){c||Ab.test(a)?d(a,e):D(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==ia.type(b))d(a,b);else for(e in b)D(a+"["+e+"]",b[e],c,d)}function E(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ka)||[];if(ia.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function F(a,c,d,e){function f(i){var j;return g[i]=!0,ia.each(a[i]||[],function(a,i){var k=i(c,d,e);return"string"!=typeof k||h||g[k]?h?!(j=k):b:(c.dataTypes.unshift(k),f(k),!1)}),j}var g={},h=a===Rb;return f(c.dataTypes[0])||!g["*"]&&f("*")}function G(a,c){var d,e,f=ia.ajaxSettings.flatOptions||{};for(e in c)c[e]!==b&&((f[e]?a:d||(d={}))[e]=c[e]);return d&&ia.extend(!0,a,d),a}function H(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(h in k)h in d&&(c[k[h]]=d[h]);for(;"*"===j[0];)j.shift(),f===b&&(f=a.mimeType||c.getResponseHeader("Content-Type"));if(f)for(h in i)if(i[h]&&i[h].test(f)){j.unshift(h);break}if(j[0]in d)g=j[0];else{for(h in d){if(!j[0]||a.converters[h+" "+j[0]]){g=h;break}e||(e=h)}g=g||e}return g?(g!==j[0]&&j.unshift(g),d[g]):b}function I(a,b){var c,d,e,f,g={},h=0,i=a.dataTypes.slice(),j=i[0];if(a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i[1])for(e in a.converters)g[e.toLowerCase()]=a.converters[e];for(;d=i[++h];)if("*"!==d){if("*"!==j&&j!==d){if(e=g[j+" "+d]||g["* "+d],!e)for(c in g)if(f=c.split(" "),f[1]===d&&(e=g[j+" "+f[0]]||g["* "+f[0]])){e===!0?e=g[c]:g[c]!==!0&&(d=f[0],i.splice(h--,0,d));break}if(e!==!0)if(e&&a["throws"])b=e(b);else try{b=e(b)}catch(k){return{state:"parsererror",error:e?k:"No conversion from "+j+" to "+d}}}j=d}return{state:"success",data:b}}function J(){try{return new a.XMLHttpRequest}catch(b){}}function K(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function L(){return setTimeout(function(){$b=b}),$b=ia.now()}function M(a,b){ia.each(b,function(b,c){for(var d=(ec[b]||[]).concat(ec["*"]),e=0,f=d.length;f>e;e++)if(d[e].call(a,b,c))return})}function N(a,b,c){var d,e,f=0,g=dc.length,h=ia.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$b||L(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:ia.extend({},b),opts:ia.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$b||L(),duration:c.duration,tweens:[],createTween:function(b,c){var d=ia.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(O(k,j.opts.specialEasing);g>f;f++)if(d=dc[f].call(j,a,k,j.opts))return d;return M(j,k),ia.isFunction(j.opts.start)&&j.opts.start.call(a,j),ia.fx.timer(ia.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function O(a,b){var c,d,e,f,g;for(e in a)if(d=ia.camelCase(e),f=b[d],c=a[e],ia.isArray(c)&&(f=c[1],c=a[e]=c[0]),e!==d&&(a[d]=c,delete a[e]),g=ia.cssHooks[d],g&&"expand"in g){c=g.expand(c),delete a[d];for(e in c)e in a||(a[e]=c[e],b[e]=f)}else b[d]=f}function P(a,b,c){var d,e,f,g,h,i,j,k,l,m=this,n=a.style,o={},p=[],q=a.nodeType&&w(a);c.queue||(k=ia._queueHooks(a,"fx"),null==k.unqueued&&(k.unqueued=0,l=k.empty.fire,k.empty.fire=function(){k.unqueued||l()}),k.unqueued++,m.always(function(){m.always(function(){k.unqueued--,ia.queue(a,"fx").length||k.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],"inline"===ia.css(a,"display")&&"none"===ia.css(a,"float")&&(ia.support.inlineBlockNeedsLayout&&"inline"!==B(a.nodeName)?n.zoom=1:n.display="inline-block")),c.overflow&&(n.overflow="hidden",ia.support.shrinkWrapBlocks||m.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(e in b)if(g=b[e],ac.exec(g)){if(delete b[e],i=i||"toggle"===g,g===(q?"hide":"show"))continue;p.push(e)}if(f=p.length){h=ia._data(a,"fxshow")||ia._data(a,"fxshow",{}),"hidden"in h&&(q=h.hidden),i&&(h.hidden=!q),q?ia(a).show():m.done(function(){ia(a).hide()}),m.done(function(){var b;ia._removeData(a,"fxshow");for(b in o)ia.style(a,b,o[b])});for(e=0;f>e;e++)d=p[e],j=m.createTween(d,q?h[d]:0),o[d]=h[d]||ia.style(a,d),d in h||(h[d]=j.start,q&&(j.end=j.start,j.start="width"===d||"height"===d?1:0))}}function Q(a,b,c,d,e){return new Q.prototype.init(a,b,c,d,e)}function R(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=xb[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function S(a){return ia.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var T,U,V=typeof b,W=a.document,X=a.location,Y=a.jQuery,Z=a.$,$={},_=[],aa="1.9.1",ba=_.concat,ca=_.push,da=_.slice,ea=_.indexOf,fa=$.toString,ga=$.hasOwnProperty,ha=aa.trim,ia=function(a,b){return new ia.fn.init(a,b,U)},ja=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ka=/\S+/g,la=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ma=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,na=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,oa=/^[\],:{}\s]*$/,pa=/(?:^|:|,)(?:\s*\[)+/g,qa=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ra=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,sa=/^-ms-/,ta=/-([\da-z])/gi,ua=function(a,b){return b.toUpperCase()},va=function(a){(W.addEventListener||"load"===a.type||"complete"===W.readyState)&&(wa(),ia.ready())},wa=function(){W.addEventListener?(W.removeEventListener("DOMContentLoaded",va,!1),a.removeEventListener("load",va,!1)):(W.detachEvent("onreadystatechange",va),a.detachEvent("onload",va))};ia.fn=ia.prototype={jquery:aa,constructor:ia,init:function(a,c,d){var e,f;if(!a)return this;if("string"==typeof a){if(e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:ma.exec(a),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof ia?c[0]:c,ia.merge(this,ia.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:W,!0)),na.test(e[1])&&ia.isPlainObject(c))for(e in c)ia.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}if(f=W.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1,this[0]=f}return this.context=W,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):ia.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),ia.makeArray(a,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return da.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){var b=ia.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return ia.each(this,a,b)},ready:function(a){return ia.ready.promise().done(a),this},slice:function(){return this.pushStack(da.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},map:function(a){return this.pushStack(ia.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:ca,sort:[].sort,splice:[].splice},ia.fn.init.prototype=ia.fn,ia.extend=ia.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"==typeof h||ia.isFunction(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(f=arguments[i]))for(e in f)a=h[e],d=f[e],h!==d&&(k&&d&&(ia.isPlainObject(d)||(c=ia.isArray(d)))?(c?(c=!1,g=a&&ia.isArray(a)?a:[]):g=a&&ia.isPlainObject(a)?a:{},h[e]=ia.extend(k,g,d)):d!==b&&(h[e]=d));return h},ia.extend({noConflict:function(b){return a.$===ia&&(a.$=Z),b&&a.jQuery===ia&&(a.jQuery=Y),ia},isReady:!1,readyWait:1,holdReady:function(a){a?ia.readyWait++:ia.ready(!0)},ready:function(a){if(a===!0?!--ia.readyWait:!ia.isReady){if(!W.body)return setTimeout(ia.ready);ia.isReady=!0,a!==!0&&--ia.readyWait>0||(T.resolveWith(W,[ia]),ia.fn.trigger&&ia(W).trigger("ready").off("ready"))}},isFunction:function(a){return"function"===ia.type(a)},isArray:Array.isArray||function(a){return"array"===ia.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?$[fa.call(a)]||"object":typeof a},isPlainObject:function(a){if(!a||"object"!==ia.type(a)||a.nodeType||ia.isWindow(a))return!1;try{if(a.constructor&&!ga.call(a,"constructor")&&!ga.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||ga.call(a,d)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw Error(a)},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||W;var d=na.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=ia.buildFragment([a],b,e),e&&ia(e).remove(),ia.merge([],d.childNodes))},parseJSON:function(c){return a.JSON&&a.JSON.parse?a.JSON.parse(c):null===c?c:"string"==typeof c&&(c=ia.trim(c),c&&oa.test(c.replace(qa,"@").replace(ra,"]").replace(pa,"")))?Function("return "+c)():(ia.error("Invalid JSON: "+c),b)},parseXML:function(c){var d,e;if(!c||"string"!=typeof c)return null;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return d&&d.documentElement&&!d.getElementsByTagName("parsererror").length||ia.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&ia.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(sa,"ms-").replace(ta,ua)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:ha&&!ha.call("\ufeff ")?function(a){return null==a?"":ha.call(a)}:function(a){return null==a?"":(a+"").replace(la,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?ia.merge(d,"string"==typeof a?[a]:a):ca.call(d,a)),d},inArray:function(a,b,c){var d;if(b){if(ea)return ea.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&(i[i.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(i[i.length]=e);return ba.apply([],i)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(f=a[c],c=a,a=f),ia.isFunction(a)?(d=da.call(arguments,2),e=function(){return a.apply(c||this,d.concat(da.call(arguments)))},e.guid=a.guid=a.guid||ia.guid++,e):b},access:function(a,c,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===ia.type(d)){f=!0;for(i in d)ia.access(a,c,i,d[i],!0,g,h)}else if(e!==b&&(f=!0,ia.isFunction(e)||(h=!0),k&&(h?(c.call(a,e),c=null):(k=c,c=function(a,b,c){return k.call(ia(a),c)})),c))for(;j>i;i++)c(a[i],d,h?e:e.call(a[i],i,c(a[i],d)));return f?a:k?c.call(a):j?c(a[0],d):g},now:function(){return(new Date).getTime()}}),ia.ready.promise=function(b){if(!T)if(T=ia.Deferred(),"complete"===W.readyState)setTimeout(ia.ready);else if(W.addEventListener)W.addEventListener("DOMContentLoaded",va,!1),a.addEventListener("load",va,!1);else{W.attachEvent("onreadystatechange",va),a.attachEvent("onload",va);var c=!1;try{c=null==a.frameElement&&W.documentElement}catch(d){}c&&c.doScroll&&function e(){if(!ia.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}wa(),ia.ready()}}()}return T.promise(b)},ia.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){$["[object "+b+"]"]=b.toLowerCase()}),U=ia(W);var xa={};ia.Callbacks=function(a){a="string"==typeof a?xa[a]||d(a):ia.extend({},a);var c,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(e=a.memory&&b,f=!0,h=i||0,i=0,g=j.length,c=!0;j&&g>h;h++)if(j[h].apply(b[0],b[1])===!1&&a.stopOnFalse){e=!1;break}c=!1,j&&(k?k.length&&l(k.shift()):e?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function d(b){ia.each(b,function(b,c){var e=ia.type(c);"function"===e?a.unique&&m.has(c)||j.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),c?g=j.length:e&&(i=b,l(e))}return this},remove:function(){return j&&ia.each(arguments,function(a,b){for(var d;(d=ia.inArray(b,j,d))>-1;)j.splice(d,1),c&&(g>=d&&g--,h>=d&&h--)}),this},has:function(a){return a?ia.inArray(a,j)>-1:!(!j||!j.length)},empty:function(){return j=[],this},disable:function(){return j=k=e=b,this},disabled:function(){return!j},lock:function(){return k=b,e||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],!j||f&&!k||(c?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!f}};return m},ia.extend({Deferred:function(a){var b=[["resolve","done",ia.Callbacks("once memory"),"resolved"],["reject","fail",ia.Callbacks("once memory"),"rejected"],["notify","progress",ia.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return ia.Deferred(function(c){ia.each(b,function(b,f){var g=f[0],h=ia.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&ia.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?ia.extend(a,d):d}},e={};return d.pipe=d.then,ia.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=da.call(arguments),g=f.length,h=1!==g||a&&ia.isFunction(a.promise)?g:0,i=1===h?a:ia.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?da.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=Array(g),c=Array(g),d=Array(g);g>e;e++)f[e]&&ia.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}}),ia.support=function(){var b,c,d,e,f,g,h,i,j,k,l=W.createElement("div");if(l.setAttribute("className","t"),l.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=l.getElementsByTagName("*"),d=l.getElementsByTagName("a")[0],!c||!d||!c.length)return{};f=W.createElement("select"),h=f.appendChild(W.createElement("option")),e=l.getElementsByTagName("input")[0],d.style.cssText="top:1px;float:left;opacity:.5",b={getSetAttribute:"t"!==l.className,leadingWhitespace:3===l.firstChild.nodeType,tbody:!l.getElementsByTagName("tbody").length,htmlSerialize:!!l.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:!!e.value,optSelected:h.selected,enctype:!!W.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==W.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===W.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},e.checked=!0,b.noCloneChecked=e.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!h.disabled;try{delete l.test}catch(m){b.deleteExpando=!1}e=W.createElement("input"),e.setAttribute("value",""),b.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),b.radioValue="t"===e.value,e.setAttribute("checked","t"),e.setAttribute("name","t"),g=W.createDocumentFragment(),g.appendChild(e),b.appendChecked=e.checked,b.checkClone=g.cloneNode(!0).cloneNode(!0).lastChild.checked,l.attachEvent&&(l.attachEvent("onclick",function(){b.noCloneEvent=!1}),l.cloneNode(!0).click());for(k in{submit:!0,change:!0,focusin:!0})l.setAttribute(i="on"+k,"t"),b[k+"Bubbles"]=i in a||l.attributes[i].expando===!1;return l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===l.style.backgroundClip,ia(function(){var c,d,e,f="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",g=W.getElementsByTagName("body")[0];g&&(c=W.createElement("div"),c.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(c).appendChild(l),l.innerHTML="<table><tr><td></td><td>t</td></tr></table>",e=l.getElementsByTagName("td"),e[0].style.cssText="padding:0;margin:0;border:0;display:none",j=0===e[0].offsetHeight,e[0].style.display="",e[1].style.display="none",b.reliableHiddenOffsets=j&&0===e[0].offsetHeight,l.innerHTML="",l.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=4===l.offsetWidth,b.doesNotIncludeMarginInBodyOffset=1!==g.offsetTop,a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(l,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(l,null)||{width:"4px"}).width,d=l.appendChild(W.createElement("div")),d.style.cssText=l.style.cssText=f,d.style.marginRight=d.style.width="0",l.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),typeof l.style.zoom!==V&&(l.innerHTML="",l.style.cssText=f+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=3===l.offsetWidth,l.style.display="block",l.innerHTML="<div></div>",l.firstChild.style.width="5px",b.shrinkWrapBlocks=3!==l.offsetWidth,b.inlineBlockNeedsLayout&&(g.style.zoom=1)),g.removeChild(c),c=l=e=d=null)}),c=f=g=h=d=e=null,b}();var ya=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,za=/([A-Z])/g;ia.extend({cache:{},expando:"jQuery"+(aa+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?ia.cache[a[ia.expando]]:a[ia.expando],!!a&&!h(a)},data:function(a,b,c){return e(a,b,c)},removeData:function(a,b){return f(a,b)},_data:function(a,b,c){return e(a,b,c,!0)},_removeData:function(a,b){return f(a,b,!0)},acceptData:function(a){if(a.nodeType&&1!==a.nodeType&&9!==a.nodeType)return!1;var b=a.nodeName&&ia.noData[a.nodeName.toLowerCase()];return!b||b!==!0&&a.getAttribute("classid")===b}}),ia.fn.extend({data:function(a,c){var d,e,f=this[0],h=0,i=null;if(a===b){if(this.length&&(i=ia.data(f),1===f.nodeType&&!ia._data(f,"parsedAttrs"))){for(d=f.attributes;d.length>h;h++)e=d[h].name,e.indexOf("data-")||(e=ia.camelCase(e.slice(5)),g(f,e,i[e]));ia._data(f,"parsedAttrs",!0)}return i}return"object"==typeof a?this.each(function(){ia.data(this,a)}):ia.access(this,function(c){return c===b?f?g(f,a,ia.data(f,a)):null:(this.each(function(){ia.data(this,a,c)}),b)},null,c,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){ia.removeData(this,a)})}}),ia.extend({queue:function(a,c,d){var e;return a?(c=(c||"fx")+"queue",e=ia._data(a,c),d&&(!e||ia.isArray(d)?e=ia._data(a,c,ia.makeArray(d)):e.push(d)),e||[]):b},dequeue:function(a,b){b=b||"fx";var c=ia.queue(a,b),d=c.length,e=c.shift(),f=ia._queueHooks(a,b),g=function(){ia.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),f.cur=e,e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return ia._data(a,c)||ia._data(a,c,{empty:ia.Callbacks("once memory").add(function(){ia._removeData(a,b+"queue"),ia._removeData(a,c)})})}}),ia.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),d>arguments.length?ia.queue(this[0],a):c===b?this:this.each(function(){var b=ia.queue(this,a,c);ia._queueHooks(this,a),"fx"===a&&"inprogress"!==b[0]&&ia.dequeue(this,a)})},dequeue:function(a){return this.each(function(){ia.dequeue(this,a)})},delay:function(a,b){return a=ia.fx?ia.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=ia.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(c=a,a=b),a=a||"fx";h--;)d=ia._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var Aa,Ba,Ca=/[\t\r\n]/g,Da=/\r/g,Ea=/^(?:input|select|textarea|button|object)$/i,Fa=/^(?:a|area)$/i,Ga=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Ha=/^(?:checked|selected)$/i,Ia=ia.support.getSetAttribute,Ja=ia.support.input;ia.fn.extend({attr:function(a,b){return ia.access(this,ia.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){ia.removeAttr(this,a)})},prop:function(a,b){return ia.access(this,ia.prop,a,b,arguments.length>1)},removeProp:function(a){return a=ia.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length,i="string"==typeof a&&a;if(ia.isFunction(a))return this.each(function(b){ia(this).addClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(ka)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ca," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=ia.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length,i=0===arguments.length||"string"==typeof a&&a;if(ia.isFunction(a))return this.each(function(b){ia(this).removeClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(ka)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(Ca," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");c.className=a?ia.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return ia.isFunction(a)?this.each(function(c){ia(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,g=ia(this),h=b,i=a.match(ka)||[];e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else(c===V||"boolean"===c)&&(this.className&&ia._data(this,"__className__",this.className),this.className=this.className||a===!1?"":ia._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(Ca," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];return arguments.length?(e=ia.isFunction(a),this.each(function(c){var f,g=ia(this);1===this.nodeType&&(f=e?a.call(this,c,g.val()):a,null==f?f="":"number"==typeof f?f+="":ia.isArray(f)&&(f=ia.map(f,function(a){return null==a?"":a+""})),d=ia.valHooks[this.type]||ia.valHooks[this.nodeName.toLowerCase()],d&&"set"in d&&d.set(this,f,"value")!==b||(this.value=f))})):f?(d=ia.valHooks[f.type]||ia.valHooks[f.nodeName.toLowerCase()],d&&"get"in d&&(c=d.get(f,"value"))!==b?c:(c=f.value,"string"==typeof c?c.replace(Da,""):null==c?"":c)):void 0}}),ia.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(ia.support.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&ia.nodeName(c.parentNode,"optgroup"))){if(b=ia(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c=ia.makeArray(b);return ia(a).find("option").each(function(){this.selected=ia.inArray(ia(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attr:function(a,c,d){var e,f,g,h=a.nodeType;return a&&3!==h&&8!==h&&2!==h?typeof a.getAttribute===V?ia.prop(a,c,d):(f=1!==h||!ia.isXMLDoc(a),f&&(c=c.toLowerCase(),e=ia.attrHooks[c]||(Ga.test(c)?Ba:Aa)),d===b?e&&f&&"get"in e&&null!==(g=e.get(a,c))?g:(typeof a.getAttribute!==V&&(g=a.getAttribute(c)),null==g?b:g):null!==d?e&&f&&"set"in e&&(g=e.set(a,d,c))!==b?g:(a.setAttribute(c,d+""),d):(ia.removeAttr(a,c),b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ka);if(f&&1===a.nodeType)for(;c=f[e++];)d=ia.propFix[c]||c,Ga.test(c)?!Ia&&Ha.test(c)?a[ia.camelCase("default-"+c)]=a[d]=!1:a[d]=!1:ia.attr(a,c,""),a.removeAttribute(Ia?c:d)},attrHooks:{type:{set:function(a,b){if(!ia.support.radioValue&&"radio"===b&&ia.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;return a&&3!==h&&8!==h&&2!==h?(g=1!==h||!ia.isXMLDoc(a),g&&(c=ia.propFix[c]||c,f=ia.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]):void 0},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):Ea.test(a.nodeName)||Fa.test(a.nodeName)&&a.href?0:b}}}}),Ba={get:function(a,c){var d=ia.prop(a,c),e="boolean"==typeof d&&a.getAttribute(c),f="boolean"==typeof d?Ja&&Ia?null!=e:Ha.test(c)?a[ia.camelCase("default-"+c)]:!!e:a.getAttributeNode(c);return f&&f.value!==!1?c.toLowerCase():b;
},set:function(a,b,c){return b===!1?ia.removeAttr(a,c):Ja&&Ia||!Ha.test(c)?a.setAttribute(!Ia&&ia.propFix[c]||c,c):a[ia.camelCase("default-"+c)]=a[c]=!0,c}},Ja&&Ia||(ia.attrHooks.value={get:function(a,c){var d=a.getAttributeNode(c);return ia.nodeName(a,"input")?a.defaultValue:d&&d.specified?d.value:b},set:function(a,c,d){return ia.nodeName(a,"input")?(a.defaultValue=c,b):Aa&&Aa.set(a,c,d)}}),Ia||(Aa=ia.valHooks.button={get:function(a,c){var d=a.getAttributeNode(c);return d&&("id"===c||"name"===c||"coords"===c?""!==d.value:d.specified)?d.value:b},set:function(a,c,d){var e=a.getAttributeNode(d);return e||a.setAttributeNode(e=a.ownerDocument.createAttribute(d)),e.value=c+="","value"===d||c===a.getAttribute(d)?c:b}},ia.attrHooks.contenteditable={get:Aa.get,set:function(a,b,c){Aa.set(a,""===b?!1:b,c)}},ia.each(["width","height"],function(a,c){ia.attrHooks[c]=ia.extend(ia.attrHooks[c],{set:function(a,d){return""===d?(a.setAttribute(c,"auto"),d):b}})})),ia.support.hrefNormalized||(ia.each(["href","src","width","height"],function(a,c){ia.attrHooks[c]=ia.extend(ia.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return null==d?b:d}})}),ia.each(["href","src"],function(a,b){ia.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}})),ia.support.style||(ia.attrHooks.style={get:function(a){return a.style.cssText||b},set:function(a,b){return a.style.cssText=b+""}}),ia.support.optSelected||(ia.propHooks.selected=ia.extend(ia.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),ia.support.enctype||(ia.propFix.enctype="encoding"),ia.support.checkOn||ia.each(["radio","checkbox"],function(){ia.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}}),ia.each(["radio","checkbox"],function(){ia.valHooks[this]=ia.extend(ia.valHooks[this],{set:function(a,c){return ia.isArray(c)?a.checked=ia.inArray(ia(a).val(),c)>=0:b}})});var Ka=/^(?:input|select|textarea)$/i,La=/^key/,Ma=/^(?:mouse|contextmenu)|click/,Na=/^(?:focusinfocus|focusoutblur)$/,Oa=/^([^.]*)(?:\.(.+)|)$/;ia.event={global:{},add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=ia._data(a);if(r){for(d.handler&&(j=d,d=j.handler,f=j.selector),d.guid||(d.guid=ia.guid++),(h=r.events)||(h=r.events={}),(l=r.handle)||(l=r.handle=function(a){return typeof ia===V||a&&ia.event.triggered===a.type?b:ia.event.dispatch.apply(l.elem,arguments)},l.elem=a),c=(c||"").match(ka)||[""],i=c.length;i--;)g=Oa.exec(c[i])||[],o=q=g[1],p=(g[2]||"").split(".").sort(),k=ia.event.special[o]||{},o=(f?k.delegateType:k.bindType)||o,k=ia.event.special[o]||{},m=ia.extend({type:o,origType:q,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&ia.expr.match.needsContext.test(f),namespace:p.join(".")},j),(n=h[o])||(n=h[o]=[],n.delegateCount=0,k.setup&&k.setup.call(a,e,p,l)!==!1||(a.addEventListener?a.addEventListener(o,l,!1):a.attachEvent&&a.attachEvent("on"+o,l))),k.add&&(k.add.call(a,m),m.handler.guid||(m.handler.guid=d.guid)),f?n.splice(n.delegateCount++,0,m):n.push(m),ia.event.global[o]=!0;a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ia.hasData(a)&&ia._data(a);if(q&&(k=q.events)){for(b=(b||"").match(ka)||[""],j=b.length;j--;)if(h=Oa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=ia.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=k[n]||[],h=h[2]&&RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&p!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||ia.removeEvent(a,n,q.handle),delete k[n])}else for(n in k)ia.event.remove(a,n+b[j],c,d,!0);ia.isEmptyObject(k)&&(delete q.handle,ia._removeData(a,"events"))}},trigger:function(c,d,e,f){var g,h,i,j,k,l,m,n=[e||W],o=ga.call(c,"type")?c.type:c,p=ga.call(c,"namespace")?c.namespace.split("."):[];if(i=l=e=e||W,3!==e.nodeType&&8!==e.nodeType&&!Na.test(o+ia.event.triggered)&&(o.indexOf(".")>=0&&(p=o.split("."),o=p.shift(),p.sort()),h=0>o.indexOf(":")&&"on"+o,c=c[ia.expando]?c:new ia.Event(o,"object"==typeof c&&c),c.isTrigger=!0,c.namespace=p.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:ia.makeArray(d,[c]),k=ia.event.special[o]||{},f||!k.trigger||k.trigger.apply(e,d)!==!1)){if(!f&&!k.noBubble&&!ia.isWindow(e)){for(j=k.delegateType||o,Na.test(j+o)||(i=i.parentNode);i;i=i.parentNode)n.push(i),l=i;l===(e.ownerDocument||W)&&n.push(l.defaultView||l.parentWindow||a)}for(m=0;(i=n[m++])&&!c.isPropagationStopped();)c.type=m>1?j:k.bindType||o,g=(ia._data(i,"events")||{})[c.type]&&ia._data(i,"handle"),g&&g.apply(i,d),g=h&&i[h],g&&ia.acceptData(i)&&g.apply&&g.apply(i,d)===!1&&c.preventDefault();if(c.type=o,!(f||c.isDefaultPrevented()||k._default&&k._default.apply(e.ownerDocument,d)!==!1||"click"===o&&ia.nodeName(e,"a")||!ia.acceptData(e)||!h||!e[o]||ia.isWindow(e))){l=e[h],l&&(e[h]=null),ia.event.triggered=o;try{e[o]()}catch(q){}ia.event.triggered=b,l&&(e[h]=l)}return c.result}},dispatch:function(a){a=ia.event.fix(a);var c,d,e,f,g,h=[],i=da.call(arguments),j=(ia._data(this,"events")||{})[a.type]||[],k=ia.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){for(h=ia.event.handlers.call(this,a,j),c=0;(f=h[c++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,g=0;(e=f.handlers[g++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,d=((ia.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),d!==b&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,c){var d,e,f,g,h=[],i=c.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!=this;j=j.parentNode||this)if(1===j.nodeType&&(j.disabled!==!0||"click"!==a.type)){for(f=[],g=0;i>g;g++)e=c[g],d=e.selector+" ",f[d]===b&&(f[d]=e.needsContext?ia(d,this).index(j)>=0:ia.find(d,this,null,[j]).length),f[d]&&f.push(e);f.length&&h.push({elem:j,handlers:f})}return c.length>i&&h.push({elem:this,handlers:c.slice(i)}),h},fix:function(a){if(a[ia.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ma.test(e)?this.mouseHooks:La.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new ia.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||W),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(e=a.target.ownerDocument||W,f=e.documentElement,d=e.body,a.pageX=c.clientX+(f&&f.scrollLeft||d&&d.scrollLeft||0)-(f&&f.clientLeft||d&&d.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||d&&d.scrollTop||0)-(f&&f.clientTop||d&&d.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),a.which||g===b||(a.which=1&g?1:2&g?3:4&g?2:0),a}},special:{load:{noBubble:!0},click:{trigger:function(){return ia.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):b}},focus:{trigger:function(){if(this!==W.activeElement&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===W.activeElement&&this.blur?(this.blur(),!1):b},delegateType:"focusout"},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=ia.extend(new ia.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?ia.event.trigger(e,null,b):ia.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},ia.removeEvent=W.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===V&&(a[d]=null),a.detachEvent(d,c))},ia.Event=function(a,c){return this instanceof ia.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?i:j):this.type=a,c&&ia.extend(this,c),this.timeStamp=a&&a.timeStamp||ia.now(),this[ia.expando]=!0,b):new ia.Event(a,c)},ia.Event.prototype={isDefaultPrevented:j,isPropagationStopped:j,isImmediatePropagationStopped:j,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=i,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=i,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=i,this.stopPropagation()}},ia.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){ia.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!ia.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),ia.support.submitBubbles||(ia.event.special.submit={setup:function(){return ia.nodeName(this,"form")?!1:(ia.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=ia.nodeName(c,"input")||ia.nodeName(c,"button")?c.form:b;d&&!ia._data(d,"submitBubbles")&&(ia.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),ia._data(d,"submitBubbles",!0))}),b)},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&ia.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return ia.nodeName(this,"form")?!1:(ia.event.remove(this,"._submit"),b)}}),ia.support.changeBubbles||(ia.event.special.change={setup:function(){return Ka.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ia.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),ia.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),ia.event.simulate("change",this,a,!0)})),!1):(ia.event.add(this,"beforeactivate._change",function(a){var b=a.target;Ka.test(b.nodeName)&&!ia._data(b,"changeBubbles")&&(ia.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||ia.event.simulate("change",this.parentNode,a,!0)}),ia._data(b,"changeBubbles",!0))}),b)},handle:function(a){var c=a.target;return this!==c||a.isSimulated||a.isTrigger||"radio"!==c.type&&"checkbox"!==c.type?a.handleObj.handler.apply(this,arguments):b},teardown:function(){return ia.event.remove(this,"._change"),!Ka.test(this.nodeName)}}),ia.support.focusinBubbles||ia.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){ia.event.simulate(b,a.target,ia.event.fix(a),!0)};ia.event.special[b]={setup:function(){0===c++&&W.addEventListener(a,d,!0)},teardown:function(){0===--c&&W.removeEventListener(a,d,!0)}}}),ia.fn.extend({on:function(a,c,d,e,f){var g,h;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(g in a)this.on(g,c,d,a[g],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=j;else if(!e)return this;return 1===f&&(h=e,e=function(a){return ia().off(a),h.apply(this,arguments)},e.guid=h.guid||(h.guid=ia.guid++)),this.each(function(){ia.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,ia(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=j),this.each(function(){ia.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){ia.event.trigger(a,b,this)})},triggerHandler:function(a,c){var d=this[0];return d?ia.event.trigger(a,c,d,!0):b}}),function(a,b){function c(a){return oa.test(a+"")}function d(){var a,b=[];return a=function(c,d){return b.push(c+=" ")>y.cacheLength&&delete a[b.shift()],a[c]=d}}function e(a){return a[N]=!0,a}function f(a){var b=F.createElement("div");try{return a(b)}catch(c){return!1}finally{b=null}}function g(a,b,c,d){var e,f,g,h,i,j,k,n,o,p;if((b?b.ownerDocument||b:O)!==F&&E(b),b=b||F,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(!H&&!d){if(e=pa.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&L(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return Z.apply(c,$.call(b.getElementsByTagName(a),0)),c;if((g=e[3])&&P.getByClassName&&b.getElementsByClassName)return Z.apply(c,$.call(b.getElementsByClassName(g),0)),c}if(P.qsa&&!I.test(a)){if(k=!0,n=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=l(a),(k=b.getAttribute("id"))?n=k.replace(sa,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=na.test(a)&&b.parentNode||b,p=j.join(",")}if(p)try{return Z.apply(c,$.call(o.querySelectorAll(p),0)),c}catch(q){}finally{k||b.removeAttribute("id")}}}return u(a.replace(ga,"$1"),b,c,d)}function h(a,b){var c=b&&a,d=c&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function i(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function j(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return e(function(b){return b=+b,e(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function l(a,b){var c,d,e,f,h,i,j,k=T[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){(!c||(d=ha.exec(h)))&&(d&&(h=h.slice(d[0].length)||h),i.push(e=[])),c=!1,(d=ja.exec(h))&&(c=d.shift(),e.push({value:c,type:d[0].replace(ga," ")}),h=h.slice(c.length));for(f in y.filter)!(d=ma[f].exec(h))||j[f]&&!(d=j[f](d))||(c=d.shift(),e.push({value:c,type:f,matches:d}),h=h.slice(c.length));if(!c)break}return b?h.length:h?g.error(a):T(a,i).slice(0)}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=R++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=Q+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[N]||(b[N]={}),(i=j[d])&&i[0]===k){if((h=i[1])===!0||h===x)return h===!0}else if(i=j[d]=[k],i[1]=a(b,c,g)||x,i[1]===!0)return!0}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function q(a,b,c,d,f,g){return d&&!d[N]&&(d=q(d)),f&&!f[N]&&(f=q(f,g)),e(function(e,g,h,i){var j,k,l,m=[],n=[],o=g.length,q=e||t(b||"*",h.nodeType?[h]:h,[]),r=!a||!e&&b?q:p(q,m,a,h,i),s=c?f||(e?a:o||d)?[]:g:r;if(c&&c(r,s,h,i),d)for(j=p(s,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(e){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?_.call(e,l):m[k])>-1&&(e[j]=!(g[j]=l))}}else s=p(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):Z.apply(g,s)})}function r(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return _.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==D)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[n(o(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return q(h>1&&o(k),h>1&&m(a.slice(0,h-1)).replace(ga,"$1"),c,d>h&&r(a.slice(h,d)),e>d&&r(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function s(a,b){var c=0,d=b.length>0,f=a.length>0,h=function(e,h,i,j,k){var l,m,n,o=[],q=0,r="0",s=e&&[],t=null!=k,u=D,v=e||f&&y.find.TAG("*",k&&h.parentNode||h),w=Q+=null==u?1:Math.random()||.1;for(t&&(D=h!==F&&h,x=c);null!=(l=v[r]);r++){if(f&&l){for(m=0;n=a[m++];)if(n(l,h,i)){j.push(l);break}t&&(Q=w,x=++c)}d&&((l=!n&&l)&&q--,e&&s.push(l))}if(q+=r,d&&r!==q){for(m=0;n=b[m++];)n(s,o,h,i);if(e){if(q>0)for(;r--;)s[r]||o[r]||(o[r]=Y.call(j));o=p(o)}Z.apply(j,o),t&&!e&&o.length>0&&q+b.length>1&&g.uniqueSort(j)}return t&&(Q=w,D=u),s};return d?e(h):h}function t(a,b,c){for(var d=0,e=b.length;e>d;d++)g(a,b[d],c);return c}function u(a,b,c,d){var e,f,g,h,i,j=l(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&9===b.nodeType&&!H&&y.relative[f[1].type]){if(b=y.find.ID(g.matches[0].replace(ua,va),b)[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=ma.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(ua,va),na.test(f[0].type)&&b.parentNode||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return Z.apply(c,$.call(d,0)),c;break}}return B(a,j)(d,b,H,c,na.test(a)),c}function v(){}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P={},Q=0,R=0,S=d(),T=d(),U=d(),V=typeof b,W=1<<31,X=[],Y=X.pop,Z=X.push,$=X.slice,_=X.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},aa="[\\x20\\t\\r\\n\\f]",ba="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ca=ba.replace("w","w#"),da="([*^$|!~]?=)",ea="\\["+aa+"*("+ba+")"+aa+"*(?:"+da+aa+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ca+")|)|)"+aa+"*\\]",fa=":("+ba+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ea.replace(3,8)+")*)|.*)\\)|)",ga=RegExp("^"+aa+"+|((?:^|[^\\\\])(?:\\\\.)*)"+aa+"+$","g"),ha=RegExp("^"+aa+"*,"+aa+"*"),ja=RegExp("^"+aa+"*([\\x20\\t\\r\\n\\f>+~])"+aa+"*"),ka=RegExp(fa),la=RegExp("^"+ca+"$"),ma={ID:RegExp("^#("+ba+")"),CLASS:RegExp("^\\.("+ba+")"),NAME:RegExp("^\\[name=['\"]?("+ba+")['\"]?\\]"),TAG:RegExp("^("+ba.replace("w","w*")+")"),ATTR:RegExp("^"+ea),PSEUDO:RegExp("^"+fa),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+aa+"*(even|odd|(([+-]|)(\\d*)n|)"+aa+"*(?:([+-]|)"+aa+"*(\\d+)|))"+aa+"*\\)|)","i"),needsContext:RegExp("^"+aa+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+aa+"*((?:-\\d)?\\d*)"+aa+"*\\)|)(?=[^-]|$)","i")},na=/[\x20\t\r\n\f]*[+~]/,oa=/^[^{]+\{\s*\[native code/,pa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,qa=/^(?:input|select|textarea|button)$/i,ra=/^h\d$/i,sa=/'|\\/g,ta=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,ua=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,va=function(a,b){var c="0x"+b-65536;return c!==c?b:0>c?String.fromCharCode(c+65536):String.fromCharCode(55296|c>>10,56320|1023&c)};try{$.call(O.documentElement.childNodes,0)[0].nodeType}catch(wa){$=function(a){for(var b,c=[];b=this[a++];)c.push(b);return c}}A=g.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},E=g.setDocument=function(a){var d=a?a.ownerDocument||a:O;return d!==F&&9===d.nodeType&&d.documentElement?(F=d,G=d.documentElement,H=A(d),P.tagNameNoComments=f(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),P.attributes=f(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return"boolean"!==b&&"string"!==b}),P.getByClassName=f(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",a.getElementsByClassName&&a.getElementsByClassName("e").length?(a.lastChild.className="e",2===a.getElementsByClassName("e").length):!1}),P.getByName=f(function(a){a.id=N+0,a.innerHTML="<a name='"+N+"'></a><div name='"+N+"'></div>",G.insertBefore(a,G.firstChild);var b=d.getElementsByName&&d.getElementsByName(N).length===2+d.getElementsByName(N+0).length;return P.getIdNotName=!d.getElementById(N),G.removeChild(a),b}),y.attrHandle=f(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==V&&"#"===a.firstChild.getAttribute("href")})?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},P.getIdNotName?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&!H){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(ua,va);return function(a){return a.getAttribute("id")===b}}):(y.find.ID=function(a,c){if(typeof c.getElementById!==V&&!H){var d=c.getElementById(a);return d?d.id===a||typeof d.getAttributeNode!==V&&d.getAttributeNode("id").value===a?[d]:b:[]}},y.filter.ID=function(a){var b=a.replace(ua,va);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=P.tagNameNoComments?function(a,c){return typeof c.getElementsByTagName!==V?c.getElementsByTagName(a):b}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.NAME=P.getByName&&function(a,c){return typeof c.getElementsByName!==V?c.getElementsByName(name):b},y.find.CLASS=P.getByClassName&&function(a,c){return typeof c.getElementsByClassName===V||H?b:c.getElementsByClassName(a)},J=[],I=[":focus"],(P.qsa=c(d.querySelectorAll))&&(f(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||I.push("\\["+aa+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||I.push(":checked")}),f(function(a){a.innerHTML="<input type='hidden' i=''/>",a.querySelectorAll("[i^='']").length&&I.push("[*^$]="+aa+"*(?:\"\"|'')"),a.querySelectorAll(":enabled").length||I.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),I.push(",.*:")})),(P.matchesSelector=c(K=G.matchesSelector||G.mozMatchesSelector||G.webkitMatchesSelector||G.oMatchesSelector||G.msMatchesSelector))&&f(function(a){P.disconnectedMatch=K.call(a,"div"),K.call(a,"[s!='']:x"),J.push("!=",fa)}),I=RegExp(I.join("|")),J=RegExp(J.join("|")),L=c(G.contains)||G.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},M=G.compareDocumentPosition?function(a,b){var c;return a===b?(C=!0,0):(c=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b))?1&c||a.parentNode&&11===a.parentNode.nodeType?a===d||L(O,a)?-1:b===d||L(O,b)?1:0:4&c?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var c,e=0,f=a.parentNode,g=b.parentNode,i=[a],j=[b];if(a===b)return C=!0,0;if(!f||!g)return a===d?-1:b===d?1:f?-1:g?1:0;if(f===g)return h(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?h(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},C=!1,[0,0].sort(M),P.detectDuplicates=C,F):F},g.matches=function(a,b){return g(a,null,null,b)},g.matchesSelector=function(a,b){if((a.ownerDocument||a)!==F&&E(a),b=b.replace(ta,"='$1']"),!(!P.matchesSelector||H||J&&J.test(b)||I.test(b)))try{var c=K.call(a,b);if(c||P.disconnectedMatch||a.document&&11!==a.document.nodeType)return c}catch(d){}return g(b,F,null,[a]).length>0},g.contains=function(a,b){return(a.ownerDocument||a)!==F&&E(a),L(a,b)},g.attr=function(a,b){var c;return(a.ownerDocument||a)!==F&&E(a),H||(b=b.toLowerCase()),(c=y.attrHandle[b])?c(a):H||P.attributes?a.getAttribute(b):((c=a.getAttributeNode(b))||a.getAttribute(b))&&a[b]===!0?b:c&&c.specified?c.value:null},g.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},g.uniqueSort=function(a){var b,c=[],d=1,e=0;if(C=!P.detectDuplicates,a.sort(M),C){for(;b=a[d];d++)b===a[d-1]&&(e=c.push(d));for(;e--;)a.splice(c[e],1)}return a},z=g.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=z(b);return c},y=g.selectors={cacheLength:50,createPseudo:e,match:ma,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ua,va),a[3]=(a[4]||a[5]||"").replace(ua,va),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||g.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&g.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return ma.CHILD.test(a[0])?null:(a[4]?a[2]=a[4]:c&&ka.test(c)&&(b=l(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){return"*"===a?function(){return!0}:(a=a.replace(ua,va).toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=S[a+" "];return b||(b=RegExp("(^|"+aa+")"+a+"("+aa+"|$)"))&&S(a,function(a){return b.test(a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=g.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===Q&&j[1],m=j[0]===Q&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[Q,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===Q)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[Q,m]),l!==b)););return m-=e,m===d||0===m%d&&m/d>=0}}},PSEUDO:function(a,b){var c,d=y.pseudos[a]||y.setFilters[a.toLowerCase()]||g.error("unsupported pseudo: "+a);return d[N]?d(b):d.length>1?(c=[a,a,"",b],y.setFilters.hasOwnProperty(a.toLowerCase())?e(function(a,c){for(var e,f=d(a,b),g=f.length;g--;)e=_.call(a,f[g]),a[e]=!(c[e]=f[g])}):function(a){return d(a,0,c)}):d}},pseudos:{not:e(function(a){var b=[],c=[],d=B(a.replace(ga,"$1"));return d[N]?e(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:e(function(a){return function(b){return g(a,b).length>0}}),contains:e(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:e(function(a){return la.test(a||"")||g.error("unsupported lang: "+a),a=a.replace(ua,va).toLowerCase(),function(b){var c;do if(c=H?b.getAttribute("xml:lang")||b.getAttribute("lang"):b.lang)return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===G},focus:function(a){return a===F.activeElement&&(!F.hasFocus||F.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeName>"@"||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return ra.test(a.nodeName)},input:function(a){return qa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[0>c?c+b:c]}),even:k(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:k(function(a,b,c){for(var d=0>c?c+b:c;b>++d;)a.push(d);return a})}};for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=i(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=j(w);B=g.compile=function(a,b){var c,d=[],e=[],f=U[a+" "];if(!f){for(b||(b=l(a)),c=b.length;c--;)f=r(b[c]),f[N]?d.push(f):e.push(f);f=U(a,s(e,d))}return f},y.pseudos.nth=y.pseudos.eq,y.filters=v.prototype=y.pseudos,y.setFilters=new v,E(),g.attr=ia.attr,ia.find=g,ia.expr=g.selectors,ia.expr[":"]=ia.expr.pseudos,ia.unique=g.uniqueSort,ia.text=g.getText,ia.isXMLDoc=g.isXML,ia.contains=g.contains}(a);var Pa=/Until$/,Qa=/^(?:parents|prev(?:Until|All))/,Ra=/^.[^:#\[\.,]*$/,Sa=ia.expr.match.needsContext,Ta={children:!0,contents:!0,next:!0,prev:!0};ia.fn.extend({find:function(a){var b,c,d,e=this.length;if("string"!=typeof a)return d=this,this.pushStack(ia(a).filter(function(){for(b=0;e>b;b++)if(ia.contains(d[b],this))return!0}));for(c=[],b=0;e>b;b++)ia.find(a,this[b],c);return c=this.pushStack(e>1?ia.unique(c):c),c.selector=(this.selector?this.selector+" ":"")+a,c},has:function(a){var b,c=ia(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(ia.contains(this,c[b]))return!0})},not:function(a){return this.pushStack(l(this,a,!1))},filter:function(a){return this.pushStack(l(this,a,!0))},is:function(a){return!!a&&("string"==typeof a?Sa.test(a)?ia(a,this.context).index(this[0])>=0:ia.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Sa.test(a)||"string"!=typeof a?ia(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c.ownerDocument&&c!==b&&11!==c.nodeType;){if(g?g.index(c)>-1:ia.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}return this.pushStack(f.length>1?ia.unique(f):f)},index:function(a){return a?"string"==typeof a?ia.inArray(this[0],ia(a)):ia.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?ia(a,b):ia.makeArray(a&&a.nodeType?[a]:a),d=ia.merge(this.get(),c);return this.pushStack(ia.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),ia.fn.andSelf=ia.fn.addBack,ia.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return ia.dir(a,"parentNode")},parentsUntil:function(a,b,c){return ia.dir(a,"parentNode",c)},next:function(a){return k(a,"nextSibling")},prev:function(a){return k(a,"previousSibling")},nextAll:function(a){return ia.dir(a,"nextSibling")},prevAll:function(a){return ia.dir(a,"previousSibling");
},nextUntil:function(a,b,c){return ia.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return ia.dir(a,"previousSibling",c)},siblings:function(a){return ia.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return ia.sibling(a.firstChild)},contents:function(a){return ia.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:ia.merge([],a.childNodes)}},function(a,b){ia.fn[a]=function(c,d){var e=ia.map(this,b,c);return Pa.test(a)||(d=c),d&&"string"==typeof d&&(e=ia.filter(d,e)),e=this.length>1&&!Ta[a]?ia.unique(e):e,this.length>1&&Qa.test(a)&&(e=e.reverse()),this.pushStack(e)}}),ia.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?ia.find.matchesSelector(b[0],a)?[b[0]]:[]:ia.find.matches(a,b)},dir:function(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(d===b||1!==f.nodeType||!ia(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ua="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Va=/ jQuery\d+="(?:null|\d+)"/g,Wa=RegExp("<(?:"+Ua+")[\\s/>]","i"),Xa=/^\s+/,Ya=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Za=/<([\w:]+)/,$a=/<tbody/i,_a=/<|&#?\w+;/,ab=/<(?:script|style|link)/i,bb=/^(?:checkbox|radio)$/i,cb=/checked\s*(?:[^=]|=\s*.checked.)/i,db=/^$|\/(?:java|ecma)script/i,eb=/^true\/(.*)/,fb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,gb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ia.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},hb=m(W),ib=hb.appendChild(W.createElement("div"));gb.optgroup=gb.option,gb.tbody=gb.tfoot=gb.colgroup=gb.caption=gb.thead,gb.th=gb.td,ia.fn.extend({text:function(a){return ia.access(this,function(a){return a===b?ia.text(this):this.empty().append((this[0]&&this[0].ownerDocument||W).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(ia.isFunction(a))return this.each(function(b){ia(this).wrapAll(a.call(this,b))});if(this[0]){var b=ia(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return ia.isFunction(a)?this.each(function(b){ia(this).wrapInner(a.call(this,b))}):this.each(function(){var b=ia(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=ia.isFunction(a);return this.each(function(c){ia(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){ia.nodeName(this,"body")||ia(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(a,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,!1,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)(!a||ia.filter(a,[c]).length>0)&&(b||1!==c.nodeType||ia.cleanData(t(c)),c.parentNode&&(b&&ia.contains(c.ownerDocument,c)&&q(t(c,"script")),c.parentNode.removeChild(c)));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&ia.cleanData(t(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&ia.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return ia.clone(this,a,b)})},html:function(a){return ia.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(Va,""):b;if(!("string"!=typeof a||ab.test(a)||!ia.support.htmlSerialize&&Wa.test(a)||!ia.support.leadingWhitespace&&Xa.test(a)||gb[(Za.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(Ya,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(ia.cleanData(t(c,!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){var b=ia.isFunction(a);return b||"string"==typeof a||(a=ia(a).not(this).detach()),this.domManip([a],!0,function(a){var b=this.nextSibling,c=this.parentNode;c&&(ia(this).remove(),c.insertBefore(a,b))})},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=ba.apply([],a);var e,f,g,h,i,j,k=0,l=this.length,m=this,q=l-1,r=a[0],s=ia.isFunction(r);if(s||!(1>=l||"string"!=typeof r||ia.support.checkClone)&&cb.test(r))return this.each(function(e){var f=m.eq(e);s&&(a[0]=r.call(this,e,c?f.html():b)),f.domManip(a,c,d)});if(l&&(j=ia.buildFragment(a,this[0].ownerDocument,!1,this),e=j.firstChild,1===j.childNodes.length&&(j=e),e)){for(c=c&&ia.nodeName(e,"tr"),h=ia.map(t(j,"script"),o),g=h.length;l>k;k++)f=j,k!==q&&(f=ia.clone(f,!0,!0),g&&ia.merge(h,t(f,"script"))),d.call(c&&ia.nodeName(this[k],"table")?n(this[k],"tbody"):this[k],f,k);if(g)for(i=h[h.length-1].ownerDocument,ia.map(h,p),k=0;g>k;k++)f=h[k],db.test(f.type||"")&&!ia._data(f,"globalEval")&&ia.contains(i,f)&&(f.src?ia.ajax({url:f.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):ia.globalEval((f.text||f.textContent||f.innerHTML||"").replace(fb,"")));j=e=null}return this}}),ia.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){ia.fn[a]=function(a){for(var c,d=0,e=[],f=ia(a),g=f.length-1;g>=d;d++)c=d===g?this:this.clone(!0),ia(f[d])[b](c),ca.apply(e,c.get());return this.pushStack(e)}}),ia.extend({clone:function(a,b,c){var d,e,f,g,h,i=ia.contains(a.ownerDocument,a);if(ia.support.html5Clone||ia.isXMLDoc(a)||!Wa.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ib.innerHTML=a.outerHTML,ib.removeChild(f=ib.firstChild)),!(ia.support.noCloneEvent&&ia.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||ia.isXMLDoc(a)))for(d=t(f),h=t(a),g=0;null!=(e=h[g]);++g)d[g]&&s(e,d[g]);if(b)if(c)for(h=h||t(a),d=d||t(f),g=0;null!=(e=h[g]);g++)r(e,d[g]);else r(a,f);return d=t(f,"script"),d.length>0&&q(d,!i&&t(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,l=a.length,n=m(b),o=[],p=0;l>p;p++)if(f=a[p],f||0===f)if("object"===ia.type(f))ia.merge(o,f.nodeType?[f]:f);else if(_a.test(f)){for(h=h||n.appendChild(b.createElement("div")),i=(Za.exec(f)||["",""])[1].toLowerCase(),k=gb[i]||gb._default,h.innerHTML=k[1]+f.replace(Ya,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!ia.support.leadingWhitespace&&Xa.test(f)&&o.push(b.createTextNode(Xa.exec(f)[0])),!ia.support.tbody)for(f="table"!==i||$a.test(f)?"<table>"!==k[1]||$a.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;e--;)ia.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(ia.merge(o,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=n.lastChild}else o.push(b.createTextNode(f));for(h&&n.removeChild(h),ia.support.appendChecked||ia.grep(t(o,"input"),u),p=0;f=o[p++];)if((!d||-1===ia.inArray(f,d))&&(g=ia.contains(f.ownerDocument,f),h=t(n.appendChild(f),"script"),g&&q(h),c))for(e=0;f=h[e++];)db.test(f.type||"")&&c.push(f);return h=null,n},cleanData:function(a,b){for(var c,d,e,f,g=0,h=ia.expando,i=ia.cache,j=ia.support.deleteExpando,k=ia.event.special;null!=(c=a[g]);g++)if((b||ia.acceptData(c))&&(e=c[h],f=e&&i[e])){if(f.events)for(d in f.events)k[d]?ia.event.remove(c,d):ia.removeEvent(c,d,f.handle);i[e]&&(delete i[e],j?delete c[h]:typeof c.removeAttribute!==V?c.removeAttribute(h):c[h]=null,_.push(e))}}});var jb,kb,lb,mb=/alpha\([^)]*\)/i,nb=/opacity\s*=\s*([^)]*)/,ob=/^(top|right|bottom|left)$/,pb=/^(none|table(?!-c[ea]).+)/,qb=/^margin/,rb=RegExp("^("+ja+")(.*)$","i"),sb=RegExp("^("+ja+")(?!px)[a-z%]+$","i"),tb=RegExp("^([+-])=("+ja+")","i"),ub={BODY:"block"},vb={position:"absolute",visibility:"hidden",display:"block"},wb={letterSpacing:0,fontWeight:400},xb=["Top","Right","Bottom","Left"],yb=["Webkit","O","Moz","ms"];ia.fn.extend({css:function(a,c){return ia.access(this,function(a,c,d){var e,f,g={},h=0;if(ia.isArray(c)){for(f=kb(a),e=c.length;e>h;h++)g[c[h]]=ia.css(a,c[h],!1,f);return g}return d!==b?ia.style(a,c,d):ia.css(a,c)},a,c,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(a){var b="boolean"==typeof a;return this.each(function(){(b?a:w(this))?ia(this).show():ia(this).hide()})}}),ia.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=lb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ia.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=ia.camelCase(c),j=a.style;if(c=ia.cssProps[i]||(ia.cssProps[i]=v(j,i)),h=ia.cssHooks[c]||ia.cssHooks[i],d===b)return h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c];if(g=typeof d,"string"===g&&(f=tb.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(ia.css(a,c)),g="number"),!(null==d||"number"===g&&isNaN(d)||("number"!==g||ia.cssNumber[i]||(d+="px"),ia.support.clearCloneStyle||""!==d||0!==c.indexOf("background")||(j[c]="inherit"),h&&"set"in h&&(d=h.set(a,d,e))===b)))try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=ia.camelCase(c);return c=ia.cssProps[i]||(ia.cssProps[i]=v(a.style,i)),h=ia.cssHooks[c]||ia.cssHooks[i],h&&"get"in h&&(g=h.get(a,!0,d)),g===b&&(g=lb(a,c,e)),"normal"===g&&c in wb&&(g=wb[c]),""===d||d?(f=parseFloat(g),d===!0||ia.isNumeric(f)?f||0:g):g},swap:function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e}}),a.getComputedStyle?(kb=function(b){return a.getComputedStyle(b,null)},lb=function(a,c,d){var e,f,g,h=d||kb(a),i=h?h.getPropertyValue(c)||h[c]:b,j=a.style;return h&&(""!==i||ia.contains(a.ownerDocument,a)||(i=ia.style(a,c)),sb.test(i)&&qb.test(c)&&(e=j.width,f=j.minWidth,g=j.maxWidth,j.minWidth=j.maxWidth=j.width=i,i=h.width,j.width=e,j.minWidth=f,j.maxWidth=g)),i}):W.documentElement.currentStyle&&(kb=function(a){return a.currentStyle},lb=function(a,c,d){var e,f,g,h=d||kb(a),i=h?h[c]:b,j=a.style;return null==i&&j&&j[c]&&(i=j[c]),sb.test(i)&&!ob.test(c)&&(e=j.left,f=a.runtimeStyle,g=f&&f.left,g&&(f.left=a.currentStyle.left),j.left="fontSize"===c?"1em":i,i=j.pixelLeft+"px",j.left=e,g&&(f.left=g)),""===i?"auto":i}),ia.each(["height","width"],function(a,c){ia.cssHooks[c]={get:function(a,d,e){return d?0===a.offsetWidth&&pb.test(ia.css(a,"display"))?ia.swap(a,vb,function(){return A(a,c,e)}):A(a,c,e):b},set:function(a,b,d){var e=d&&kb(a);return y(a,b,d?z(a,c,d,ia.support.boxSizing&&"border-box"===ia.css(a,"boxSizing",!1,e),e):0)}}}),ia.support.opacity||(ia.cssHooks.opacity={get:function(a,b){return nb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=ia.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===ia.trim(f.replace(mb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=mb.test(f)?f.replace(mb,e):f+" "+e)}}),ia(function(){ia.support.reliableMarginRight||(ia.cssHooks.marginRight={get:function(a,c){return c?ia.swap(a,{display:"inline-block"},lb,[a,"marginRight"]):b}}),!ia.support.pixelPosition&&ia.fn.position&&ia.each(["top","left"],function(a,c){ia.cssHooks[c]={get:function(a,d){return d?(d=lb(a,c),sb.test(d)?ia(a).position()[c]+"px":d):b}}})}),ia.expr&&ia.expr.filters&&(ia.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight||!ia.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||ia.css(a,"display"))},ia.expr.filters.visible=function(a){return!ia.expr.filters.hidden(a)}),ia.each({margin:"",padding:"",border:"Width"},function(a,b){ia.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+xb[d]+b]=f[d]||f[d-2]||f[0];return e}},qb.test(a)||(ia.cssHooks[a+b].set=y)});var zb=/%20/g,Ab=/\[\]$/,Bb=/\r?\n/g,Cb=/^(?:submit|button|image|reset|file)$/i,Db=/^(?:input|select|textarea|keygen)/i;ia.fn.extend({serialize:function(){return ia.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=ia.prop(this,"elements");return a?ia.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!ia(this).is(":disabled")&&Db.test(this.nodeName)&&!Cb.test(a)&&(this.checked||!bb.test(a))}).map(function(a,b){var c=ia(this).val();return null==c?null:ia.isArray(c)?ia.map(c,function(a){return{name:b.name,value:a.replace(Bb,"\r\n")}}):{name:b.name,value:c.replace(Bb,"\r\n")}}).get()}}),ia.param=function(a,c){var d,e=[],f=function(a,b){b=ia.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=ia.ajaxSettings&&ia.ajaxSettings.traditional),ia.isArray(a)||a.jquery&&!ia.isPlainObject(a))ia.each(a,function(){f(this.name,this.value)});else for(d in a)D(d,a[d],c,f);return e.join("&").replace(zb,"+")},ia.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){ia.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),ia.fn.hover=function(a,b){return this.mouseenter(a).mouseleave(b||a)};var Eb,Fb,Gb=ia.now(),Hb=/\?/,Ib=/#.*$/,Jb=/([?&])_=[^&]*/,Kb=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Lb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mb=/^(?:GET|HEAD)$/,Nb=/^\/\//,Ob=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Pb=ia.fn.load,Qb={},Rb={},Sb="*/".concat("*");try{Fb=X.href}catch(Tb){Fb=W.createElement("a"),Fb.href="",Fb=Fb.href}Eb=Ob.exec(Fb.toLowerCase())||[],ia.fn.load=function(a,c,d){if("string"!=typeof a&&Pb)return Pb.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),ia.isFunction(c)?(d=c,c=b):c&&"object"==typeof c&&(g="POST"),h.length>0&&ia.ajax({url:a,type:g,dataType:"html",data:c}).done(function(a){f=arguments,h.html(e?ia("<div>").append(ia.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,f||[a.responseText,b,a])}),this},ia.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){ia.fn[b]=function(a){return this.on(b,a)}}),ia.each(["get","post"],function(a,c){ia[c]=function(a,d,e,f){return ia.isFunction(d)&&(f=f||e,e=d,d=b),ia.ajax({url:a,type:c,dataType:f,data:d,success:e})}}),ia.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Fb,type:"GET",isLocal:Lb.test(Eb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Sb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":ia.parseJSON,"text xml":ia.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?G(G(a,ia.ajaxSettings),b):G(ia.ajaxSettings,a)},ajaxPrefilter:E(Qb),ajaxTransport:E(Rb),ajax:function(a,c){function d(a,c,d,e){var f,l,s,t,v,x=c;2!==u&&(u=2,i&&clearTimeout(i),k=b,h=e||"",w.readyState=a>0?4:0,d&&(t=H(m,w,d)),a>=200&&300>a||304===a?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(ia.lastModified[g]=v),v=w.getResponseHeader("etag"),v&&(ia.etag[g]=v)),204===a?(f=!0,x="nocontent"):304===a?(f=!0,x="notmodified"):(f=I(m,t),x=f.state,l=f.data,s=f.error,f=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),w.status=a,w.statusText=(c||x)+"",f?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=b,j&&o.trigger(f?"ajaxSuccess":"ajaxError",[w,m,f?l:s]),q.fireWith(n,[w,x]),j&&(o.trigger("ajaxComplete",[w,m]),--ia.active||ia.event.trigger("ajaxStop")))}"object"==typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,j,k,l,m=ia.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?ia(n):ia.event,p=ia.Deferred(),q=ia.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!l)for(l={};b=Kb.exec(h);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?h:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return k&&k.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||Fb)+"").replace(Ib,"").replace(Nb,Eb[1]+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=ia.trim(m.dataType||"*").toLowerCase().match(ka)||[""],null==m.crossDomain&&(e=Ob.exec(m.url.toLowerCase()),m.crossDomain=!(!e||e[1]===Eb[1]&&e[2]===Eb[2]&&(e[3]||("http:"===e[1]?80:443))==(Eb[3]||("http:"===Eb[1]?80:443)))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=ia.param(m.data,m.traditional)),F(Qb,m,c,w),2===u)return w;j=m.global,j&&0===ia.active++&&ia.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Mb.test(m.type),g=m.url,m.hasContent||(m.data&&(g=m.url+=(Hb.test(g)?"&":"?")+m.data,delete m.data),m.cache===!1&&(m.url=Jb.test(g)?g.replace(Jb,"$1_="+Gb++):g+(Hb.test(g)?"&":"?")+"_="+Gb++)),m.ifModified&&(ia.lastModified[g]&&w.setRequestHeader("If-Modified-Since",ia.lastModified[g]),ia.etag[g]&&w.setRequestHeader("If-None-Match",ia.etag[g])),(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Sb+"; q=0.01":""):m.accepts["*"]);for(f in m.headers)w.setRequestHeader(f,m.headers[f]);if(m.beforeSend&&(m.beforeSend.call(n,w,m)===!1||2===u))return w.abort();v="abort";for(f in{success:1,error:1,complete:1})w[f](m[f]);if(k=F(Rb,m,c,w)){w.readyState=1,j&&o.trigger("ajaxSend",[w,m]),m.async&&m.timeout>0&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,k.send(s,d)}catch(x){if(!(2>u))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getScript:function(a,c){return ia.get(a,b,c,"script")},getJSON:function(a,b,c){return ia.get(a,b,c,"json")}}),ia.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return ia.globalEval(a),a}}}),ia.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),ia.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=W.head||ia("head")[0]||W.documentElement;return{send:function(b,e){c=W.createElement("script"),c.async=!0,a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,b){(b||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,c.parentNode&&c.parentNode.removeChild(c),c=null,b||e(200,"success"))},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(b,!0)}}}});var Ub=[],Vb=/(=)\?(?=&|$)|\?\?/;ia.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Ub.pop()||ia.expando+"_"+Gb++;return this[a]=!0,a}}),ia.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.jsonp!==!1&&(Vb.test(c.url)?"url":"string"==typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vb.test(c.data)&&"data");return i||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=ia.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,i?c[i]=c[i].replace(Vb,"$1"+f):c.jsonp!==!1&&(c.url+=(Hb.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||ia.error(f+" was not called"),h[0]},c.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,Ub.push(f)),h&&ia.isFunction(g)&&g(h[0]),h=g=b}),"script"):b});var Wb,Xb,Yb=0,Zb=a.ActiveXObject&&function(){var a;for(a in Wb)Wb[a](b,!0)};ia.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&J()||K()}:J,Xb=ia.ajaxSettings.xhr(),ia.support.cors=!!Xb&&"withCredentials"in Xb,Xb=ia.support.ajax=!!Xb,Xb&&ia.ajaxTransport(function(c){if(!c.crossDomain||ia.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();if(c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async),c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=ia.noop,Zb&&delete Wb[g]),e)4!==i.readyState&&i.abort();else{l={},h=i.status,j=i.getAllResponseHeaders(),"string"==typeof i.responseText&&(l.text=i.responseText);try{k=i.statusText}catch(m){k=""}h||!c.isLocal||c.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(n){e||f(-1,n)}l&&f(h,k,l,j)},c.async?4===i.readyState?setTimeout(d):(g=++Yb,Zb&&(Wb||(Wb={},ia(a).unload(Zb)),Wb[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(b,!0)}}}});var $b,_b,ac=/^(?:toggle|show|hide)$/,bc=RegExp("^(?:([+-])=|)("+ja+")([a-z%]*)$","i"),cc=/queueHooks$/,dc=[P],ec={"*":[function(a,b){var c,d,e=this.createTween(a,b),f=bc.exec(b),g=e.cur(),h=+g||0,i=1,j=20;if(f){if(c=+f[2],d=f[3]||(ia.cssNumber[a]?"":"px"),"px"!==d&&h){h=ia.css(e.elem,a,!0)||c||1;do i=i||".5",h/=i,ia.style(e.elem,a,h+d);while(i!==(i=e.cur()/g)&&1!==i&&--j)}e.unit=d,e.start=h,e.end=f[1]?h+(f[1]+1)*c:c}return e}]};ia.Animation=ia.extend(N,{tweener:function(a,b){ia.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ec[c]=ec[c]||[],ec[c].unshift(b)},prefilter:function(a,b){b?dc.unshift(a):dc.push(a)}}),ia.Tween=Q,Q.prototype={constructor:Q,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(ia.cssNumber[c]?"":"px")},cur:function(){var a=Q.propHooks[this.prop];return a&&a.get?a.get(this):Q.propHooks._default.get(this)},run:function(a){var b,c=Q.propHooks[this.prop];return this.pos=b=this.options.duration?ia.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Q.propHooks._default.set(this),this}},Q.prototype.init.prototype=Q.prototype,Q.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=ia.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){ia.fx.step[a.prop]?ia.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[ia.cssProps[a.prop]]||ia.cssHooks[a.prop])?ia.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Q.propHooks.scrollTop=Q.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},ia.each(["toggle","show","hide"],function(a,b){var c=ia.fn[b];ia.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(R(b,!0),a,d,e)}}),ia.fn.extend({fadeTo:function(a,b,c,d){return this.filter(w).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=ia.isEmptyObject(a),f=ia.speed(b,c,d),g=function(){var b=N(this,ia.extend({},a),f);g.finish=function(){b.stop(!0)},(e||ia._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=ia.timers,g=ia._data(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&cc.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&ia.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=ia._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=ia.timers,g=d?d.length:0;for(c.finish=!0,ia.queue(this,a,[]),e&&e.cur&&e.cur.finish&&e.cur.finish.call(this),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),ia.each({slideDown:R("show"),slideUp:R("hide"),slideToggle:R("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){ia.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),ia.speed=function(a,b,c){var d=a&&"object"==typeof a?ia.extend({},a):{complete:c||!c&&b||ia.isFunction(a)&&a,duration:a,easing:c&&b||b&&!ia.isFunction(b)&&b};return d.duration=ia.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in ia.fx.speeds?ia.fx.speeds[d.duration]:ia.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){ia.isFunction(d.old)&&d.old.call(this),d.queue&&ia.dequeue(this,d.queue)},d},ia.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},ia.timers=[],ia.fx=Q.prototype.init,ia.fx.tick=function(){var a,c=ia.timers,d=0;for($b=ia.now();c.length>d;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||ia.fx.stop(),$b=b},ia.fx.timer=function(a){a()&&ia.timers.push(a)&&ia.fx.start()},ia.fx.interval=13,ia.fx.start=function(){_b||(_b=setInterval(ia.fx.tick,ia.fx.interval))},ia.fx.stop=function(){clearInterval(_b),_b=null},ia.fx.speeds={slow:600,fast:200,_default:400},ia.fx.step={},ia.expr&&ia.expr.filters&&(ia.expr.filters.animated=function(a){return ia.grep(ia.timers,function(b){return a===b.elem}).length}),ia.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){ia.offset.setOffset(this,a,b)});var c,d,e={top:0,left:0},f=this[0],g=f&&f.ownerDocument;return g?(c=g.documentElement,ia.contains(c,f)?(typeof f.getBoundingClientRect!==V&&(e=f.getBoundingClientRect()),d=S(g),{top:e.top+(d.pageYOffset||c.scrollTop)-(c.clientTop||0),left:e.left+(d.pageXOffset||c.scrollLeft)-(c.clientLeft||0)}):e):void 0},ia.offset={setOffset:function(a,b,c){var d=ia.css(a,"position");"static"===d&&(a.style.position="relative");var e,f,g=ia(a),h=g.offset(),i=ia.css(a,"top"),j=ia.css(a,"left"),k=("absolute"===d||"fixed"===d)&&ia.inArray("auto",[i,j])>-1,l={},m={};k?(m=g.position(),e=m.top,f=m.left):(e=parseFloat(i)||0,f=parseFloat(j)||0),ia.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(l.top=b.top-h.top+e),null!=b.left&&(l.left=b.left-h.left+f),"using"in b?b.using.call(a,l):g.css(l)}},ia.fn.extend({position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===ia.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),ia.nodeName(a[0],"html")||(c=a.offset()),c.top+=ia.css(a[0],"borderTopWidth",!0),c.left+=ia.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-ia.css(d,"marginTop",!0),left:b.left-c.left-ia.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||W.documentElement;a&&!ia.nodeName(a,"html")&&"static"===ia.css(a,"position");)a=a.offsetParent;return a||W.documentElement})}}),ia.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);ia.fn[a]=function(e){return ia.access(this,function(a,e,f){var g=S(a);return f===b?g?c in g?g[c]:g.document.documentElement[e]:a[e]:(g?g.scrollTo(d?ia(g).scrollLeft():f,d?f:ia(g).scrollTop()):a[e]=f,b)},a,e,arguments.length,null)}}),ia.each({Height:"height",Width:"width"},function(a,c){ia.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){ia.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(e===!0||f===!0?"margin":"border");return ia.access(this,function(c,d,e){var f;return ia.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?ia.css(c,d,h):ia.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=ia,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return ia})}(window);;!function(a){function b(a,b){return a.currentStyle&&a.currentStyle[b]||a.style[b]}function c(a){var c=$(a).css("clip")||"";if(!c){var d={top:b(a,"clipTop"),right:b(a,"clipRight"),bottom:b(a,"clipBottom"),left:b(a,"clipLeft")};d.top&&d.right&&d.bottom&&d.left&&(c="rect("+d.top+" "+d.right+" "+d.bottom+" "+d.left+")")}return c.replace(/,/g," ")}a.fx.step.clip=function(a){if(0===a.pos){var b=/rect\(([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)[,]?\s+([0-9\.]{1,})(px|em)\)/;a.start=b.exec(c(a.elem)),"string"==typeof a.end&&(a.end=b.exec(a.end.replace(/,/g," ")))}if(a.start&&a.end){for(var d=new Array,e=new Array,f=a.start.length,g=a.end.length,h="em"==a.start[i+1]?1.333*parseInt($(a.elem).css("fontSize"))*parseInt(a.start[i]):1,i=1;f>i;i+=2)d.push(parseInt(h*a.start[i]));for(var j=1;g>j;j+=2)e.push(parseInt(h*a.end[j]));a.elem.style.clip="rect("+parseInt(a.pos*(e[0]-d[0])+d[0])+"px "+parseInt(a.pos*(e[1]-d[1])+d[1])+"px "+parseInt(a.pos*(e[2]-d[2])+d[2])+"px "+parseInt(a.pos*(e[3]-d[3])+d[3])+"px)"}}}(jQuery);;!function(a){var b=function(b,c){this.element=a(b),this.picker=a('<div class="slider"><div class="slider-track"><div class="slider-selection"></div><div class="slider-handle"></div><div class="slider-handle"></div></div><div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div></div>').insertBefore(this.element).append(this.element),this.id=this.element.data("slider-id")||c.id,this.id&&(this.picker[0].id=this.id),"undefined"!=typeof Modernizr&&Modernizr.touch&&(this.touchCapable=!0);var d=this.element.data("slider-tooltip")||c.tooltip;switch(this.tooltip=this.picker.find(".tooltip"),this.tooltipInner=this.tooltip.find("div.tooltip-inner"),this.orientation=this.element.data("slider-orientation")||c.orientation,this.orientation){case"vertical":this.picker.addClass("slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight",this.tooltip.addClass("right")[0].style.left="100%";break;default:this.picker.addClass("slider-horizontal").css("width",this.element.outerWidth()),this.orientation="horizontal",this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth",this.tooltip.addClass("top")[0].style.top=-this.tooltip.outerHeight()-14+"px"}this.min=this.element.data("slider-min")||c.min,this.max=this.element.data("slider-max")||c.max,this.step=this.element.data("slider-step")||c.step,this.value=this.element.data("slider-value")||c.value,this.value[1]&&(this.range=!0),this.selection=this.element.data("slider-selection")||c.selection,this.selectionEl=this.picker.find(".slider-selection"),"none"===this.selection&&this.selectionEl.addClass("hide"),this.selectionElStyle=this.selectionEl[0].style,this.handle1=this.picker.find(".slider-handle:first"),this.handle1Stype=this.handle1[0].style,this.handle2=this.picker.find(".slider-handle:last"),this.handle2Stype=this.handle2[0].style;var e=this.element.data("slider-handle")||c.handle;switch(e){case"round":this.handle1.addClass("round"),this.handle2.addClass("round");break;case"triangle":this.handle1.addClass("triangle"),this.handle2.addClass("triangle")}this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),"after"==this.selection?this.value[1]=this.max:this.value[1]=this.min),this.diff=this.max-this.min,this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff],this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos],this.formater=c.formater,this.layout(),this.touchCapable?this.picker.on({touchstart:a.proxy(this.mousedown,this)}):this.picker.on({mousedown:a.proxy(this.mousedown,this)}),"show"===d?this.picker.on({mouseenter:a.proxy(this.showTooltip,this),mouseleave:a.proxy(this.hideTooltip,this)}):this.tooltip.addClass("hide")};b.prototype={constructor:b,over:!1,inDrag:!1,showTooltip:function(){this.tooltip.addClass("in"),this.over=!0},hideTooltip:function(){this.inDrag===!1&&this.tooltip.removeClass("in"),this.over=!1},layout:function(){this.handle1Stype[this.stylePos]=this.percentage[0]+"%",this.handle2Stype[this.stylePos]=this.percentage[1]+"%","vertical"==this.orientation?(this.selectionElStyle.top=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.height=Math.abs(this.percentage[0]-this.percentage[1])+"%"):(this.selectionElStyle.left=Math.min(this.percentage[0],this.percentage[1])+"%",this.selectionElStyle.width=Math.abs(this.percentage[0]-this.percentage[1])+"%"),this.range?(this.tooltipInner.text(this.formater(this.value[0])+" : "+this.formater(this.value[1])),this.tooltip[0].style[this.stylePos]=this.size*(this.percentage[0]+(this.percentage[1]-this.percentage[0])/2)/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px"):(this.tooltipInner.text(this.formater(this.value[0])),this.tooltip[0].style[this.stylePos]=this.size*this.percentage[0]/100-("vertical"===this.orientation?this.tooltip.outerHeight()/2:this.tooltip.outerWidth()/2)+"px")},mousedown:function(b){this.touchCapable&&"touchstart"===b.type&&(b=b.originalEvent),this.offset=this.picker.offset(),this.size=this.picker[0][this.sizePos];var c=this.getPercentage(b);if(this.range){var d=Math.abs(this.percentage[0]-c),e=Math.abs(this.percentage[1]-c);this.dragged=e>d?0:1}else this.dragged=0;this.percentage[this.dragged]=c,this.layout(),this.touchCapable?a(document).on({touchmove:a.proxy(this.mousemove,this),touchend:a.proxy(this.mouseup,this)}):a(document).on({mousemove:a.proxy(this.mousemove,this),mouseup:a.proxy(this.mouseup,this)}),this.inDrag=!0;var f=this.calculateValue();return this.element.trigger({type:"slideStart",value:f}).trigger({type:"slide",value:f}),!1},mousemove:function(a){this.touchCapable&&"touchmove"===a.type&&(a=a.originalEvent);var b=this.getPercentage(a);this.range&&(0===this.dragged&&this.percentage[1]<b?(this.percentage[0]=this.percentage[1],this.dragged=1):1===this.dragged&&this.percentage[0]>b&&(this.percentage[1]=this.percentage[0],this.dragged=0)),this.percentage[this.dragged]=b,this.layout();var c=this.calculateValue();return this.element.trigger({type:"slide",value:c}).data("value",c).prop("value",c),!1},mouseup:function(b){this.touchCapable?a(document).off({touchmove:this.mousemove,touchend:this.mouseup}):a(document).off({mousemove:this.mousemove,mouseup:this.mouseup}),this.inDrag=!1,0==this.over&&this.hideTooltip(),this.element;var c=this.calculateValue();return this.element.trigger({type:"slideStop",value:c}).data("value",c).prop("value",c),!1},calculateValue:function(){var a;return this.range?(a=[this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.min+Math.round(this.diff*this.percentage[1]/100/this.step)*this.step],this.value=a):(a=this.min+Math.round(this.diff*this.percentage[0]/100/this.step)*this.step,this.value=[a,this.value[1]]),a},getPercentage:function(a){this.touchCapable&&(a=a.touches[0]);var b=100*(a[this.mousePos]-this.offset[this.stylePos])/this.size;return b=Math.round(b/this.percentage[2])*this.percentage[2],Math.max(0,Math.min(100,b))},getValue:function(){return this.range?this.value:this.value[0]},setValue:function(a){this.value=a,this.range?(this.value[0]=Math.max(this.min,Math.min(this.max,this.value[0])),this.value[1]=Math.max(this.min,Math.min(this.max,this.value[1]))):(this.value=[Math.max(this.min,Math.min(this.max,this.value))],this.handle2.addClass("hide"),"after"==this.selection?this.value[1]=this.max:this.value[1]=this.min),this.diff=this.max-this.min,this.percentage=[100*(this.value[0]-this.min)/this.diff,100*(this.value[1]-this.min)/this.diff,100*this.step/this.diff],this.layout()}},a.fn.slider=function(c,d){return this.each(function(){var e=a(this),f=e.data("slider"),g="object"==typeof c&&c;f||e.data("slider",f=new b(this,a.extend({},a.fn.slider.defaults,g))),"string"==typeof c&&f[c](d)})},a.fn.slider.defaults={min:0,max:10,step:1,orientation:"horizontal",value:5,selection:"before",tooltip:"show",handle:"round",formater:function(a){return a}},a.fn.slider.Constructor=b}(window.jQuery);;!function(a){a(function(){a.support.transition=function(){var a=function(){var a,b=document.createElement("bootstrap"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(a in c)if(void 0!==b.style[a])return c[a]}();return a&&{end:a}}()})}(window.jQuery),!function(a){var b=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};b.prototype={constructor:b,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c),this.isShown||c.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in").attr("aria-hidden",!1),b.enforceFocus(),c?b.$element.one(a.support.transition.end,function(){b.$element.focus().trigger("shown")}):b.$element.focus().trigger("shown")}))},hide:function(b){b&&b.preventDefault();b=a.Event("hide"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),a.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var b=this;a(document).on("focusin.modal",function(a){b.$element[0]!==a.target&&!b.$element.has(a.target).length&&b.$element.focus()})},escape:function(){var a=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),b.hideModal()},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),b.hideModal()})},hideModal:function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?a.proxy(this.$element[0].focus,this.$element[0]):a.proxy(this.hide,this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b):b()):b&&b()}};var c=a.fn.modal;a.fn.modal=function(c){return this.each(function(){var d=a(this),e=d.data("modal"),f=a.extend({},a.fn.modal.defaults,d.data(),"object"==typeof c&&c);e||d.data("modal",e=new b(this,f)),"string"==typeof c?e[c]():f.show&&e.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f).one("hide",function(){c.focus()})})}(window.jQuery),!function(a){var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f,g,h,i;for(this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,g=this.options.trigger.split(" "),i=g.length;i--;)h=g[i],"click"==h?this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this)):"manual"!=h&&(e="hover"==h?"mouseenter":"focus",f="hover"==h?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,a.proxy(this.leave,this)));this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c,d=a.fn[this.type].defaults,e={};return this._options&&a.each(this._options,function(a,b){d[a]!=b&&(e[a]=b)},this),c=a(b.currentTarget)[this.type](e).data(this.type),c.options.delay&&c.options.delay.show?(clearTimeout(this.timeout),c.hoverState="in",this.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),c.options.delay&&c.options.delay.hide?(c.hoverState="out",void(this.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide))):c.hide()},show:function(){var b,c,d,e,f,g,h=a.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(h),h.isDefaultPrevented())return;switch(b=this.tip(),this.setContent(),this.options.animation&&b.addClass("fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,b[0],this.$element[0]):this.options.placement,b.detach().css({top:0,left:0,display:"block"}),this.options.container?b.appendTo(this.options.container):b.insertAfter(this.$element),c=this.getPosition(),d=b[0].offsetWidth,e=b[0].offsetHeight,f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}this.applyPlacement(g,f),this.$element.trigger("shown")}},applyPlacement:function(a,b){var c,d,e,f,g=this.tip(),h=g[0].offsetWidth,i=g[0].offsetHeight;g.offset(a).addClass(b).addClass("in"),c=g[0].offsetWidth,d=g[0].offsetHeight,"top"==b&&d!=i&&(a.top=a.top+i-d,f=!0),"bottom"==b||"top"==b?(e=0,a.left<0&&(e=-2*a.left,a.left=0,g.offset(a),c=g[0].offsetWidth,d=g[0].offsetHeight),this.replaceArrow(e-h+c,c,"left")):this.replaceArrow(d-i,d,"top"),f&&g.offset(a)},replaceArrow:function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function b(){var b=setTimeout(function(){c.off(a.support.transition.end).detach()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.detach()})}var c=this.tip(),d=a.Event("hide");return this.$element.trigger(d),d.isDefaultPrevented()?void 0:(c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?b():c.detach(),this.$element.trigger("hidden"),this)},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},tip:function(){return this.$tip=this.$tip||a(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(b){var c=b?a(b.currentTarget)[this.type](this._options).data(this.type):this;c.tip().hasClass("in")?c.hide():c.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f="object"==typeof c&&c;e||d.data("tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(window.jQuery),!function(a){var b=function(a,b){this.init("popover",a,b)};b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=("function"==typeof c.content?c.content.call(b[0]):c.content)||b.attr("data-content")},tip:function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("popover"),f="object"==typeof c&&c;e||d.data("popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(window.jQuery),!function(a){var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function c(){d.trigger("closed").remove()}var d,e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),d=a(f),b&&b.preventDefault(),d.length||(d=e.hasClass("alert")?e:e.parent()),d.trigger(b=a.Event("close")),b.isDefaultPrevented()||(d.removeClass("in"),a.support.transition&&d.hasClass("fade")?d.on(a.support.transition.end,c):c())};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("alert");e||d.data("alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.alert.data-api",b,c.prototype.close)}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("button"),f="object"==typeof c&&c;e||d.data("button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle")})}(window.jQuery),!function(a){var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.collapse.defaults,c),this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var b,c,d,e;if(!this.transitioning&&!this.$element.hasClass("in")){if(b=this.dimension(),c=a.camelCase(["scroll",b].join("-")),d=this.$parent&&this.$parent.find("> .accordion-group > .in"),d&&d.length){if(e=d.data("collapse"),e&&e.transitioning)return;d.collapse("hide"),e||d.data("collapse",null)}this.$element[b](0),this.transition("addClass",a.Event("show"),"shown"),a.support.transition&&this.$element[b](this.$element[0][c])}},hide:function(){var b;!this.transitioning&&this.$element.hasClass("in")&&(b=this.dimension(),this.reset(this.$element[b]()),this.transition("removeClass",a.Event("hide"),"hidden"),this.$element[b](0))},reset:function(a){var b=this.dimension();return this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element[null!==a?"addClass":"removeClass"]("collapse"),this},transition:function(b,c,d){var e=this,f=function(){"show"==c.type&&e.reset(),e.transitioning=0,e.$element.trigger(d)};this.$element.trigger(c),c.isDefaultPrevented()||(this.transitioning=1,this.$element[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("collapse"),f=a.extend({},a.fn.collapse.defaults,d.data(),"object"==typeof c&&c);e||d.data("collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.defaults={toggle:!0},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e).data("collapse")?"toggle":d.data();d[a(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),a(e).collapse(f)})}(window.jQuery);;var SwipeView=function(a,b){function c(a){return""===e?a:(a=a.charAt(0).toUpperCase()+a.substr(1),e+a)}var d=b.createElement("div").style,e=function(){for(var a,b="t,webkitT,MozT,msT,OT".split(","),c=0,e=b.length;e>c;c++)if(a=b[c]+"ransform",a in d)return b[c].substr(0,b[c].length-1);return!1}(),f=e?"-"+e.toLowerCase()+"-":"",g=c("transform"),h=c("transitionDuration"),i=c("perspective")in d,j="ontouchstart"in a,k=(c("transition")in d,i?" translateZ(0)":""),l="onorientationchange"in a?"orientationchange":"resize",m=j?"touchstart":"mousedown",n=j?"touchmove":"mousemove",o=j?"touchend":"mouseup",p=j?"touchcancel":"mouseup",q=function(){if(e===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return a[e]}(),r=function(c,d){var g,h,i,j;this.wrapper="string"==typeof c?b.querySelector(c):c,this.options={text:null,numberOfPages:3,snapThreshold:null,hastyPageFlip:!1,loop:!0};for(g in d)this.options[g]=d[g];for(this.wrapper.style.overflow="hidden",this.wrapper.style.position="relative",this.masterPages=[],h=b.createElement("div"),h.id="swipeview-slider",h.style.cssText="position:relative;top:0;height:100%;width:100%;"+f+"transition-duration:0;"+f+"transform:translateZ(0);"+f+"transition-timing-function:ease-out",this.wrapper.appendChild(h),this.slider=h,this.refreshSize(),g=-1;2>g;g++)h=b.createElement("div"),h.id="swipeview-masterpage-"+(g+1),h.style.cssText=f+"transform:translateZ(0);position:absolute;top:0;height:100%;width:100%;left:"+100*g+"%",h.dataset||(h.dataset={}),j=-1==g?this.options.numberOfPages-1:g,h.dataset.pageIndex=j,h.dataset.upcomingPageIndex=j,this.options.loop||-1!=g||(h.style.visibility="hidden"),this.slider.appendChild(h),this.masterPages.push(h);i=this.masterPages[1].className,this.masterPages[1].className=i?i+" swipeview-active":"swipeview-active",a.addEventListener(l,this,!1),this.wrapper.addEventListener(m,this,!1),this.wrapper.addEventListener(n,this,!1),this.wrapper.addEventListener(o,this,!1),this.slider.addEventListener(q,this,!1),"O"==e&&this.slider.addEventListener(q.toLowerCase(),this,!1)};return r.prototype={currentMasterPage:1,x:0,page:0,pageIndex:0,customEvents:[],onFlip:function(a){this.wrapper.addEventListener("swipeview-flip",a,!1),this.customEvents.push(["flip",a])},onMoveOut:function(a){this.wrapper.addEventListener("swipeview-moveout",a,!1),this.customEvents.push(["moveout",a])},onMoveIn:function(a){this.wrapper.addEventListener("swipeview-movein",a,!1),this.customEvents.push(["movein",a])},onTouchStart:function(a){this.wrapper.addEventListener("swipeview-touchstart",a,!1),this.customEvents.push(["touchstart",a])},destroy:function(){for(;this.customEvents.length;)this.wrapper.removeEventListener("swipeview-"+this.customEvents[0][0],this.customEvents[0][1],!1),this.customEvents.shift();a.removeEventListener(l,this,!1),this.wrapper.removeEventListener(m,this,!1),this.wrapper.removeEventListener(n,this,!1),this.wrapper.removeEventListener(o,this,!1),this.slider.removeEventListener(q,this,!1)},refreshSize:function(){this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.pageWidth=this.wrapperWidth,this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth,this.snapThreshold=null===this.options.snapThreshold?Math.round(.15*this.pageWidth):/%/.test(this.options.snapThreshold)?Math.round(this.pageWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},updatePageCount:function(a){this.options.numberOfPages=a,this.maxX=-this.options.numberOfPages*this.pageWidth+this.wrapperWidth},goToPage:function(a){var b;for(this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,""),b=0;3>b;b++)className=this.masterPages[b].className,/(^|\s)swipeview-loading(\s|$)/.test(className)||(this.masterPages[b].className=className?className+" swipeview-loading":"swipeview-loading");a=0>a?0:a>this.options.numberOfPages-1?this.options.numberOfPages-1:a,this.page=a,this.pageIndex=a,this.slider.style[h]="0s",this.__pos(-a*this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className+" swipeview-active",0===this.currentMasterPage?(this.masterPages[2].style.left=100*this.page-100+"%",this.masterPages[0].style.left=100*this.page+"%",this.masterPages[1].style.left=100*this.page+100+"%",this.masterPages[2].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[0].dataset.upcomingPageIndex=this.page,this.masterPages[1].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1):1==this.currentMasterPage?(this.masterPages[0].style.left=100*this.page-100+"%",this.masterPages[1].style.left=100*this.page+"%",this.masterPages[2].style.left=100*this.page+100+"%",this.masterPages[0].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[1].dataset.upcomingPageIndex=this.page,this.masterPages[2].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1):(this.masterPages[1].style.left=100*this.page-100+"%",this.masterPages[2].style.left=100*this.page+"%",this.masterPages[0].style.left=100*this.page+100+"%",this.masterPages[1].dataset.upcomingPageIndex=0===this.page?this.options.numberOfPages-1:this.page-1,this.masterPages[2].dataset.upcomingPageIndex=this.page,this.masterPages[0].dataset.upcomingPageIndex=this.page==this.options.numberOfPages-1?0:this.page+1),this.__flip()},next:function(){(this.options.loop||this.x!=this.maxX)&&(this.directionX=-1,this.x-=1,this.__checkPosition())},prev:function(){(this.options.loop||0!==this.x)&&(this.directionX=1,this.x+=1,this.__checkPosition())},handleEvent:function(a){switch(a.type){case m:this.__start(a);break;case n:this.__move(a);break;case p:case o:this.__end(a);break;case l:this.__resize();break;case q:case"otransitionend":a.target!=this.slider||this.options.hastyPageFlip||this.__flip()}},__pos:function(a){this.x=a,this.slider.style[g]="translate("+a+"px,0)"+k},__resize:function(){this.refreshSize(),this.slider.style[h]="0s",this.__pos(-this.page*this.pageWidth)},__start:function(a){if(!this.initiated){var b=j?a.touches[0]:a;this.initiated=!0,this.moved=!1,this.thresholdExceeded=!1,this.startX=b.pageX,this.startY=b.pageY,this.pointX=b.pageX,this.pointY=b.pageY,this.stepsX=0,this.stepsY=0,this.directionX=0,this.directionLocked=!1,this.slider.style[h]="0s",this.__event("touchstart")}},__move:function(a){if(this.initiated){var b=j?a.touches[0]:a,c=b.pageX-this.pointX,d=b.pageY-this.pointY,e=this.x+c,f=Math.abs(b.pageX-this.startX);if(this.moved=!0,this.pointX=b.pageX,this.pointY=b.pageY,this.directionX=c>0?1:0>c?-1:0,this.stepsX+=Math.abs(c),this.stepsY+=Math.abs(d),!(this.stepsX<10&&this.stepsY<10)){if(!this.directionLocked&&this.stepsY>this.stepsX)return void(this.initiated=!1);a.preventDefault(),this.directionLocked=!0,!this.options.loop&&(e>0||e<this.maxX)&&(e=this.x+c/2),!this.thresholdExceeded&&f>=this.snapThreshold?(this.thresholdExceeded=!0,this.__event("moveout")):this.thresholdExceeded&&f<this.snapThreshold&&(this.thresholdExceeded=!1,this.__event("movein")),this.__pos(e)}}},__end:function(a){if(this.initiated){var b=j?a.changedTouches[0]:a,c=Math.abs(b.pageX-this.startX);if(this.initiated=!1,this.moved)return!this.options.loop&&(this.x>0||this.x<this.maxX)&&(c=0,this.__event("movein")),c<this.snapThreshold?(this.slider.style[h]=Math.floor(300*c/this.snapThreshold)+"ms",void this.__pos(-this.page*this.pageWidth)):void this.__checkPosition()}},__checkPosition:function(){var a,b,c;this.masterPages[this.currentMasterPage].className=this.masterPages[this.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,""),this.directionX>0?(this.page=-Math.ceil(this.x/this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.pageIndex=0===this.pageIndex?this.options.numberOfPages-1:this.pageIndex-1,a=this.currentMasterPage-1,a=0>a?2:a,this.masterPages[a].style.left=100*this.page-100+"%",b=this.page-1):(this.page=-Math.floor(this.x/this.pageWidth),this.currentMasterPage=this.page+1-3*Math.floor((this.page+1)/3),this.pageIndex=this.pageIndex==this.options.numberOfPages-1?0:this.pageIndex+1,a=this.currentMasterPage+1,a=a>2?0:a,this.masterPages[a].style.left=100*this.page+100+"%",b=this.page+1),c=this.masterPages[this.currentMasterPage].className,/(^|\s)swipeview-active(\s|$)/.test(c)||(this.masterPages[this.currentMasterPage].className=c?c+" swipeview-active":"swipeview-active"),c=this.masterPages[a].className,/(^|\s)swipeview-loading(\s|$)/.test(c)||(this.masterPages[a].className=c?c+" swipeview-loading":"swipeview-loading"),b-=Math.floor(b/this.options.numberOfPages)*this.options.numberOfPages,this.masterPages[a].dataset.upcomingPageIndex=b,newX=-this.page*this.pageWidth,this.slider.style[h]=Math.floor(500*Math.abs(this.x-newX)/this.pageWidth)+"ms",this.options.loop||(this.masterPages[a].style.visibility=0===newX||newX==this.maxX?"hidden":""),this.x==newX?this.__flip():(this.__pos(newX),this.options.hastyPageFlip&&this.__flip())},__flip:function(){this.__event("flip");for(var a=0;3>a;a++)this.masterPages[a].className=this.masterPages[a].className.replace(/(^|\s)swipeview-loading(\s|$)/,""),this.masterPages[a].dataset.pageIndex=this.masterPages[a].dataset.upcomingPageIndex},__event:function(a){var c=b.createEvent("Event");c.initEvent("swipeview-"+a,!0,!0),this.wrapper.dispatchEvent(c)}},r}(window,document);;var old=$.fn.wizard,Wizard=function(a,b){var c;this.$element=$(a),this.options=$.extend({},$.fn.wizard.defaults,b),this.options.disablePreviousStep="previous"===this.$element.data().restrict?!0:!1,this.currentStep=this.options.selectedItem.step,this.numSteps=this.$element.find(".steps li").length,this.$prevBtn=this.$element.find("button.btn-prev"),this.$nextBtn=this.$element.find("button.btn-next"),c=this.$nextBtn.children().detach(),this.nextText=$.trim(this.$nextBtn.text()),this.$nextBtn.append(c),this.$prevBtn.on("click",$.proxy(this.previous,this)),this.$nextBtn.on("click",$.proxy(this.next,this)),this.$element.on("click","li.complete",$.proxy(this.stepclicked,this)),this.currentStep>1&&this.selectedItem(this.options.selectedItem),this.options.disablePreviousStep&&(this.$prevBtn.attr("disabled",!0),this.$element.find(".steps").addClass("previous-disabled"))};Wizard.prototype={constructor:Wizard,setState:function(){var a=this.currentStep>1,b=1===this.currentStep,c=this.currentStep===this.numSteps;this.options.disablePreviousStep||this.$prevBtn.attr("disabled",b===!0||a===!1);var d=this.$nextBtn.data();if(d&&d.last&&(this.lastText=d.last,"undefined"!=typeof this.lastText)){var e=c!==!0?this.nextText:this.lastText,f=this.$nextBtn.children().detach();this.$nextBtn.text(e).append(f)}var g=this.$element.find(".steps li");g.removeClass("active").removeClass("complete"),g.find("span.badge").removeClass("badge-info").removeClass("badge-success");var h=".steps li:lt("+(this.currentStep-1)+")",i=this.$element.find(h);i.addClass("complete"),i.find("span.badge").addClass("badge-success");var j=".steps li:eq("+(this.currentStep-1)+")",k=this.$element.find(j);k.addClass("active"),k.find("span.badge").addClass("badge-info");var l=k.data().target;this.$element.next(".step-content").find(".step-pane").removeClass("active"),$(l).addClass("active"),this.$element.find(".steps").first().attr("style","margin-left: 0");var m=0;this.$element.find(".steps > li").each(function(){m+=$(this).outerWidth()});var n=0;if(n=this.$element.find(".actions").length?this.$element.width()-this.$element.find(".actions").first().outerWidth():this.$element.width(),m>n){var o=m-n;this.$element.find(".steps").first().attr("style","margin-left: -"+o+"px"),this.$element.find("li.active").first().position().left<200&&(o+=this.$element.find("li.active").first().position().left-200,1>o?this.$element.find(".steps").first().attr("style","margin-left: 0"):this.$element.find(".steps").first().attr("style","margin-left: -"+o+"px"))}this.$element.trigger("changed")},stepclicked:function(a){var b=$(a.currentTarget),c=this.$element.find(".steps li").index(b),d=!0;if(this.options.disablePreviousStep&&c<this.currentStep&&(d=!1),d){var e=$.Event("stepclick");if(this.$element.trigger(e,{step:c+1}),e.isDefaultPrevented())return;this.currentStep=c+1,this.setState()}},previous:function(){var a=this.currentStep>1;if(this.options.disablePreviousStep&&(a=!1),a){var b=$.Event("change");if(this.$element.trigger(b,{step:this.currentStep,direction:"previous"}),b.isDefaultPrevented())return;this.currentStep-=1,this.setState()}},next:function(){var a=this.currentStep+1<=this.numSteps,b=this.currentStep===this.numSteps;if(a){var c=$.Event("change");if(this.$element.trigger(c,{step:this.currentStep,direction:"next"}),c.isDefaultPrevented())return;this.currentStep+=1,this.setState()}else b&&this.$element.trigger("finished")},selectedItem:function(a){var b,c;return a?(c=a.step||-1,c>=1&&c<=this.numSteps&&(this.currentStep=c,this.setState()),b=this):b={step:this.currentStep},b}},$.fn.wizard=function(a){var b,c=Array.prototype.slice.call(arguments,1),d=this.each(function(){var d=$(this),e=d.data("wizard"),f="object"==typeof a&&a;e||d.data("wizard",e=new Wizard(this,f)),"string"==typeof a&&(b=e[a].apply(e,c))});return void 0===b?d:b},$.fn.wizard.defaults={selectedItem:{step:1}},$.fn.wizard.Constructor=Wizard,$.fn.wizard.noConflict=function(){return $.fn.wizard=old,this},$(function(){$("body").on("mouseover.wizard.data-api",".wizard",function(){var a=$(this);a.data("wizard")||a.wizard(a.data())})});;"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length)return str("",{"":a});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b){"use strict";var c=a.History=a.History||{};if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");c.Adapter={handlers:{},_uid:1,uid:function(a){return a._uid||(a._uid=c.Adapter._uid++)},bind:function(a,b,d){var e=c.Adapter.uid(a);c.Adapter.handlers[e]=c.Adapter.handlers[e]||{},c.Adapter.handlers[e][b]=c.Adapter.handlers[e][b]||[],c.Adapter.handlers[e][b].push(d),a["on"+b]=function(a,b){return function(d){c.Adapter.trigger(a,b,d)}}(a,b)},trigger:function(a,b,d){d=d||{};var e,f,g=c.Adapter.uid(a);for(c.Adapter.handlers[g]=c.Adapter.handlers[g]||{},c.Adapter.handlers[g][b]=c.Adapter.handlers[g][b]||[],e=0,f=c.Adapter.handlers[g][b].length;f>e;++e)c.Adapter.handlers[g][b][e].apply(this,[d])},extractEventData:function(a,c){var d=c&&c[a]||b;return d},onDomLoad:function(b){var c=a.setTimeout(function(){b()},2e3);a.onload=function(){clearTimeout(c),b()}}},"undefined"!=typeof c.init&&c.init()}(window),function(a,b){"use strict";var c=a.document,d=a.setTimeout||d,e=a.clearTimeout||e,f=a.setInterval||f,g=a.History=a.History||{};if("undefined"!=typeof g.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");g.initHtml4=function(){return"undefined"!=typeof g.initHtml4.initialized?!1:(g.initHtml4.initialized=!0,g.enabled=!0,g.savedHashes=[],g.isLastHash=function(a){var b,c=g.getHashByIndex();return b=a===c},g.isHashEqual=function(a,b){return a=encodeURIComponent(a).replace(/%25/g,"%"),b=encodeURIComponent(b).replace(/%25/g,"%"),a===b},g.saveHash=function(a){return g.isLastHash(a)?!1:(g.savedHashes.push(a),!0)},g.getHashByIndex=function(a){var b=null;return b="undefined"==typeof a?g.savedHashes[g.savedHashes.length-1]:0>a?g.savedHashes[g.savedHashes.length+a]:g.savedHashes[a]},g.discardedHashes={},g.discardedStates={},g.discardState=function(a,b,c){var d,e=g.getHashByState(a);return d={discardedState:a,backState:c,forwardState:b},g.discardedStates[e]=d,!0},g.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};return g.discardedHashes[a]=d,!0},g.discardedState=function(a){var b,c=g.getHashByState(a);return b=g.discardedStates[c]||!1},g.discardedHash=function(a){var b=g.discardedHashes[a]||!1;return b},g.recycleState=function(a){var b=g.getHashByState(a);return g.discardedState(a)&&delete g.discardedStates[b],!0},g.emulated.hashChange&&(g.hashChangeInit=function(){g.checkerFunction=null;var b,d,e,h,i="",j=Boolean(g.getHash());return g.isInternetExplorer()?(b="historyjs-iframe",d=c.createElement("iframe"),d.setAttribute("id",b),d.setAttribute("src","#"),d.style.display="none",c.body.appendChild(d),d.contentWindow.document.open(),d.contentWindow.document.close(),e="",h=!1,g.checkerFunction=function(){if(h)return!1;h=!0;var b=g.getHash(),c=g.getHash(d.contentWindow.document);return b!==i?(i=b,c!==b&&(e=c=b,d.contentWindow.document.open(),d.contentWindow.document.close(),d.contentWindow.document.location.hash=g.escapeHash(b)),g.Adapter.trigger(a,"hashchange")):c!==e&&(e=c,j&&""===c?g.back():g.setHash(c,!1)),h=!1,!0}):g.checkerFunction=function(){var b=g.getHash()||"";return b!==i&&(i=b,g.Adapter.trigger(a,"hashchange")),!0},g.intervalList.push(f(g.checkerFunction,g.options.hashChangeInterval)),!0},g.Adapter.onDomLoad(g.hashChangeInit)),g.emulated.pushState&&(g.onHashChange=function(b){var c,d=b&&b.newURL||g.getLocationHref(),e=g.getHashByUrl(d),f=null,h=null;return g.isLastHash(e)?(g.busy(!1),!1):(g.doubleCheckComplete(),g.saveHash(e),e&&g.isTraditionalAnchor(e)?(g.Adapter.trigger(a,"anchorchange"),g.busy(!1),!1):(f=g.extractState(g.getFullUrl(e||g.getLocationHref()),!0),g.isLastSavedState(f)?(g.busy(!1),!1):(h=g.getHashByState(f),c=g.discardedState(f),c?(g.getHashByIndex(-2)===g.getHashByState(c.forwardState)?g.back(!1):g.forward(!1),!1):(g.pushState(f.data,f.title,encodeURI(f.url),!1),!0))))},g.Adapter.bind(a,"hashchange",g.onHashChange),g.pushState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),g.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(e!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:e}),!1;g.busy(!0);var f=g.createStateObject(b,c,d),h=g.getHashByState(f),i=g.getState(!1),j=g.getHashByState(i),k=g.getHash(),l=g.expectedStateId==f.id;return g.storeState(f),g.expectedStateId=f.id,g.recycleState(f),g.setTitle(f),h===j?(g.busy(!1),!1):(g.saveState(f),l||g.Adapter.trigger(a,"statechange"),!g.isHashEqual(h,k)&&!g.isHashEqual(h,g.getShortUrl(g.getLocationHref()))&&g.setHash(h,!1),g.busy(!1),!0)},g.replaceState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),g.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(e!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:e}),!1;g.busy(!0);var f=g.createStateObject(b,c,d),h=g.getHashByState(f),i=g.getState(!1),j=g.getHashByState(i),k=g.getStateByIndex(-2);return g.discardState(i,f,k),h===j?(g.storeState(f),g.expectedStateId=f.id,g.recycleState(f),g.setTitle(f),g.saveState(f),g.Adapter.trigger(a,"statechange"),g.busy(!1)):g.pushState(f.data,f.title,f.url,!1),!0}),g.emulated.pushState&&g.getHash()&&!g.emulated.hashChange&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(a,"hashchange")}),void 0)},"undefined"!=typeof g.init&&g.init()}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;try{f=a.sessionStorage,f.setItem("TEST","1"),f.removeItem("TEST")}catch(o){f=!1}if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");m.init=function(a){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(o){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.disableSuid=m.options.disableSuid||!1,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.options.html4Mode=m.options.html4Mode||!1,m.options.delayInit=m.options.delayInit||!1,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h="undefined"!=typeof c&&"undefined"!=typeof c.log&&"undefined"!=typeof c.log.apply,i=d.getElementById("log");for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;e>b;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)}catch(j){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.options.html4Mode?m.emulated={pushState:!0,hashChange:!0}:m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||m.getLocationHref();return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.getLocationHref=function(a){return a=a||d,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:-1==a.URL.indexOf("#")&&-1!=a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof m.idToState[c]||"undefined"!=typeof m.store.idToState[c];);m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(a.url?a.url:m.getLocationHref()),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&m.options.disableSuid!==!0&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d,e;return e=-1!=a.indexOf("#")?a.split("#")[0]:a,c=/(.*)\&_suid=([0-9]+)$/.exec(e),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),!e&&b&&!m.isTraditionalAnchor(a)&&(e=m.createStateObject(null,null,d))),e},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]},m.getCurrentIndex=function(){var a=null;return a=m.savedStates.length<1?0:m.savedStates.length-1},m.getHash=function(a){var b,c=m.getLocationHref(a);return b=m.getHashByUrl(c)},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=decodeURIComponent(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(m.busy(!0),c=m.extractState(a,!0),c&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(e=m.getPageUrl(),m.pushState(null,null,e+"#"+a,!1)):d.location.hash=a),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.encodeURIComponent(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(m.getLocationHref());return m.isLastSavedState(c)?void 0:(b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m)},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var p=function(){};m.pushState=m.pushState||p,m.replaceState=m.replaceState||p}else m.onPopState=function(b,c){var d,e,f=!1,g=!1;return m.doubleCheckComplete(),d=m.getHash(),d?(e=m.extractState(d||m.getLocationHref(),!0),e?m.replaceState(e.data,e.title,e.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(f=m.Adapter.extractEventData("state",b,c)||!1,g=f?m.getStateById(f):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()),g||(g=m.createStateObject(null,null,m.getLocationHref())),m.expectedStateId=!1,m.isLastSavedState(g)?(m.busy(!1),!1):(m.storeState(g),m.saveState(g),m.setTitle(g),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(q){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0))),f&&(m.onUnload=function(){var a,b,c;try{a=k.parse(f.getItem("History.store"))||{}}catch(d){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),c=k.stringify(a);try{f.setItem("History.store",c)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;f.length&&(f.removeItem("History.store"),f.setItem("History.store",c))}},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},(!m.options||!m.options.delayInit)&&m.init()}(window);;!function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){function b(a){return parseInt(a,10)||0}function c(a){return!isNaN(parseInt(a,10))}a.widget("ui.resizable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;b.length>c;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(c){var d,e,f,g=this.options,h=this.element.position(),i=this.element;return this.resizing=!0,/absolute/.test(i.css("position"))?i.css({position:"absolute",top:i.css("top"),left:i.css("left")}):i.is(".ui-draggable")&&i.css({position:"absolute",top:h.top,left:h.left}),this._renderProxy(),d=b(this.helper.css("left")),e=b(this.helper.css("top")),g.containment&&(d+=a(g.containment).scrollLeft()||0,e+=a(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalPosition={left:d,top:e},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===f?this.axis+"-resize":f),i.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(b){var c,d=this.helper,e={},f=this.originalMousePosition,g=this.axis,h=this.position.top,i=this.position.left,j=this.size.width,k=this.size.height,l=b.pageX-f.left||0,m=b.pageY-f.top||0,n=this._change[g];return n?(c=n.apply(this,[b,l,m]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),this.position.top!==h&&(e.top=this.position.top+"px"),this.position.left!==i&&(e.left=this.position.left+"px"),this.size.width!==j&&(e.width=this.size.width+"px"),this.size.height!==k&&(e.height=this.size.height+"px"),d.css(e),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(e)||this._trigger("resize",b,this.ui()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&a.ui.hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b,d,e,f,g,h=this.options;g={minWidth:c(h.minWidth)?h.minWidth:0,maxWidth:c(h.maxWidth)?h.maxWidth:1/0,minHeight:c(h.minHeight)?h.minHeight:0,maxHeight:c(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),g.maxWidth>d&&(g.maxWidth=d),g.maxHeight>f&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=b.left+(d.width-a.width),a.top=null),"nw"===e&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d),l=/nw|ne|n/.test(d);return g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&l&&(a.top=j-b.minHeight),f&&l&&(a.top=j-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var a,b,c,d,e,f=this.helper||this.element;for(a=0;this._proportionallyResizeElements.length>a;a++){if(e=this._proportionallyResizeElements[a],!this.borderDif)for(this.borderDif=[],c=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],d=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")],b=0;c.length>b;b++)this.borderDif[b]=(parseInt(c[b],10)||0)+(parseInt(d[b],10)||0);e.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("ui-resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c,d,e,f,g,h,i,j=a(this).data("ui-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=a(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(c=a(n),d=[],a(["Top","Right","Left","Bottom"]).each(function(a,e){d[a]=b(c.css("padding"+e))}),j.containerOffset=c.offset(),j.containerPosition=c.position(),j.containerSize={height:c.innerHeight()-d[3],width:c.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=a.ui.hasScroll(n,"left")?n.scrollWidth:g,i=a.ui.hasScroll(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(b){var c,d,e,f,g=a(this).data("ui-resizable"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio),g.position.top=g._helper?i.top:0),g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top,c=Math.abs((g._helper?g.offset.left-l.left:g.offset.left-l.left)+g.sizeDiff.width),d=Math.abs((g._helper?g.offset.top-l.top:g.offset.top-i.top)+g.sizeDiff.height),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f&&(c-=g.parentData.left),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio))},stop:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("ui-resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("ui-resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("ui-resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&m>c.maxWidth,p=c.maxHeight&&n>c.maxHeight,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):(b.size.width=m,b.size.height=n,b.position.top=f.top-l,b.position.left=f.left-k)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}function c(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||c(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){
this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:b+this.helperProportions.width/2>f&&g>c-this.helperProportions.width/2&&d+this.helperProportions.height/2>h&&i>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var c="x"===this.options.axis||b(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||b(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var c=b(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=b(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c,d,e,f,g=[],h=[],i=this._connectWith();if(i&&b)for(c=i.length-1;c>=0;c--)for(e=a(i[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&h.push([a.isFunction(f.options.items)?f.options.items.call(f.element):a(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f]);for(h.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),c=h.length-1;c>=0;c--)h[c][0].each(function(){g.push(this)});return a(g)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;b.length>c;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(d){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",d,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||c(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!n||b(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),g>Math.abs(l-k)&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down"));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(d,h,null,!0):this._rearrange(d,null,this.containers[p].element,!0),this._trigger("change",d,this._uiHash()),this.containers[p]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){this.reverting=!1;var c,d=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)("auto"===this._storedCSS[c]||"static"===this._storedCSS[c])&&(this._storedCSS[c]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||d.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(d.push(function(a){this._trigger("remove",a,this._uiHash())}),d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),c=this.containers.length-1;c>=0;c--)b||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),c=0;d.length>c;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(c=0;d.length>c;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery);;!function(a){a.fn.fastClick=function(b){return a(this).each(function(){a.FastButton(a(this)[0],b)})},a.FastButton=function(b,c){var d,e,f=function(){a(b).unbind("touchend"),a("body").unbind("touchmove.fastClick")},g=function(b){b.stopPropagation(),f(),c.call(this,b),"touchend"===b.type&&a.clickbuster.preventGhostClick(d,e)},h=function(a){(Math.abs(a.originalEvent.touches[0].clientX-d)>10||Math.abs(a.originalEvent.touches[0].clientY-e)>10)&&f()},i=function(c){c.stopPropagation(),a(b).bind("touchend",g),a("body").bind("touchmove.fastClick",h),d=c.originalEvent.touches[0].clientX,e=c.originalEvent.touches[0].clientY};a(b).bind({touchstart:i,click:g})},a.clickbuster={coordinates:[],preventGhostClick:function(b,c){a.clickbuster.coordinates.push(b,c),window.setTimeout(a.clickbuster.pop,2500)},pop:function(){a.clickbuster.coordinates.splice(0,2)},onClick:function(b){var c,d,e;for(e=0;e<a.clickbuster.coordinates.length;e+=2)c=a.clickbuster.coordinates[e],d=a.clickbuster.coordinates[e+1],Math.abs(b.clientX-c)<25&&Math.abs(b.clientY-d)<25&&(b.stopPropagation(),b.preventDefault())}},a(function(){document.addEventListener?document.addEventListener("click",a.clickbuster.onClick,!0):document.attachEvent&&document.attachEvent("onclick",a.clickbuster.onClick)})}(jQuery);;!function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind("touchstart",a.proxy(b,"_touchStart")).bind("touchmove",a.proxy(b,"_touchMove")).bind("touchend",a.proxy(b,"_touchEnd")),e.call(b)}}}(jQuery);;function bkClass(){}function $BK(a){return"string"==typeof a&&(a=document.getElementById(a)),a&&!a.appendTo?bkExtend(a,bkElement.prototype):a}function __(a){return a}var bkExtend=function(){var a=arguments;1==a.length&&(a=[this,a[0]]);for(var b in a[1])a[0][b]=a[1][b];return a[0]};bkClass.prototype.construct=function(){},bkClass.extend=function(a){var b=function(){return arguments[0]!==bkClass?this.construct.apply(this,arguments):void 0},c=new this(bkClass);return bkExtend(c,a),b.prototype=c,b.extend=this.extend,b};var bkElement=bkClass.extend({construct:function(a,b){return"string"==typeof a&&(a=(b||document).createElement(a)),a=$BK(a)},appendTo:function(a){return a.appendChild(this),this},appendBefore:function(a){return a.parentNode.insertBefore(this,a),this},addEvent:function(a,b){return bkLib.addEvent(this,a,b),this},setContent:function(a){return this.innerHTML=a,this},pos:function(){var a=curtop=0;obj=this;if(obj.offsetParent)do a+=obj.offsetLeft,curtop+=obj.offsetTop;while(obj=obj.offsetParent);var b=window.opera?0:parseInt(this.getStyle("border-width")||this.style.border)||0;return[a+b,curtop+b+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(a){var b=this;do{if(b&&b.nodeName&&b.nodeName.toUpperCase()==a)return b;b=b.parentNode}while(b);return!1},hasClass:function(a){return this.className.match(new RegExp("(\\s|^)nicEdit-"+a+"(\\s|$)"))},addClass:function(a){return this.hasClass(a)||(this.className+=" nicEdit-"+a),this},removeClass:function(a){return this.hasClass(a)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+a+"(\\s|$)")," ")),this},setStyle:function(a){var b=this.style;for(var c in a)switch(c){case"float":b.cssFloat=b.styleFloat=a[c];break;case"opacity":b.opacity=a[c],b.filter="alpha(opacity="+Math.round(100*a[c])+")";break;case"className":this.className=a[c];break;default:b[c]=a[c]}return this},getStyle:function(a,b){var c=b?b:document.defaultView;return 1==this.nodeType?c&&c.getComputedStyle?c.getComputedStyle(this,null).getPropertyValue(a):this.currentStyle[bkLib.camelize(a)]:void 0},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(a){for(var b in a)this[b]=a[b];return this}}),bkLib={isMSIE:-1!=navigator.appVersion.indexOf("MSIE"),addEvent:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},toArray:function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c},noSelect:function(a){a.setAttribute&&"input"!=a.nodeName.toLowerCase()&&"textarea"!=a.nodeName.toLowerCase()&&a.setAttribute("unselectable","on");for(var b=0;b<a.childNodes.length;b++)bkLib.noSelect(a.childNodes[b])},camelize:function(a){return a.replace(/\-(.)/g,function(a,b){return b.toUpperCase()})},inArray:function(a,b){return null!=bkLib.search(a,b)},search:function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return c;return null},cancelEvent:function(a){return a=a||window.event,a.preventDefault&&a.stopPropagation&&(a.preventDefault(),a.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(a){this.domLoad.push(a),document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }</style><script id=__ie_onload defer "+("https:"==location.protocol?"src='javascript:void(0)'":"src=//0")+"></script>"),$BK("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&bkLib.domLoaded()}),window.onload=bkLib.domLoaded}},bkEvent={addEvent:function(a,b){return b&&(this.eventList=this.eventList||{},this.eventList[a]=this.eventList[a]||[],this.eventList[a].push(b)),this},fireEvent:function(){var a=bkLib.toArray(arguments),b=a.shift();if(this.eventList&&this.eventList[b])for(var c=0;c<this.eventList[b].length;c++)this.eventList[b][c].apply(this,a)}};Function.prototype.closure=function(){var a=this,b=bkLib.toArray(arguments),c=b.shift();return function(){return"undefined"!=typeof bkLib?a.apply(c,b.concat(bkLib.toArray(arguments))):void 0}},Function.prototype.closureListener=function(){var a=this,b=bkLib.toArray(arguments),c=b.shift();return function(d){if(d=d||window.event,d.target)var e=d.target;else var e=d.srcElement;return a.apply(c,[d,e].concat(b))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b"},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i"},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u"},left:{name:__("Left Align"),command:"justifyleft",noActive:!0},center:{name:__("Center Align"),command:"justifycenter",noActive:!0},right:{name:__("Right Align"),command:"justifyright",noActive:!0},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"]},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"]},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"]},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"]},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"}},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},iconsPath:"resources/icons/nicEditorIcons.gif",buttonList:["save","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","bgcolor"],iconList:{xhtml:1,bgcolor:2,forecolor:3,bold:4,center:5,hr:6,indent:7,italic:8,justify:9,left:10,ol:11,outdent:12,removeformat:13,right:14,save:25,strikethrough:16,subscript:17,superscript:18,ul:19,underline:20,image:21,link:22,unlink:23,close:24,arrow:26,upload:27},initWithLineBreak:!0}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(a,b){this.nicPlugins.push({p:a,o:b})},allTextAreas:function(a){for(var b=document.getElementsByTagName("textarea"),c=0;c<b.length;c++)nicEditors.editors.push(new nicEditor(a).panelInstance(b[c]));return nicEditors.editors},findEditor:function(a){for(var b=nicEditors.editors,c=0;c<b.length;c++)if(b[c].instanceById(a))return b[c]}},nicEditor=bkClass.extend({construct:function(a){this.options=new nicEditorConfig,bkExtend(this.options,a),this.nicInstances=new Array,this.loadedPlugins=new Array;for(var b=nicEditors.nicPlugins,c=0;c<b.length;c++)this.loadedPlugins.push(new b[c].p(this,b[c].o));nicEditors.editors.push(this),bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(a,b){a=this.checkReplace($BK(a));var c=new bkElement("DIV").setStyle({width:(parseInt(a.getStyle("width"))||a.clientWidth)+"px"}).appendBefore(a);return this.setPanel(c),this.addInstance(a,b)},checkReplace:function(a){var b=nicEditors.findEditor(a);return b&&(b.removeInstance(a),b.removePanel()),a},addInstance:function(a,b){if(a=this.checkReplace($BK(a)),a.contentEditable||window.opera)var c=new nicEditorInstance(a,b,this);else var c=new nicEditorIFrameInstance(a,b,this);return this.nicInstances.push(c),this},removeInstance:function(a){a=$BK(a);for(var b=this.nicInstances,c=0;c<b.length;c++)b[c].e==a&&(b[c].remove(),this.nicInstances.splice(c,1))},removePanel:function(a){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(a){a=$BK(a);for(var b=this.nicInstances,c=0;c<b.length;c++)if(b[c].e==a)return b[c]},setPanel:function(a){return this.nicPanel=new nicEditorPanel($BK(a),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(a,b){this.selectedInstance&&this.selectedInstance.nicCommand(a,b)},getIcon:function(a,b){var c=this.options.iconList[a],d=b.iconFiles?b.iconFiles[a]:"";return{backgroundImage:"url('"+(c?this.options.iconsPath:d)+"')",backgroundPosition:(c?-18*(c-1):0)+"px 0px"}},selectCheck:function(a,b){do if(b.className&&-1!=b.className.indexOf("nicEdit"))return!1;while(b=b.parentNode);return this.fireEvent("blur",this.selectedInstance,b),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}});nicEditor=nicEditor.extend(bkEvent);var nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(a,b,c){this.ne=c,this.elm=this.e=a,this.options=b||{},newX=parseInt(a.getStyle("width"))||a.clientWidth,newY=parseInt(a.getStyle("height"))||a.clientHeight,this.initialHeight=newY-8;var d="textarea"==a.nodeName.toLowerCase();if(d||this.options.hasPanel){var e=bkLib.isMSIE&&!("undefined"!=typeof document.body.style.maxHeight&&"CSS1Compat"==document.compatMode),f={width:newX+"px",border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden"};f[e?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(f).appendBefore(a);var g=new bkElement("DIV").setStyle({width:newX-8+"px",margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain);if(a.setStyle({display:"none"}),g.innerHTML=a.innerHTML,d){g.setContent(a.value),this.copyElm=a;var h=a.parentTag("FORM");h&&bkLib.addEvent(h,"submit",this.saveContent.closure(this))}g.setStyle(e?{height:newY+"px"}:{overflow:"hidden"}),this.elm=g}this.ne.addEvent("blur",this.blur.closure(this)),this.init(),this.blur()},init:function(){this.elm.setAttribute("contentEditable","true"),""==this.getContent()&&this.options.initWithLineBreak&&this.setContent("<br />"),this.instanceDoc=document.defaultView,this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},remove:function(){this.saveContent(),(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel()),this.disable(),this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var a=this.getSel();return a?a.rangeCount>0?a.getRangeAt(0):a.createRange&&a.createRange()||document.createRange():null},selRng:function(a,b){window.getSelection?(b.removeAllRanges(),b.addRange(a)):a.select()},selElm:function(){var a=this.getRng();if(a.startContainer){var b=a.startContainer;if(1==a.cloneContents().childNodes.length)for(var c=0;c<b.childNodes.length;c++){var d=b.childNodes[c].ownerDocument.createRange();if(d.selectNode(b.childNodes[c]),1!=a.compareBoundaryPoints(Range.START_TO_START,d)&&-1!=a.compareBoundaryPoints(Range.END_TO_END,d))return $BK(b.childNodes[c])}return $BK(b)}return $BK("Control"==this.getSel().type?a.item(0):a.parentElement())},saveRng:function(){this.savedRange=this.getRng(),this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(a,b){this.ne.fireEvent("keyDown",this,a),a.ctrlKey&&this.ne.fireEvent("key",this,a)},selected:function(a,b){if(b||(b=this.selElm()),!a.ctrlKey){var c=this.ne.selectedInstance;c!=this&&(c&&this.ne.fireEvent("blur",c,b),this.ne.selectedInstance=this,this.ne.fireEvent("focus",c,b)),this.ne.fireEvent("selected",c,b),this.isFocused=!0,this.elm.addClass("selected")}return!1},blur:function(){this.isFocused=!1,this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(a){this.content=a,this.ne.fireEvent("set",this),this.elm.innerHTML=this.content},nicCommand:function(a,b){document.execCommand(a,!1,b)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var a=this.elm.innerHTML.replace(/^\s+|\s+$/g,"");this.elm.innerHTML="",a?a:a="<br />",this.initialContent=a,this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm),this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});var b=["font-size","font-family","font-weight","color"];for(itm in b)this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var a=$BK(this.elmFrame.contentWindow.document);a.designMode="on",a.open();var b=this.ne.options.externalCSS;a.write("<html><head>"+(b?'<link href="'+b+'" rel="stylesheet" type="text/css" />':"")+'</head><body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">'+this.initialContent+"</body></html>"),a.close(),this.frameDoc=a,this.frameWin=$BK(this.elmFrame.contentWindow),this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles),this.instanceDoc=this.frameWin.document.defaultView,this.heightUpdate(),this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(a){this.content=a,this.ne.fireEvent("set",this),this.frameContent.innerHTML=this.content,this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(a,b){this.frameDoc.execCommand(a,!1,b),setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(a,b,c){this.elm=a,this.options=b,this.ne=c,this.panelButtons=new Array,this.buttonList=bkExtend([],this.ne.options.buttonList),this.panelContain=new bkElement("DIV").setStyle({overflow:"hidden",width:"100%",border:"1px solid #cccccc",backgroundColor:"#efefef"}).addClass("panelContain"),this.panelElm=new bkElement("DIV").setStyle({margin:"2px",marginTop:"0px",zoom:1,overflow:"hidden"}).addClass("panel").appendTo(this.panelContain),this.panelContain.appendTo(a);var d=this.ne.options,e=d.buttons;for(button in e)this.addButton(button,d,!0);this.reorder(),a.noSelect()},addButton:function(buttonName,options,noOrder){var button=options.buttons[buttonName],type=button.type?eval("(typeof("+button.type+') == "undefined") ? null : '+button.type+";"):nicEditorButton,hasButton=bkLib.inArray(this.buttonList,buttonName);type&&(hasButton||this.ne.options.fullPanel)&&(this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne)),hasButton||this.buttonList.push(buttonName))},findButton:function(a){for(var b=0;b<this.panelButtons.length;b++)if(this.panelButtons[b].name==a)return this.panelButtons[b]},reorder:function(){for(var a=this.buttonList,b=0;b<a.length;b++){var c=this.findButton(a[b]);c&&this.panelElm.appendChild(c.margin)}},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(a,b,c,d){this.options=c.buttons[b],this.name=b,this.ne=d,this.elm=a,this.margin=new bkElement("DIV").setStyle({"float":"left",marginTop:"2px"}).appendTo(a),this.contain=new bkElement("DIV").setStyle({width:"20px",height:"20px"}).addClass("buttonContain").appendTo(this.margin),this.border=new bkElement("DIV").setStyle({backgroundColor:"#efefef",border:"1px solid #efefef"}).appendTo(this.contain),this.button=new bkElement("DIV").setStyle({width:"18px",height:"18px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(b,c)).appendTo(this.border),this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect(),window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent),d.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this)),this.disable(),this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(a){switch(a){case"hover":var b={border:"1px solid #666",backgroundColor:"#ddd"};break;case"active":var b={border:"1px solid #666",backgroundColor:"#ccc"};break;default:var b={border:"1px solid #efefef",backgroundColor:"#efefef"}}this.border.setStyle(b).addClass("button-"+a)},checkNodes:function(a){var b=a;do if(this.options.tags&&bkLib.inArray(this.options.tags,b.nodeName))return this.activate(),!0;while((b=b.parentNode)&&"nicEdit"!=b.className);for(b=$BK(a);3==b.nodeType;)b=$BK(b.parentNode);if(this.options.css)for(itm in this.options.css)if(b.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1,this.updateState(),this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(a,b){this.isDisabled=!1,this.contain.setStyle({opacity:1}).addClass("buttonEnabled"),this.updateState(),b!==document&&this.checkNodes(b)},disable:function(a,b){this.isDisabled=!0,this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled"),this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1,this.updateState(),this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive()),this.ne.fireEvent("buttonClick",this)},key:function(a,b){this.options.key&&b.ctrlKey&&String.fromCharCode(b.keyCode||b.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),b.preventDefault&&b.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(a,b){this.options=b,this.ne=a,this.ne.addEvent("panel",this.loadPanel.closure(this)),this.init()},loadPanel:function(a){var b=this.options.buttons;for(var c in b)a.addButton(c,this.options);a.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(a,b,c,d){this.ne=b,this.elm=a,this.pos=a.pos(),this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"}),this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(c).appendTo(this.contain),d&&!d.options.noClose&&(this.close=new bkElement("div").setStyle({"float":"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",d.removePane.closure(this)).appendTo(this.pane)),this.contain.noSelect().appendTo(document.body),this.position(),this.init()},init:function(){},position:function(){if(this.ne.nicPanel){var a=this.ne.nicPanel.elm,b=a.pos(),c=b[0]+parseInt(a.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8);c<this.pos[0]&&this.contain.setStyle({left:c+"px"})}},toggle:function(){this.isVisible=!this.isVisible,this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(a){a.appendTo(this.pane)},setContent:function(a){this.pane.setContent(a)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(a,b){this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this)),this.pane.append(this.form),this.inputs={};for(itm in a){var c=a[itm],d="";b&&(d=b.getAttribute(itm)),d||(d=c.value||"");var e=a[itm].type;if("title"==e)new bkElement("div").setContent(c.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{var f=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);switch(c.txt&&new bkElement("label").setAttributes({"for":itm}).setContent(c.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right","float":"left"}).appendTo(f),e){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:d,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px","float":"left",height:"20px",border:"1px solid #ccc",overflow:"hidden"}).setStyle(c.style).appendTo(f);break;case"select":this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"1px solid #ccc","float":"left",margin:"2px 0"}).appendTo(f);for(opt in c.options)var g=new bkElement("option").setAttributes({value:opt,selected:opt}).setContent(c.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc","float":"left"}).setStyle(c.style).appendTo(f),this.inputs[itm].value=d}}}new bkElement("input").setAttributes({type:"submit"}).setStyle({backgroundColor:"#efefef",border:"1px solid #ccc",margin:"3px 0","float":"left",clear:"both"}).appendTo(this.form),this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(a,b,c){for(var d=this.ne.selectedInstance.getElm().getElementsByTagName(a),e=0;e<d.length;e++)if(d[e].getAttribute(b)==c)return $BK(d[e])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(a){this.ne=a,a.addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(a){this.timer=setTimeout(this.create.closure(this,a),400)},create:function(a){this.timer=null,this.pane||(this.pane=new nicEditorPane(a.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(a.options.name))},hide:function(a){this.timer&&clearTimeout(this.timer),this.pane&&(this.pane=this.pane.remove())}});nicEditors.registerPlugin(nicButtonTips);var nicSelectOptions={buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}},nicEditorSelect=bkClass.extend({construct:function(a,b,c,d){this.options=c.buttons[b],this.elm=a,this.ne=d,this.name=b,this.selOptions=new Array,this.margin=new bkElement("div").setStyle({"float":"left",margin:"2px 1px 0 1px"}).appendTo(this.elm),this.contain=new bkElement("div").setStyle({width:"90px",height:"20px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin),this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"1px solid #ccc",paddingLeft:"3px",backgroundColor:"#fff"}).appendTo(this.contain),this.control=new bkElement("div").setStyle({overflow:"hidden","float":"right",height:"18px",width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow",c)).appendTo(this.items),this.txt=new bkElement("div").setStyle({overflow:"hidden","float":"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items),window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent),this.margin.noSelect(),this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)),this.disable(),this.init()},disable:function(){this.isDisabled=!0,this.close(),this.contain.setStyle({opacity:.6})},enable:function(a){this.isDisabled=!1,this.close(),this.contain.setStyle({opacity:1})},setDisplay:function(a){this.txt.setContent(a)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"});for(var a=0;a<this.selOptions.length;a++){var b=this.selOptions[a],c=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",overflow:"hidden",cursor:"pointer"}),d=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(b[1]).appendTo(c).noSelect();d.addEvent("click",this.update.closure(this,b[0])).addEvent("mouseover",this.over.closure(this,d)).addEvent("mouseout",this.out.closure(this,d)).setAttributes("id",b[0]),this.pane.append(c),window.opera||(d.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(a){a.setStyle({backgroundColor:"#ccc"})},out:function(a){a.setStyle({backgroundColor:"#fff"})},add:function(a,b){this.selOptions.push(new Array(a,b))},update:function(a){this.ne.nicCommand(this.options.command,a),this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){this.setDisplay("Font&nbsp;Size...");for(itm in this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){this.setDisplay("Font&nbsp;Family...");for(itm in this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){this.setDisplay("Font&nbsp;Format...");for(itm in this.sel){var a=itm.toUpperCase();this.add("<"+a+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"</"+a+">")}}});nicEditors.registerPlugin(nicPlugin,nicSelectOptions);var nicLinkOptions={buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"]},unlink:{name:"Remove Link",command:"unlink",noActive:!0}}},nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A"),this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{_blank:"New Window","":"Current Window"},style:{width:"100px"}}},this.ln)},submit:function(a){var b=this.inputs.href.value;if("http://"==b||""==b)return alert("You must enter a URL to Create a Link"),!1;if(this.removePane(),!this.ln){var c="javascript:nicTemp();";this.ne.nicCommand("createlink",c),this.ln=this.findElm("A","href",c),this.ln.innerHTML==c&&(this.ln.innerHTML=this.inputs.title.value||b)}if(this.ln){var d=this.ln.title;this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value}),this.ln.innerHTML==d&&(this.ln.innerHTML=this.inputs.title.value||this.inputs.href.value)}}});nicEditors.registerPlugin(nicPlugin,nicLinkOptions);var nicColorOptions={buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0}}},nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var a={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},b=new bkElement("DIV").setStyle({width:"270px"});for(var c in a)for(var d in a)for(var e in a){var f="#"+a[c]+a[e]+a[d],g=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px","float":"left"}).appendTo(b),h=new bkElement("DIV").setStyle({border:"2px solid "+f}).appendTo(g),i=new bkElement("DIV").setStyle({backgroundColor:f,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,f)).addEvent("mouseover",this.on.closure(this,h)).addEvent("mouseout",this.off.closure(this,h,f)).appendTo(h);window.opera||(g.onmousedown=i.onmousedown=bkLib.cancelEvent)}this.pane.append(b.noSelect())},colorSelect:function(a){this.ne.nicCommand("foreColor",a),this.removePane()},on:function(a){a.setStyle({border:"2px solid #000"})},off:function(a,b){a.setStyle({border:"2px solid "+b})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(a){this.ne.nicCommand("hiliteColor",a),this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicColorOptions);var nicImageOptions={buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"]}}},nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.addForm({"":{type:"title",txt:"Add/Edit Image"},src:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}}},this.im)},submit:function(a){var b=this.inputs.src.value;if(""==b||"http://"==b)return alert("You must enter a Image URL to insert"),!1;if(this.removePane(),!this.im){var c="javascript:nicImTemp();";this.ne.nicCommand("insertImage",c),this.im=this.findElm("IMG","src",c)}this.im&&this.im.setAttributes({src:this.inputs.src.value,alt:this.inputs.alt.value,align:this.inputs.align.value})}});nicEditors.registerPlugin(nicPlugin,nicImageOptions);var nicSaveOptions={buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}},nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var a=this.ne.options.onSave,b=this.ne.selectedInstance;a(b.getContent(),b.elm.id,b)}});nicEditors.registerPlugin(nicPlugin,nicSaveOptions);var nicUploadOptions={buttons:{upload:{name:"Upload Image",type:"nicUploadButton"}}},nicUploadButton=nicEditorAdvancedButton.extend({nicURI:"http://files.nicedit.com/",addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.myID=Math.round(Math.random()*Math.pow(10,15)),this.requestInterval=1e3,this.uri=this.ne.options.uploadURI||this.nicURI,nicUploadButton.lastPlugin=this,this.myFrame=new bkElement("iframe").setAttributes({width:"100%",height:"100px",frameBorder:0,scrolling:"no"}).setStyle({border:0}).appendTo(this.pane.pane),this.progressWrapper=new bkElement("div").setStyle({display:"none",width:"100%",height:"20px",border:"1px solid #ccc"}).appendTo(this.pane.pane),this.progress=new bkElement("div").setStyle({width:"0%",height:"20px",backgroundColor:"#ccc"
}).setContent("&nbsp").appendTo(this.progressWrapper),setTimeout(this.addForm.closure(this),50)},addForm:function(){var a=this.myDoc=this.myFrame.contentWindow.document;a.open(),a.write("<html><body>"),a.write('<form method="post" action="'+this.uri+"?id="+this.myID+'" enctype="multipart/form-data">'),a.write('<input type="hidden" name="APC_UPLOAD_PROGRESS" value="'+this.myID+'" />'),this.uri==this.nicURI&&a.write('<div style="position: absolute; margin-left: 160px;"><img src="http://imageshack.us/img/imageshack.png" width="30" style="float: left;" /><div style="float: left; margin-left: 5px; font-size: 10px;">Hosted by<br /><a href="http://www.imageshack.us/" target="_blank">ImageShack</a></div></div>'),a.write('<div style="font-size: 14px; font-weight: bold; padding-top: 5px;">Insert an Image</div>'),a.write('<input name="nicImage" type="file" style="margin-top: 10px;" />'),a.write("</form>"),a.write("</body></html>"),a.close(),this.myBody=a.body,this.myForm=$BK(this.myBody.getElementsByTagName("form")[0]),this.myInput=$BK(this.myBody.getElementsByTagName("input")[1]).addEvent("change",this.startUpload.closure(this)),this.myStatus=new bkElement("div",this.myDoc).setStyle({textAlign:"center",fontSize:"14px"}).appendTo(this.myBody)},startUpload:function(){this.myForm.setStyle({display:"none"}),this.myStatus.setContent('<img src="http://files.nicedit.com/ajax-loader.gif" style="float: right; margin-right: 40px;" /><strong>Uploading...</strong><br />Please wait'),this.myForm.submit(),setTimeout(this.makeRequest.closure(this),this.requestInterval)},makeRequest:function(){if(this.pane&&this.pane.pane){nicUploadButton.lastPlugin=this;var a=new bkElement("script").setAttributes({type:"text/javascript",src:this.uri+"?check="+this.myID+"&rand="+Math.round(Math.random()*Math.pow(10,15))}).addEvent("load",function(){a.parentNode.removeChild(a)}).appendTo(document.getElementsByTagName("head")[0]);this.requestInterval&&setTimeout(this.makeRequest.closure(this),this.requestInterval)}},setProgress:function(a){this.progressWrapper.setStyle({display:"block"}),this.progress.setStyle({width:a+"%"})},update:function(a){if(0==a)this.progressWrapper.setStyle({display:"none"});else if(a.url){if(this.setProgress(100),this.requestInterval=!1,!this.im){this.ne.selectedInstance.restoreRng();var b="javascript:nicImTemp();";this.ne.nicCommand("insertImage",b),this.im=this.findElm("IMG","src",b)}var c=parseInt(this.ne.selectedInstance.elm.getStyle("width"));this.im&&this.im.setAttributes({src:a.url,width:c&&a.width?Math.min(c,a.width):""}),this.removePane()}else a.error?(this.requestInterval=!1,this.setProgress(100),alert("There was an error uploading your image ("+a.error+")."),this.removePane()):a.noprogress?(this.progressWrapper.setStyle({display:"none"}),(-1==this.uri.indexOf("http:")||-1!=this.uri.indexOf(window.location.host))&&(this.requestInterval=!1)):(this.setProgress(Math.round(a.current/a.total*75)),a.interval&&(this.requestInterval=a.interval))}});nicUploadButton.statusCb=function(a){nicUploadButton.lastPlugin.update(a)},nicEditors.registerPlugin(nicPlugin,nicUploadOptions);var nicXHTML=bkClass.extend({stripAttributes:["_moz_dirty","_moz_resizing","_extended"],noShort:["style","title","script","textarea","a"],cssReplace:{"font-weight:bold;":"strong","font-style:italic;":"em"},sizes:{1:"xx-small",2:"x-small",3:"small",4:"medium",5:"large",6:"x-large"},construct:function(a){this.ne=a,this.ne.options.xhtml&&a.addEvent("get",this.cleanup.closure(this))},cleanup:function(a){var b=a.getElm(),c=this.toXHTML(b);a.content=c},toXHTML:function(a,b,c){var d="",e="",f="",g=a.nodeType,h=a.nodeName.toLowerCase(),i=a.hasChildNodes&&a.hasChildNodes(),j=new Array;switch(g){case 1:var k=a.attributes;switch(h){case"b":h="strong";break;case"i":h="em";break;case"font":h="span"}if(b){for(var l=0;l<k.length;l++){var m=k[l],n=m.nodeName.toLowerCase(),o=m.nodeValue;if(m.specified&&o&&!bkLib.inArray(this.stripAttributes,n)&&"function"!=typeof o){switch(n){case"style":var p=o.replace(/ /g,"");for(itm in this.cssReplace)-1!=p.indexOf(itm)&&(j.push(this.cssReplace[itm]),p=p.replace(itm,""));f+=p,o="";break;case"class":o=o.replace("Apple-style-span","");break;case"size":f+="font-size:"+this.sizes[o]+";",o=""}o&&(e+=" "+n+'="'+o+'"')}}f&&(e+=' style="'+f+'"');for(var l=0;l<j.length;l++)d+="<"+j[l]+">";""==e&&"span"==h&&(b=!1),b&&(d+="<"+h,"br"!=h&&(d+=e))}if(i||bkLib.inArray(this.noShort,n)){b&&(d+=">");for(var l=0;l<a.childNodes.length;l++){var q=this.toXHTML(a.childNodes[l],!0,!0);q&&(d+=q)}}else b&&(d+=" />");b&&i&&(d+="</"+h+">");for(var l=0;l<j.length;l++)d+="</"+j[l]+">";break;case 3:d+=a.nodeValue}return d}});nicEditors.registerPlugin(nicXHTML);var nicBBCode=bkClass.extend({construct:function(a){if(this.ne=a,this.ne.options.bbCode){a.addEvent("get",this.bbGet.closure(this)),a.addEvent("set",this.bbSet.closure(this));var b=this.ne.loadedPlugins;for(itm in b)b[itm].toXHTML&&(this.xhtml=b[itm])}},bbGet:function(a){var b=this.xhtml.toXHTML(a.getElm());a.content=this.toBBCode(b)},bbSet:function(a){a.content=this.fromBBCode(a.content)},toBBCode:function(a){function b(b,c){a=a.replace(b,c)}return b(/\n/gi,""),b(/<strong>(.*?)<\/strong>/gi,"[b]$1[/b]"),b(/<em>(.*?)<\/em>/gi,"[i]$1[/i]"),b(/<span.*?style="text-decoration:underline;">(.*?)<\/span>/gi,"[u]$1[/u]"),b(/<ul>(.*?)<\/ul>/gi,"[list]$1[/list]"),b(/<li>(.*?)<\/li>/gi,"[*]$1[/*]"),b(/<ol>(.*?)<\/ol>/gi,"[list=1]$1[/list]"),b(/<img.*?src="(.*?)".*?>/gi,"[img]$1[/img]"),b(/<a.*?href="(.*?)".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"),b(/<br.*?>/gi,"\n"),b(/<.*?>.*?<\/.*?>/gi,""),a},fromBBCode:function(a){function b(b,c){a=a.replace(b,c)}return b(/\[b\](.*?)\[\/b\]/gi,"<strong>$1</strong>"),b(/\[i\](.*?)\[\/i\]/gi,"<em>$1</em>"),b(/\[u\](.*?)\[\/u\]/gi,'<span style="text-decoration:underline;">$1</span>'),b(/\[list\](.*?)\[\/list\]/gi,"<ul>$1</ul>"),b(/\[list=1\](.*?)\[\/list\]/gi,"<ol>$1</ol>"),b(/\[\*\](.*?)\[\/\*\]/gi,"<li>$1</li>"),b(/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'),b(/\[url=(.*?)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'),b(/\n/gi,"<br />"),a}});nicEditors.registerPlugin(nicBBCode),nicEditor=nicEditor.extend({floatingPanel:function(){this.floating=new bkElement("DIV").setStyle({position:"absolute",top:"-1000px"}).appendTo(document.body),this.addEvent("focus",this.reposition.closure(this)).addEvent("blur",this.hide.closure(this)),this.setPanel(this.floating)},reposition:function(){var a=this.selectedInstance.e;this.floating.setStyle({width:(parseInt(a.getStyle("width"))||a.clientWidth)+"px"});var b=a.offsetTop-this.floating.offsetHeight;0>b&&(b=a.offsetTop+a.offsetHeight),this.floating.setStyle({top:b+"px",left:a.offsetLeft+"px",display:"block"})},hide:function(){this.floating.setStyle({top:"-1000px"})}});var nicCodeOptions={buttons:{xhtml:{name:"Edit HTML",type:"nicCodeButton"}}},nicCodeButton=nicEditorAdvancedButton.extend({width:"350px",addPane:function(){this.addForm({"":{type:"title",txt:"Edit HTML"},code:{type:"content",value:this.ne.selectedInstance.getContent(),style:{width:"340px",height:"200px"}}})},submit:function(a){var b=this.inputs.code.value;this.ne.selectedInstance.setContent(b),this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicCodeOptions);;!function(a,b,c){function d(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=tinycolor(a[e]),g=f.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";g+=tinycolor.equals(b,a[e])?" sp-thumb-active":"";var h=q?"background-color:"+f.toRgbString():"filter:"+f.toFilter();d.push('<span title="'+f.toRgbString()+'" data-color="'+f.toRgbString()+'" class="'+g+'"><span class="sp-thumb-inner" style="'+h+';" /></span>')}return"<div class='sp-cf "+c+"'>"+d.join("")+"</div>"}function e(){for(var a=0;a<o.length;a++)o[a]&&o[a].hide()}function f(a,c){var d=b.extend({},n,a);return d.callbacks={move:k(d.move,c),change:k(d.change,c),show:k(d.show,c),hide:k(d.hide,c),beforeShow:k(d.beforeShow,c)},d}function g(g,i){function k(){qa.toggleClass("sp-flat",R),qa.toggleClass("sp-input-disabled",!Q.showInput),qa.toggleClass("sp-alpha-enabled",Q.showAlpha),qa.toggleClass("sp-buttons-disabled",!Q.showButtons||R),qa.toggleClass("sp-palette-disabled",!Q.showPalette),qa.toggleClass("sp-palette-only",Q.showPaletteOnly),qa.toggleClass("sp-initial-disabled",!Q.showInitial),qa.addClass(Q.className),L()}function n(){function c(a){return a.data&&a.data.ignore?(E(b(this).data("color")),H()):(E(b(this).data("color")),K(!0),H(),C()),!1}if(p&&qa.find("*:not(input)").attr("unselectable","on"),k(),Ea&&oa.hide().after(Fa),R?oa.after(qa).hide():b(na).append(qa.hide()),T&&a.localStorage){try{var d=a.localStorage[T].split(",#");d.length>1&&(delete a.localStorage[T],b.each(d,function(a,b){t(b)}))}catch(e){}try{ka=a.localStorage[T].split(";")}catch(e){}}Ga.bind("click.spectrum touchstart.spectrum",function(a){pa||A(),a.stopPropagation(),b(a.target).is("input")||a.preventDefault()}),(oa.is(":disabled")||Q.disabled===!0)&&P(),qa.click(j),ya.change(z),ya.bind("paste",function(){setTimeout(z,1)}),ya.keydown(function(a){13==a.keyCode&&z()}),Ba.text(Q.cancelText),Ba.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),C("cancel")}),Ca.text(Q.chooseText),Ca.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),G()&&(K(!0),C())}),l(wa,function(a,b,c){ha=a/ba,c.shiftKey&&(ha=Math.round(10*ha)/10),H()}),l(ta,function(a,b){ea=parseFloat(b/_),H()},x,y),l(ra,function(a,b){fa=parseFloat(a/Y),ga=parseFloat((Z-b)/Z),H()},x,y),Ia?(E(Ia),I(),La=Ka||tinycolor(Ia).format,t(Ia)):I(),R&&B();var f=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";za.delegate(".sp-thumb-el",f,c),Aa.delegate(".sp-thumb-el:nth-child(1)",f,{ignore:!0},c)}function t(c){if(S){var d=tinycolor(c).toRgbString();if(-1===b.inArray(d,ka)&&ka.push(d),T&&a.localStorage)try{a.localStorage[T]=ka.join(";")}catch(e){}}}function u(){var a,b=[],c=ka,d={};if(Q.showPalette){for(var e=0;e<ja.length;e++)for(var f=0;f<ja[e].length;f++)a=tinycolor(ja[e][f]).toRgbString(),d[a]=!0;for(e=0;e<c.length;e++)a=tinycolor(c[e]).toRgbString(),d.hasOwnProperty(a)||(b.push(c[e]),d[a]=!0)}return b.reverse().slice(0,Q.maxSelectionSize)}function v(){var a=F(),c=b.map(ja,function(b,c){return d(b,a,"sp-palette-row sp-palette-row-"+c)});ka&&c.push(d(u(),a,"sp-palette-row sp-palette-row-selection")),za.html(c.join(""))}function w(){if(Q.showInitial){var a=Ja,b=F();Aa.html(d([a,b],b,"sp-palette-row-initial"))}}function x(){(0===Z||0===Y||0===_)&&L(),qa.addClass(la)}function y(){qa.removeClass(la)}function z(){var a=tinycolor(ya.val());a.ok?E(a):ya.addClass("sp-validation-error")}function A(){X?C():B()}function B(){return X?void L():void(V.beforeShow(F())!==!1&&(e(),X=!0,b(ma).bind("click.spectrum",C),b(a).bind("resize.spectrum",W),Fa.addClass("sp-active"),qa.show(),Q.showPalette&&v(),L(),I(),Ja=F(),w(),V.show(Ja)))}function C(c){if((!c||"click"!=c.type||2!=c.button)&&X&&!R){X=!1,b(ma).unbind("click.spectrum",C),b(a).unbind("resize.spectrum",W),Fa.removeClass("sp-active"),qa.hide();var d=!tinycolor.equals(F(),Ja);d&&(Ma&&"cancel"!==c?K(!0):D()),V.hide(F())}}function D(){E(Ja,!0)}function E(a,b){if(!tinycolor.equals(a,F())){var c=tinycolor(a),d=c.toHsv();ea=d.h,fa=d.s,ga=d.v,ha=d.a,I(),b||(La=Ka||c.format)}}function F(){return tinycolor.fromRatio({h:ea,s:fa,v:ga,a:Math.round(100*ha)/100})}function G(){return!ya.hasClass("sp-validation-error")}function H(){I(),V.move(F())}function I(){ya.removeClass("sp-validation-error"),J();var a=tinycolor({h:ea,s:"1.0",v:"1.0"});ra.css("background-color",a.toHexString());var b=La;1>ha&&("hex"===b||"name"===b)&&(b="rgb");var c=F(),d=c.toHexString(),e=c.toRgbString();if(q||1===c.alpha?Ha.css("background-color",e):(Ha.css("background-color","transparent"),Ha.css("filter",c.toFilter())),Q.showAlpha){var f=c.toRgb();f.a=0;var g=tinycolor(f).toRgbString(),h="linear-gradient(left, "+g+", "+d+")";p?va.css("filter",tinycolor(g).toFilter({gradientType:1},d)):(va.css("background","-webkit-"+h),va.css("background","-moz-"+h),va.css("background","-ms-"+h),va.css("background",h))}Q.showInput&&(1>ha&&("hex"===b||"name"===b)&&(b="rgb"),ya.val(c.toString(b))),Q.showPalette&&v(),w()}function J(){var a=fa,b=ga,c=a*Y,d=Z-b*Z;c=Math.max(-$,Math.min(Y-$,c-$)),d=Math.max(-$,Math.min(Z-$,d-$)),sa.css({top:d,left:c});var e=ha*ba;xa.css({left:e-ca/2});var f=ea*_;ua.css({top:f-da})}function K(a){var b=F();Da&&oa.val(b.toString(La)).change();var c=!tinycolor.equals(b,Ja);Ja=b,t(b),a&&c&&V.change(b)}function L(){Y=ra.width(),Z=ra.height(),$=sa.height(),aa=ta.width(),_=ta.height(),da=ua.height(),ba=wa.width(),ca=xa.width(),R||qa.offset(h(qa,Ga)),J()}function M(){oa.show(),Ga.unbind("click.spectrum touchstart.spectrum"),qa.remove(),Fa.remove(),o[Na.id]=null}function N(a,d){return a===c?b.extend({},Q):d===c?Q[a]:(Q[a]=d,void k())}function O(){pa=!1,oa.attr("disabled",!1),Ga.removeClass("sp-disabled")}function P(){C(),pa=!0,oa.attr("disabled",!0),Ga.addClass("sp-disabled")}var Q=f(i,g),R=Q.flat,S=Q.showSelectionPalette,T=Q.localStorageKey,U=Q.theme,V=Q.callbacks,W=m(L,10),X=!1,Y=0,Z=0,$=0,_=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=1,ia=Q.palette.slice(0),ja=b.isArray(ia[0])?ia:[ia],ka=Q.selectionPalette.slice(0),la="sp-dragging",ma=g.ownerDocument,na=ma.body,oa=b(g),pa=!1,qa=b(s,ma).addClass(U),ra=qa.find(".sp-color"),sa=qa.find(".sp-dragger"),ta=qa.find(".sp-hue"),ua=qa.find(".sp-slider"),va=qa.find(".sp-alpha-inner"),wa=qa.find(".sp-alpha"),xa=qa.find(".sp-alpha-handle"),ya=qa.find(".sp-input"),za=qa.find(".sp-palette"),Aa=qa.find(".sp-initial"),Ba=qa.find(".sp-cancel"),Ca=qa.find(".sp-choose"),Da=oa.is("input"),Ea=Da&&!R,Fa=Ea?b(r).addClass(U):b([]),Ga=Ea?Fa:oa,Ha=Fa.find(".sp-preview-inner"),Ia=Q.color||Da&&oa.val(),Ja=!1,Ka=Q.preferredFormat,La=Ka,Ma=!Q.showButtons||Q.clickoutFiresChange;n();var Na={show:B,hide:C,toggle:A,reflow:L,option:N,enable:O,disable:P,set:function(a){E(a),K()},get:F,destroy:M,container:qa};return Na.id=o.push(Na)-1,Na}function h(a,c){var d=0,e=a.outerWidth(),f=a.outerHeight(),g=c.outerHeight(),h=a[0].ownerDocument,i=h.documentElement,j=i.clientWidth+b(h).scrollLeft(),k=i.clientHeight+b(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function i(){}function j(a){a.stopPropagation()}function k(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function l(c,d,e,f){function g(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function h(a){if(l){if(p&&document.documentMode<9&&!a.button)return j();var b=a.originalEvent.touches,e=b?b[0].pageX:a.pageX,f=b?b[0].pageY:a.pageY,h=Math.max(0,Math.min(e-m.left,o)),i=Math.max(0,Math.min(f-m.top,n));q&&g(a),d.apply(c,[h,i,a])}}function i(a){var d=a.which?3==a.which:2==a.button;a.originalEvent.touches;d||l||e.apply(c,arguments)!==!1&&(l=!0,n=b(c).height(),o=b(c).width(),m=b(c).offset(),b(k).bind(r),b(k.body).addClass("sp-dragging"),q||h(a),g(a))}function j(){l&&(b(k).unbind(r),b(k.body).removeClass("sp-dragging"),f.apply(c,arguments)),l=!1}d=d||function(){},e=e||function(){},f=f||function(){};var k=c.ownerDocument||document,l=!1,m={},n=0,o=0,q="ontouchstart"in a,r={};r.selectstart=g,r.dragstart=g,r[q?"touchmove":"mousemove"]=h,r[q?"touchend":"mouseup"]=j,b(c).bind(q?"touchstart":"mousedown",i)}function m(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),(c||!d)&&(d=setTimeout(g,b))}}var n={beforeShow:i,move:i,change:i,show:i,hide:i,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},o=[],p=!!/msie/i.exec(a.navigator.userAgent),q=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),s=function(){var a="";if(p)for(var b=1;6>=b;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";b.fn.spectrum=function(a,c){if("string"==typeof a){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=o[b(this).data(t)];if(c){var f=c[a];if(!f)throw new Error("Spectrum: no such method: '"+a+"'");"get"==a?d=c.get():"container"==a?d=c.container:"option"==a?d=c.option.apply(c,e):"destroy"==a?(c.destroy(),b(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=g(this,a);b(this).data(t,c.id)})},b.fn.spectrum.load=!0,b.fn.spectrum.loadOpts={},b.fn.spectrum.draggable=l,b.fn.spectrum.defaults=n,b.spectrum={},b.spectrum.localization={},b.spectrum.palettes={},b.fn.spectrum.processNativeColorInputs=function(){var a=b("<input type='color' value='!' />")[0],c="color"===a.type&&"!"!=a.value;c||b("input[type=color]").spectrum({preferredFormat:"hex6"})},function(a){function b(a,d){if("object"==typeof a&&a.hasOwnProperty("_tc_id"))return a;var f=c(a),h=f.r,j=f.g,k=f.b,l=z(f.a),m=f.format;return{ok:f.ok,format:m,_tc_id:t++,alpha:l,toHsv:function(){var a=g(h,j,k);return{h:a.h,s:a.s,v:a.v,a:l}},toHsvString:function(){var a=g(h,j,k),b=v(360*a.h),c=v(100*a.s),d=v(100*a.v);return 1==l?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+l+")"},toHsl:function(){var a=e(h,j,k);return{h:a.h,s:a.s,l:a.l,a:l}},toHslString:function(){var a=e(h,j,k),b=v(360*a.h),c=v(100*a.s),d=v(100*a.l);return 1==l?"hsl("+b+", "+c+"%, "+d+"%)":"hsla("+b+", "+c+"%, "+d+"%, "+l+")"},toHex:function(){return i(h,j,k)},toHexString:function(a){return"#"+i(h,j,k,a)},toRgb:function(){return{r:v(h),g:v(j),b:v(k),a:l}},toRgbString:function(){return 1==l?"rgb("+v(h)+", "+v(j)+", "+v(k)+")":"rgba("+v(h)+", "+v(j)+", "+v(k)+", "+l+")"},toName:function(){return B[i(h,j,k)]||!1},toFilter:function(a,c){var d=i(h,j,k,!0),e=d,f=Math.round(255*z(l)).toString(16),g=f,m=a&&a.gradientType?"GradientType = 1, ":"";if(c){var n=b(c);e=n.toHex(),g=Math.round(255*z(n.alpha)).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+m+"startColorstr=#"+p(f)+d+",endColorstr=#"+p(g)+e+")"},toString:function(a){a=a||this.format;var b=!1;return"rgb"===a&&(b=this.toRgbString()),"hex"===a&&(b=this.toHexString()),"hex6"===a&&(b=this.toHexString(!0)),"name"===a&&(b=this.toName()),"hsl"===a&&(b=this.toHslString()),"hsv"===a&&(b=this.toHsvString()),b||this.toHexString(!0)}}}function c(a){var b={r:0,g:0,b:0},c=1,e=!1,g=!1;return"string"==typeof a&&(a=q(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(b=d(a.r,a.g,a.b),e=!0,g="rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(b=h(a.h,a.s,a.v),e=!0,g="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(b=f(a.h,a.s,a.l),e=!0,g="hsl"),a.hasOwnProperty("a")&&(c=a.a)),b.r=w(255,x(b.r,0)),b.g=w(255,x(b.g,0)),b.b=w(255,x(b.b,0)),b.r<1&&(b.r=v(b.r)),b.g<1&&(b.g=v(b.g)),b.b<1&&(b.b=v(b.b)),{ok:e,format:a&&a.format||g,r:b.r,g:b.g,b:b.b,a:c}}function d(a,b,c){return{r:255*k(a,255),g:255*k(b,255),b:255*k(c,255)}}function e(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=x(a,b,c),g=w(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function f(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=k(a,360),b=k(b,100),c=k(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function g(a,b,c){a=k(a,255),b=k(b,255),c=k(c,255);var d,e,f=x(a,b,c),g=w(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function h(a,b,c){a=6*k(a,360),b=k(b,100),c=k(c,100);var d=u.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],l=[h,c,c,g,f,f][i],m=[f,f,h,c,c,g][i];return{r:255*j,g:255*l,b:255*m}}function i(a,b,c,d){var e=[p(v(a).toString(16)),p(v(b).toString(16)),p(v(c).toString(16))];return d||e[0].charAt(0)!=e[0].charAt(1)||e[1].charAt(0)!=e[1].charAt(1)||e[2].charAt(0)!=e[2].charAt(1)?e.join(""):e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0)}function j(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function k(a,b){n(a)&&(a="100%");var c=o(a);return a=w(b,x(0,z(a))),c&&(a*=b/100),u.abs(a-b)<1e-6?1:a>=1?a%b/z(b):a}function l(a){return w(1,x(0,a))}function m(a){return parseInt(a,16)}function n(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===z(a)}function o(a){return"string"==typeof a&&-1!=a.indexOf("%")}function p(a){return 1==a.length?"0"+a:""+a}function q(a){a=a.replace(r,"").replace(s,"").toLowerCase();var b=!1;if(A[a])a=A[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0};var c;return(c=C.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=C.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=C.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=C.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=C.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=C.hex6.exec(a))?{r:m(c[1]),g:m(c[2]),b:m(c[3]),format:b?"name":"hex"}:(c=C.hex3.exec(a))?{r:m(c[1]+""+c[1]),g:m(c[2]+""+c[2]),b:m(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var r=/^[\s,#]+/,s=/\s+$/,t=0,u=Math,v=u.round,w=u.min,x=u.max,y=u.random,z=a.parseFloat;b.fromRatio=function(a){if("object"==typeof a)for(var c in a)1===a[c]&&(a[c]="1.0");return b(a)},b.equals=function(a,c){return a&&c?b(a).toRgbString()==b(c).toRgbString():!1},b.random=function(){return b.fromRatio({r:y(),g:y(),b:y()})},b.desaturate=function(a,c){var d=b(a).toHsl();return d.s-=(c||10)/100,d.s=l(d.s),b(d)},b.saturate=function(a,c){var d=b(a).toHsl();return d.s+=(c||10)/100,d.s=l(d.s),b(d)},b.greyscale=function(a){return b.desaturate(a,100)},b.lighten=function(a,c){var d=b(a).toHsl();return d.l+=(c||10)/100,d.l=l(d.l),b(d)},b.darken=function(a,c){var d=b(a).toHsl();return d.l-=(c||10)/100,d.l=l(d.l),b(d)},b.complement=function(a){var c=b(a).toHsl();return c.h=(c.h+.5)%1,b(c)},b.triad=function(a){var c=b(a).toHsl(),d=360*c.h;return[b(a),b({h:(d+120)%360,s:c.s,l:c.l}),b({h:(d+240)%360,s:c.s,l:c.l})]},b.tetrad=function(a){var c=b(a).toHsl(),d=360*c.h;return[b(a),b({h:(d+90)%360,s:c.s,l:c.l}),b({h:(d+180)%360,s:c.s,l:c.l}),b({h:(d+270)%360,s:c.s,l:c.l})]},b.splitcomplement=function(a){var c=b(a).toHsl(),d=360*c.h;return[b(a),b({h:(d+72)%360,s:c.s,l:c.l}),b({h:(d+216)%360,s:c.s,l:c.l})]},b.analogous=function(a,c,d){c=c||6,d=d||30;var e=b(a).toHsl(),f=360/d,g=[b(a)];for(e.h*=360,e.h=(e.h-(f*c>>1)+720)%360;--c;)e.h=(e.h+f)%360,g.push(b(e));return g},b.monochromatic=function(a,c){c=c||6;for(var d=b(a).toHsv(),e=d.h,f=d.s,g=d.v,h=[],i=1/c;c--;)h.push(b({h:e,s:f,v:g})),g=(g+i)%1;return h},b.readable=function(a,c){var d=b(a).toRgb(),e=b(c).toRgb();return(e.r-d.r)*(e.r-d.r)+(e.g-d.g)*(e.g-d.g)+(e.b-d.b)*(e.b-d.b)>10404};var A=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},B=b.hexNames=j(A),C=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();a.tinycolor=b}(this),b(function(){b.fn.spectrum.load&&b.fn.spectrum.processNativeColorInputs()})}(window,jQuery);;define("storymaps/ui/loadingIndicator/LoadingIndicator",["dojo/dom"],function(e){return function(n,r){var i=null,s=0,o=e.byId(n),u=e.byId(r);this.init=function(){if(this.spinner!=null)return;var e={lines:16,length:7,width:7,radius:30,rotate:0,color:"#000",speed:1.1,trail:25,shadow:!0,hwaccel:!0,className:"spinner",top:4,left:6};i=(new Spinner(e)).spin(o)},this.start=function(){!i&&this.init(),this.itemCount||(o.style.visibility="visible"),s=1},this.stop=function(){s--,s<=0&&(o.style.visibility="hidden",s=0),u&&(u.style.visibility="hidden")},this.setMessage=function(e,t){u&&(t&&(u.style.marginTop="-20px"),u.innerHTML=e,u.style.visibility="visible",u.style.display="block")},this.forceHide=function(){o.style.display="none",u&&(u.style.display="none")}}}),define("storymaps/utils/Helper",["dojo/cookie","dojo/has","esri/arcgis/utils","esri/urlUtils","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/geometry/Extent","esri/geometry/Polygon","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/OpenStreetMapLayer"],function(e,t,n,r,i,s,o,u,a,f,l){return{isMobile:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/IEMobile/i)},browserSupportHistory:function(){return!!window.history&&!!history.pushState},getUrlParams:function(){var e=r.urlToObject(document.location.search).query;return e?e:!this.browserSupportHistory()&&!e?r.urlToObject(document.location.hash).query||{}:{}},getWebmapsIDs:function(e){var t=r.urlToObject(document.location.search).query||{},n=t.webmaps;return n&&n.indexOf(",")!=-1?(configOptions.layerIndex=0,n.split(",")):t.webmap&&t.webmap.indexOf(",")!=-1?(configOptions.layerIndex=0,t.webmap.split(",")):t.webmaps?(configOptions.layerIndex=0,[t.webmaps]):t.webmap?(configOptions.layerIndex=0,[t.webmap]):configOptions&&configOptions.webmaps&&configOptions.webmaps.length&&configOptions.webmaps[0]?configOptions.webmaps:""},getAppID:function(e){var t=r.urlToObject(document.location.search).query||{};if(configOptions&&configOptions.appid)return configOptions.appid;if(this.isArcGISHosted()||!e)return t.appid;if(configOptions.authorizedOwners&&configOptions.authorizedOwners.length>0&&configOptions.authorizedOwners[0])return t.appid},getSharingHost:function(){var e=r.urlToObject(document.location.search).query||{};return e.sharinghost?"//"+e.sharinghost:""},isArcGISHosted:function(){return/(\/apps\/|\/home\/)(StorytellingSwipe\/)/.test(document.location.pathname)},getBlankAppJSON:function(){return{itemType:"text",guid:null,name:null,type:"Web Mapping Application",typeKeywords:["JavaScript","Map","Mapping Site","Online Map","Ready To Use","selfConfigured","Web Map","Story Maps","SwipeSpyglass"],description:null,tags:["Story Map","Swipe","Spyglass"],snippet:null,thumbnail:"thumbnail/ago_downloaded.png",documentation:null,extent:[],lastModified:-1,spatialReference:null,accessInformation:null,licenseInfo:null,culture:"en-us",properties:null,size:116,appCategories:[],industries:[],languages:[],largeThumbnail:null,banner:null,screenshots:[],listed:!1,ownerFolder:null,commentsEnabled:!0,numComments:0,numRatings:0,avgRating:0,numViews:1}},getGraphicsLayerByName:function(e,t){var n;for(var r=0;r<e.graphicsLayerIds.length;r++){n=e.getLayer(e.graphicsLayerIds[r]);if(n.name==t)return n}return null},getWebMapExtentFromItem:function(e){if(!e.extent||e.extent.length!=2)return null;var t=i.geographicToWebMercator(new s(e.extent[0][0],e.extent[0][1])),n=i.geographicToWebMercator(new s(e.extent[1][0],e.extent[1][1]));return new o({xmax:n.x,xmin:t.x,ymax:n.y,ymin:t.y,spatialReference:{wkid:102100}})},serializeExtentToItem:function(e){if(!e||!e.spatialReference)return null;var t=e.spatialReference.wkid==4326?e:i.webMercatorToGeographic(e);return[[Math.round(t.xmin*1e4)/1e4,Math.round(t.ymin*1e4)/1e4],[Math.round(t.xmax*1e4)/1e4,Math.round(t.ymax*1e4)/1e4]]},serializedExtentEquals:function(e,t){return e&&t&&e.length==t.length&&e.length==2&&e[0][0]==t[0][0]&&e[0][1]==t[0][1]&&e[1][0]==t[1][0]&&e[1][1]==t[1][1]},cloneLayer:function(e){return e.url&&e.url.match(/virtualearth\./)?new f("http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"):e instanceof f?new f(e.url):e instanceof a?new a(e.url):e.id=="OpenStreetMap"?new l:new f("http://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer")},extentToPolygon:function(e){var t=new u(e.spatialReference);return t.addRing([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]),t},getFirstLevelWhereExtentFit:function(e,t){var n=t.width,r=t.height,i=t._params.lods;for(var s=i.length-1;s>=0;s--)if(n*t._params.lods[s].resolution>e.getWidth()&&r*t._params.lods[s].resolution>e.getHeight())return s;return-1},getPortalUser:function(){var t=e("esri_auth");if(!t)return;t=JSON.parse(t.replace('"ssl":undefined','"ssl":""'));if(t.urlKey&&t.customBaseUrl&&(t.urlKey+"."+t.customBaseUrl).toLowerCase()!=document.location.hostname.toLowerCase())return;return t?t.email:null},getPortalRole:function(){var t=e("esri_auth");if(!t)return;t=JSON.parse(t.replace('"ssl":undefined','"ssl":""'));if(t.urlKey&&t.customBaseUrl&&(t.urlKey+"."+t.customBaseUrl).toLowerCase()!=document.location.hostname.toLowerCase())return;return t?t.role:null},getMyStoriesURL:function(){return app.isPortal?n.arcgisUrl.split("/sharing/")[0]+"/apps/MyStories/":"//storymaps.arcgis.com/en/my-stories/"},getWebmapViewerLinkFromSharingURL:function(e){var t=e.split("/sharing/")[0];return t+"/home/webmap/viewer.html"},getItemURL:function(e,t){var n=e.split("/sharing/")[0];return n+"/home/item.html?id="+t},getMyContentURL:function(e){return e.split("/sharing/")[0]+"/home/content.html"},browserSupportAttachementUsingFileReader:function(){return!!window.FileReader&&!!window.FormData&&!!this.browserSupportCanvas()&&!!window.Blob},browserSupportCanvas:function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},browserSupportFileReaderBinaryString:function(){if(!window.FileReader)return!1;var e=new window.FileReader;return"readAsArrayBuffer"in e},getBinaryStringFromArrayBuffer:function(e){var t=new Uint8Array(e),n="";for(var r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n},addCSSRule:function(e){if(t("ie")<=8)return;$("<style>").prop("type","text/css").html(e).appendTo("head")},hex2rgba:function(e,t){var n=e.replace("#","").match(/../g),r=[],i;for(i in n)r.push(parseInt(n[i],16));return r.push(t),"rgba("+r.join()+")"},prependURLHTTP:function(e){return!e||e==""||e.match(/^mailto:/)?e:/^(https?:\/\/)|^(\/\/)/i.test(e)?e:"http://"+e}}}),define("storymaps/swipe/core/Config",[],function(){return{checkConfigFileIsOK:function(){return APPCFG&&APPCFG.COLORS&&APPCFG.COLORS.length==2&&APPCFG.COLOR_SCHEMES&&APPCFG.DEFAULT_SHARING_URL&&APPCFG.DEFAULT_PROXY_URL&&APPCFG.TIMEOUT_VIEWER_LOAD&&APPCFG.TIMEOUT_VIEWER_REQUEST&&APPCFG.TIMEOUT_BUILDER_REQUEST&&APPCFG.EMBED!==undefined&&APPCFG.HEADER_LOGO_URL!=undefined&&APPCFG.HEADER_LOGO_TARGET!=undefined&&APPCFG.HEADER_LINK_TEXT!=undefined&&APPCFG.HEADER_LINK_URL!=undefined&&APPCFG.HEADER_SOCIAL&&APPCFG.CORS_SERVER&&APPCFG.BING_MAPS_KEY!==undefined&&APPCFG.HELPER_SERVICES!==undefined&&APPCFG.HELPER_SERVICES.geometry!==undefined&&APPCFG.HELPER_SERVICES.geocode!==undefined}}}),define("storymaps/swipe/core/WebApplicationData",["dojo/_base/lang","esri/geometry/Extent"],function(e,t){var n={},r={values:{}},i,s=!1;return{set:function(i){n=e.clone(i);if(!i||!i.values)return;r=i,r.values.bookmarks&&$.each(r.values.bookmarks,function(e,n){n.extent=new t(n.extent)})},get:function(){app.sidePanel.checkDescription(!0);var t=e.clone(r);return t.values.template||(t.values.template="Swipe"),t.values.templateCreation||(t.values.templateCreation=version),t.values.templateLastEdit=version,t},getBlank:function(){return{values:{webmap:r.values.webmap}}},restoreOriginalData:function(){this.set(n)},updateAfterSave:function(){n=e.clone(r)},getDoNotWarnTitle:function(){return r.values.doNotWarnTitle||!1},setDoNotWarnTitle:function(e){r.values.doNotWarnTitle=e},getWebmap:function(e){return r.values.webmap?r.values.webmap:e==0?null:configOptions.webmap},setWebmap:function(e){r.values.webmap=e},getWebmaps:function(e){return r.values.webmaps?r.values.webmaps:r.values.webmap?[r.values.webmap]:e==0?null:configOptions.webmaps},setWebmaps:function(e){r.values.webmaps=e},getLayers:function(){if(r.values.layers)return r.values.layers;if(!app.maps[0]&&!app.map)return null;var e=app.mode=="TWO_LAYERS"?app.map:app.maps[0];i||(i=e.layerIds||[]),s||(i=i.concat(e.graphicsLayerIds),s=!0);var t=i[i.length-1-configOptions.layerIndex];return t?[t]:e.layerIds[0]?[e.layerIds[e.layerIds.length-1]]:null},setLayers:function(e){r.values.layers=e},getLabels:function(e){if(r.values.labels)return r.values.labels},setLabels:function(e){r.values.labels=e},getDataModel:function(){return r.values.dataModel},setDataModel:function(e){r.values.dataModel=e},getPopupTitles:function(){return r.values.popupTitles||configOptions.popupTitles},setPopupTitles:function(e){r.values.popupTitles=e},getPopupColors:function(){return r.values.popupColors||configOptions.popupColors},setPopupColors:function(e){r.values.popupColors=e},getTitle:function(){return r.values.title||configOptions.title},setTitle:function(e){r.values.title=e},getSubtitle:function(){return r.values.subtitle||configOptions.subtitle},setSubtitle:function(e){r.values.subtitle=e},setColors:function(e,t){r.values.colors=e+";"+t},getColors:function(){return r.values.colors?r.values.colors.split(";"):APPCFG.COLORS},setLogoURL:function(e){r.values.logoURL=e},getLogoURL:function(){return r.values.logoURL},setLogoTarget:function(e){r.values.logoTarget=e},getLogoTarget:function(){return r.values.logoTarget},getLayout:function(){return r.values.layout||configOptions.layout},setLayout:function(e){r.values.layout=e},getLegend:function(){return r.values.legend!=null?r.values.legend:configOptions.legend},setLegend:function(e){r.values.legend=e},getPopup:function(){return r.values.popup!=null?r.values.popup:configOptions.popup},setPopup:function(e){r.values.popup=e},getLocationSearch:function(){return r.values.locationSearch!=null?r.values.locationSearch:configOptions.locationSearch},setLocationSearch:function(e){r.values.locationSearch=e},getGeolocator:function(){return r.values.geolocator!=null?r.values.geolocator:configOptions.geolocator},setGeolocator:function(e){r.values.geolocator=e},getDescription:function(){return r.values.description!=null?r.values.description:configOptions.description},setDescription:function(e){r.values.description=e},getBookmarks:function(){return r.values.bookmarks||configOptions.bookmarks},setBookmarks:function(e){r.values.bookmarks=e},getHeaderLinkText:function(){return r.values.headerLinkText},getHeaderLinkURL:function(){return r.values.headerLinkURL},setHeaderLink:function(e,t){r.values.headerLinkText=e,r.values.headerLinkURL=t},getSidePanelDescription:function(e){return app.isInBuilderMode||e?r.values.sidePanelDescription:r.values.sidePanelDescription||configOptions.sidePanelDescription},setSidePanelDescription:function(e){r.values.sidePanelDescription=e},getSeries:function(){return r.values.series||configOptions.series},setSeries:function(e){r.values.series=e},getSeriesBookmarks:function(){return configOptions.bookmarks&&configOptions.bookmarks.length?($.each(configOptions.bookmarks,function(e,n){n.extent=new t(n.extent)}),configOptions.bookmarks):r.values.bookmarks||[]},setSeriesBookmarks:function(e){e&&e.length&&(r.values.bookmarks=e)},getSocial:function(){return r.values.social},setSocial:function(e){r.values.social=e}}}),define("storymaps/swipe/core/Data",["storymaps/swipe/core/WebApplicationData","storymaps/utils/Helper","esri/layers/FeatureLayer"],function(e,t,n){return function(){var i=this,s=null,o=null,u=null,a=null,f=null;this.getSourceLayer=function(){return f},this.getWebMapItem=function(){return s},this.setWebMapItem=function(e){s=e},this.getAppProxies=function(){return a},this.setAppProxies=function(e){a=e},this.getWebMapItem2=function(){return o},this.setWebMapItem2=function(e){o=e},this.getAppItem=function(){return u||{}},this.setAppItem=function(e){u=e},this.sourceIsFS=function(){return f instanceof n&&f.url!=null},this.getFSSourceLayerItemId=function(){var e=null;return this.sourceIsFS()?($.each(s.itemData.operationalLayers,function(t,n){n.id==f.id&&(e=n.itemId)}),e):e},this.discardChanges=function(){},this.updateAfterSave=function(){e.updateAfterSave()},this.getWebAppData=function(){return e.get()},this.userIsAppOwner=function(){var e=app.portal?app.portal.getPortalUser():null;return e&&e.username==this.getAppItem().owner||t.getPortalUser()!=null&&t.getPortalUser()==this.getAppItem().owner||e&&e.privileges&&$.inArray("portal:admin:updateItems",e.privileges)>-1||this.getAppItem().itemControl=="admin"||this.getAppItem().itemControl=="update"},this.checkUserItemPrivileges=function(){var e=app.portal?app.portal.getPortalUser():null;return e&&!e.orgId&&!e.privileges||e&&e.privileges&&$.inArray("portal:user:createItem",e.privileges)>-1},this.isOrga=function(){return!app.portal||!app.portal.getPortalUser()?!1:!!app.portal.getPortalUser().orgId}}}),define("storymaps/swipe/core/SwipeHelper",[],function(){return{isOnMobileView:function(){return $("#headerMobile").css("display")=="block"}}}),define("storymaps/ui/inlineFieldEdit/InlineFieldEdit",["dojo/has"],function(e){return function(n,r,i){function o(e,t,n){if(!e||!t||!n)return;typeof r=="function"&&r(),s=n,t.parent().parent().addClass("isEditing"),t.hide(),e.hide(),n.val(t.html()),n.show(),n.select()}function u(t){if(!t||!t.get(0))return;s=null;var n=t.get(0).value,r=t.parent().find(".text_edit_label"),o=t.parent().find(".text_edit_icon"),u=r.parent().first();n===""&&(n=i18n.builder.header.editMe),n=n.replace(/<\/?script>/g,""),r.parent().parent().removeClass("isEditing"),r.html(n),r.show(),t.hide(),o.css("display","inline-block"),e("ios")&&document.activeElement.blur(),typeof i=="function"&&i(u,n)}var s=null;$(n+" .text_edit_icon").click(function(){o($(this),$(this).parent().find(".text_edit_label"),$(this).parent().find(".text_edit_input"))}),$(n+" .text_edit_label").click(function(){o($(this).parent().find(".text_edit_icon"),$(this),$(this).parent().find(".text_edit_input"))}),$(n+" .text_edit_input").blur(function(){u($(this))}),e("ios")&&$("body").bind("touchstart",function(e){s&&e.target!=s.get(0)&&u(s)}),$(n+" .text_edit_input").keypress(function(e){var t=e.keyCode?e.keyCode:e.which;t=="13"&&u($(this))})}}),define("storymaps/ui/header/Header",["storymaps/ui/inlineFieldEdit/InlineFieldEdit","storymaps/swipe/core/WebApplicationData","dojo/has","dojo/topic","esri/urlUtils"],function(e,t,n,r,i){return function(o,u){function f(){var e=p(document.location.href);if($(this).hasClass("disabled"))return;window.open("http://www.facebook.com/sharer/sharer.php?u="+e,"","toolbar=0,status=0,width=626,height=436")}function l(){var e="text="+encodeURIComponent($(o+" #headerMobile .title").text())+"&url="+p(document.location.href)+"&related=EsriStoryMaps"+"&hashtags=storymap";if($(this).hasClass("disabled"))return;window.open("https://twitter.com/intent/tweet?"+e,"Tweet","toolbar=0,status=0,width=626,height=436")}function c(){if($(this).hasClass("disabled"))return;var e=t.getSeries();$(o).find(".share_bitly").popover({trigger:"manual",placement:"left",html:!0,content:'<div style="width:140px; height:'+(e?"40px":"30px")+'">'+' <div id="bitlyLoad" style="position:absolute; top: 16px; left: 24px; width:130px; text-align:center;">'+'  <img src="resources/icons/loader-upload.gif" alt="Loading" />'+" </div>"+' <input id="bitlyInput" type="text" value="" style="display:none; width: 130px; margin-bottom: 0px;"/>'+"</div>"+(e?' <div class="autoplay-container" style="font-size: 0.8em; margin-top: 2px; margin-bottom: -1px; position: absolute; top: 38px; width: 100%; left: 0px; text-align: center;">   <input type="checkbox" class="autoplay-checkbox" value="autoplay" style="width: 10px; vertical-align: -2px;" /> '+i18n.viewer.desktopView.autoplayLabel+'  <a class="autoplay-help"><img src="resources/icons/builder-help.png" style="vertical-align: -5px;"/></a>'+" </div>":"")+"<script>"+' $(document).on("click touchstart", function(src) { if( ! src || ! src.target || ! $(src.target).parents(".popover").length ){ $(".share_bitly").popover("hide"); $(document).off("click"); } });'+"</script>"}).popover("toggle"),$(o).find(".autoplay-help").popover({content:"<div style='width: 150px'>"+i18n.viewer.desktopView.autoplayExplain1+"<br /><br />"+i18n.viewer.desktopView.autoplayExplain2,placement:"bottom",html:!0}),$(o).find(".autoplay-checkbox").change(h),h()}function h(){var e=["http://api.bitly.com/v3/shorten?callback=?","https://api-ssl.bitly.com/v3/shorten?callback=?"],t=location.protocol=="http:"?e[0]:e[1],n=i.urlToObject(document.location.search).query||{},r=document.location.href;r=p(r,!0),$(".autoplay-checkbox").is(":checked")&&(r+=r.match(/\?/)?"&":"?",r+="autoplay"),$.getJSON(t,{format:"json",apiKey:APPCFG.HEADER_SOCIAL.bitly.key,login:APPCFG.HEADER_SOCIAL.bitly.login,longUrl:r},function(e){if(!e||!e||!e.data.url)return;$("#bitlyLoad").fadeOut(),$("#bitlyInput").fadeIn(),$("#bitlyInput").val(e.data.url),$("#bitlyInput").select()})}function p(e,t){var n=i.urlToObject(e),r=n.path;return n.query&&(delete n.query.edit,delete n.query.locale,delete n.query.folderId,delete n.query.webmap,delete n.query.autoplay,$.each(Object.keys(n.query),function(e,t){e===0?r+="?":r+="&",n.query[t]!==undefined&&n.query[t]!==""?r+=t+"="+n.query[t]:r+=t})),t?r:encodeURIComponent(r)}function d(e){$(o+" #headerMobile .banner").slideDown(e===!0?0:250)}function v(){a||$(o+" #builderPanel").fadeOut("fast"),a=!1}function m(e,t){a=!0,setTimeout(function(){a&&$(o+" #builderPanel").fadeIn("fast"),a=!1},n("ios")||n("ie")>=10?500:100),setTimeout(function(){r.publish("HEADER_EDITED",{src:$(e).attr("class"),value:t}),$(o+" #headerMobile .banner ."+$(e).attr("class")).html(t)},n("ios")||n("ie")>=10?700:0),app.builder.hideSaveConfirmation()}var a=!1;this.init=function(t,n,r,i,s,a,f,l,c,p){this.setColor(i),this.setLogoInfo(s,a),t&&$(o).addClass("hideDesktop"),$(o+" #headerMobile .title").html(n),$(o+" #headerMobile .subtitle").html(r),u&&($(o).addClass("isBuilder"),n="<div class='text_edit_label'>"+(n||i18n.builder.header.editMe)+"</div>",n+="<div class='text_edit_icon' title='"+i18n.builder.header.templateTitle+"'></div>",n+="<textarea rows='1' class='text_edit_input' type='text' spellcheck='true'></textarea>",r="<span class='text_edit_label'>"+(r||i18n.builder.header.editMe)+"</span>",r+="<div class='text_edit_icon' title='"+i18n.builder.header.templateSubtitle+"'></div>",r+="<textarea rows='2' class='text_edit_input' type='text' spellcheck='true'></textarea>"),$(o+" #headerDesktop .title").html(n),$(o+" #headerDesktop .subtitle").html(r),u&&new e(o,v,m),!u&&!r&&($(o+" #headerDesktop .title").css("padding-top",40),$(o+" #headerDesktop .subtitle").css("height",32)),$(window).scroll(this.hideMobileBanner),$(o+" #headerMobile .banner").fastClick(this.hideMobileBanner),$(".navBar span").fastClick(function(){$(this).hasClass("current")||(location.hash=$(this).data("viewid"))}),f&&($(o+" .switchBuilder").fastClick(this.switchToBuilder),$(o+" .switchBuilder").show()),d(!0),this.setTopRightLink(l,c),this.setSocial(p,!0),$(o).css("display","block"),app.requestBitly=h},this.resize=function(e){var t=Math.max($(o+" #headerDesktop .headerLogoImg").outerWidth()+50,$(o+" #headerDesktop .rightArea").outerWidth()+20);$(o+" #headerDesktop .textArea").width(e-t-15)},this.hideMobileBanner=function(e){$(o+" #headerMobile .banner").slideUp(e===!0?0:250),$(o+" #headerMobile").removeClass("firstDisplay")},this.mobileHeaderIsInFirstState=function(){return $(o+" #headerMobile").hasClass("firstDisplay")},this.setColor=function(e){$(o+" #headerDesktop").css("background-color",e),$(o+" #headerMobile").css("background-color",e),$(o+" #builderPanel").css("background-color",e)},this.setLogoInfo=function(e,t){!e||e=="NO_LOGO"?$(o+" .logo img").hide():($(o+" .logo img").attr("src",e),t?($(o+" .logo img").closest("a").css("cursor","pointer"),$(o+" .logo img").closest("a").attr("href",t)):$(o+" .logo img").closest("a").css("cursor","default"),$(o+" .logo img").show())},this.setTopRightLink=function(e,t){t?$(o+" .social .msLink").html(e?'<a href="'+t+'" target="_blank">'+e+"</a>":""):e?$(o+" .social .msLink").html("<span>"+e+"</a>"):$(o+" .social .msLink").html("")},this.setTitleAndSubtitle=function(e,t){$(o+" #headerMobile .title").html(e),$(o+" #headerMobile .subtitle").html(t);var n=u?i18n.builder.header.editMe:"";$(o+" #headerDesktop .title"+(u?" .text_edit_label":"")).html(e||n),$(o+" #headerDesktop .subtitle"+(u?" .text_edit_label":"")).html(t||n)},this.setSocial=function(e,t){$(o+" .share_facebook").toggle(APPCFG.HEADER_SOCIAL&&APPCFG.HEADER_SOCIAL.facebook&&(!e||e.facebook)),$(o+" .share_twitter").toggle(APPCFG.HEADER_SOCIAL&&APPCFG.HEADER_SOCIAL.twitter&&(!e||e.twitter)),$(o+" .share_bitly").toggle(APPCFG.HEADER_SOCIAL&&APPCFG.HEADER_SOCIAL.bitly&&APPCFG.HEADER_SOCIAL.bitly.enable&&APPCFG.HEADER_SOCIAL.bitly.login&&APPCFG.HEADER_SOCIAL.bitly.key&&(!e||e.bitly)),t&&($(o+" .share_facebook").unbind("click"),$(o+" .share_twitter").unbind("click"),$(o+" .share_bitly").unbind("click"),$(o+" .share_facebook").fastClick(f),$(o+" .share_twitter").fastClick(l),$(o+" .share_bitly").fastClick(c))},this.enableAutoplay=function(){$(o+" .shareIcon").attr("title",""),$(o+" .shareIcon").toggleClass("disabled",!0).popover({trigger:"hover",content:'<div style="font-size: 12px">'+i18n.viewer.desktopView.tooltipAutoplayDisabled+"</div>",placement:"bottom",html:!0})},this.switchToBuilder=function(){document.location.search.match(/appid/)?document.location=p(document.location.protocol+"//"+document.location.host+document.location.pathname+document.location.search,!0)+"&edit"+document.location.hash:document.location.search.slice(-1)=="?"?document.location=p(document.location.protocol+"//"+document.location.host+document.location.pathname,!0)+"?edit"+document.location.hash:document.location=p(document.location.protocol+"//"+document.location.host+document.location.pathname,!0)+"?edit"+document.location.hash},this.initLocalization=function(){$(o+" #closeHeaderMobile").html(i18n.viewer.mobileView.hideIntro),$(o+" #leftViewLink").html(i18n.viewer.mobileView.navLeft),$(o+" #mapViewLink").html(i18n.viewer.mobileView.navMap),$(o+" #rightViewLink").html(i18n.viewer.mobileView.navRight),$(o+" .msLink").html(i18n.viewer.desktopView.storymapsText),$(o+" .switchBuilder").html('<div><img src="resources/icons/builder-edit-fields.png" /></div>'+i18n.viewer.desktopView.builderButton),$(o+" .share_facebook").attr("title",i18n.viewer.desktopView.facebookTooltip),$(o+" .share_twitter").attr("title",i18n.viewer.desktopView.twitterTooltip),$(o+" .share_bitly").attr("title",i18n.viewer.desktopView.bitlyTooltip)}}}),define("storymaps/ui/mapCommand/MapCommand",["dojo/has","esri/geometry/Point","dojo/on","esri/symbols/PictureMarkerSymbol","esri/layers/GraphicsLayer","esri/graphic","esri/config"],function(e,t,n,r,i,s,o){return function(a,f,l){function v(e){if(e)$(a.container).find(".mapCommandHomeBtn").addClass("loading"),c=Date.now();else{var t=Date.now()-c,n=0;t<450&&(n=450-t),setTimeout(function(){$(a.container).find(".mapCommandHomeBtn").removeClass("loading"),c=0},n)}}function m(){navigator.geolocation.getCurrentPosition(function(e){var n=new t(e.coords.longitude,e.coords.latitude);f&&typeof f=="function"&&f(!0,n,e);if(a.spatialReference.wkid!=102100&&a.spatialReference.wkid!=4326){o.defaults.geometryService.project([n],a.spatialReference,function(e){if(!e||!e[0])return;g(e[0])});return}g(n)},y,{timeout:2e3})}function g(e){d.clear(),d.add(new s(e,p)),setTimeout(function(){$("#locateLayer_layer image").fadeOut({duration:800})},1e4)}function y(e){f(!1,e)}var c=0,h=$('<div class="esriSimpleSliderIncrementButton"><div class="mapCommandHomeBtn"></div></div>'),p=new r("resources/icons/mapcommand-location-marker.png",21,21),d=new i({id:"locateLayer"});h.fastClick(function(){if(c!==0&&$("body").hasClass("mobile-view"))return;a.setExtent(a._params.extent)}),$(a.container).find(".esriSimpleSlider div:nth-child(1)").after(h),n(a,"update-start",function(){c===0&&v(!0)}),n(a,"update-end",function(){v(!1)}),this.setMobile=function(e){$(".esriSimpleSlider, .mapCommandHomeBtn",a.container).toggleClass("touch",e)},this.destroy=function(){$(a.container).find(".esriSimpleSliderIncrementButton").remove(),$(a.container).find("#mainMap_zoom_location").remove()},this.startLoading=function(){v(!0)},this.stopLoading=function(){v(!1)},this.enableLocationButton=function(e){$(".esriSimpleSlider, .mapCommandHomeBtn",a.container).toggleClass("hidden",!e)},navigator&&navigator.geolocation&&(window.top!==window.self?!1:window.location.protocol.search("https")>=0)&&($(".esriSimpleSlider",a.container).after('<div id="mainMap_zoom_location" class="esriSimpleSlider esriSimpleSliderVertical mapCommandLocation"><div><img src="resources/icons/mapcommand-location.png"></div></div>'),$("#mainMap_zoom_location div",a.container).fastClick(m),this.enableLocationButton(l),a.addLayer(d)),e("touch")&&this.setMobile(!0)}}),define("storymaps/ui/SelectMapWidget/browse-dialog/js/_RefreshMixin",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/on"],function(e,t,n,r){function i(e){typeof e!="object"&&(e=new Error(e)),e.grid=this,r.emit(this.domNode,"dgrid-error",{grid:this,error:e,cancelable:!0,bubbles:!0})&&console.error(e)}var s=e(null,{_trackError:function(e){var s;typeof e=="string"&&(e=t.hitch(this,e));try{s=e()}catch(o){i.call(this,o)}return n.when(s,t.hitch(this,function(){r.emit(this.domNode,"refresh",{cancelable:!0,bubbles:!0})}),t.hitch(this,i))}});return s}),define("storymaps/ui/SelectMapWidget/browse-dialog/js/PortalItemStore",["dojo/_base/declare","dojo/_base/lang","esri/arcgis/Portal"],function(e,t,n){return e(null,{idProperty:"id",constructor:function(t){e.safeMixin(this,t),this.portalUrl=this.portal&&this.portal.portalUrl},getIdentity:function(e){return e[this.idProperty]},query:function(e,r){var e=e,i=t.isObject(e)?e:{q:e};if(r){i=t.mixin(i,{num:r.count,start:(r.start||0)+1});if(r.sort&&r.sort.length){var s=r.sort[0];i=t.mixin(i,{sortField:encodeURIComponent(s.attribute==="created"?"uploaded":s.attribute),sortOrder:s.descending?"desc":"asc"})}}if(this.galleryType==="webmap")var o=this.portal.queryItems(i).then(function(e){return e.results.total=e.total,e.results});else var o=this.portal.queryGroups(i).then(function(e){return e.results.total=e.total,e.results});return n.PortalResult(o)}})}),define("storymaps/ui/SelectMapWidget/browse-dialog/js/Grid",["dojo/_base/declare","dojo/Evented","dojo/string","dojo/_base/lang","dojo/_base/array","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dgrid/Grid","./_RefreshMixin","dgrid/Selection","dgrid/extensions/Pagination","dojo/query","dojo/store/Memory","dojo/store/Cache","./PortalItemStore","dojo/store/Observable","put-selector/put","dgrid/util/mouse"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){return e([s,t],{postMixInProperties:function(){this.inherited(arguments),this._supportedViews=["gallery","details"],this._galleryTemplate=this._galleryTemplate||"<div class='itemGrid'><img alt='' src='${thumbnailUrl:_formatThumbnail}'><div class='itemTitle'>${title:_formatTitle}</div><span class='itemOwner'>${owner}</span><p class='itemText snippet' style='display:none;'>${snippet}</p></div>",this._detailsTemplate=this._detailsTemplate||"<div class='itemDetail'><img alt='' src='${thumbnailUrl:_formatThumbnail}'><p class='truncate itemTitle'>${title}</p><span class='itemOwner'>${owner}</span></p><p class='itemText'>${snippet}</p></div>",this._renderers=r.mixin(this._renderers||{},{gallery:r.hitch(this,function(t){t.snippet=t.snippet||t.description||t.title||"";var r=g("div"),i=new(e([s,o,u],{templateString:n.substitute(this._galleryTemplate,t,null,this)}));return r.appendChild(i.domNode),r}),details:r.hitch(this,function(t){t.snippet=t.snippet||"";var r=g("div"),i=new(e([s,o,u],{templateString:n.substitute(this._detailsTemplate,t,null,this)}));return r.appendChild(i.domNode),r})})},_formatTitle:function(e){return e||(e=""),e},_formatThumbnail:function(e){return e||"resources/icons/builder-selectMap-default.png"},buildRendering:function(){this.inherited(arguments);var t=e([a,c,l,f]),n=this.columns||{id:{label:"id"},title:{label:"title"},type:{label:"type"},modified:{label:"last modified"},snippet:{label:"snippet"}};this._view=this.view||"gallery",this._query=this.query,this._queryOptions=this.queryOptions||{sort:this.sort||[{attribute:"modified",descending:!0}]},this._store=this.store||new d(new v({portal:this.portal,galleryType:this.galleryType}),new p({data:[]})),this._rowsPerPage=this.rowsPerPage||12,this._sort=this.sort||[{attribute:"title",descending:!1}],this._pagingLinks=this.pagingLinks?3:!1,this._grid=new t({columns:n,showHeader:!1,selectionMode:"single",renderRow:this._renderers[this._view],store:this._store,query:this._query,loadingMessage:"Loading...",noDataMessage:"No results found",showLoadingMessage:!0,firstLastArrows:this._pagingLinks,previousNextArrows:this._pagingLinks,rowsPerPage:this._rowsPerPage,pagingLinks:this._pagingLinks,pagingTextBox:!0,sort:this._sort},this.domNode),this._grid.startup()},postCreate:function(){this.inherited(arguments),this.own(this._grid.on(y.enterRow,r.hitch(this,"_showSnippet",!0)),this._grid.on(y.leaveRow,r.hitch(this,"_showSnippet",!1)),this._grid.on("refresh",r.hitch(this,"_onGridRefresh")),this._grid.on(".dgrid-row:click",r.hitch(this,"_onRowClick")))},_onGridRefresh:function(e){this.emit("onRefresh",{currentPage:this._grid._currentPage}),this._pagingLinks&&(h(".dgrid-navigation")[this._grid._total<=this._grid.rowsPerPage?"addClass":"removeClass"]("hide"),h(".dgrid-pagination")[this._grid._total===0?"addClass":"removeClass"]("hide"))},_onRowClick:function(e){this.emit("onItemClick",{row:this._grid.row(e)})},_showSnippet:function(e,t){var n=this._grid.row(t);n&&(h(".itemGrid .itemTitle",n.element)[e?"addClass":"removeClass"]("hover"),h(".itemGrid .itemOwner",n.element).style("display",e?"none":""),h(".itemGrid > img",n.element).style("display",e?"none":""))},_getGridAttr:function(){return this._grid},refresh:function(){this._grid&&this._grid.set("query",this._query,this._queryOptions)},gotoPage:function(e){this._grid.query=this._query,this._grid.queryOptions=this._queryOptions,this._grid._sort=this._queryOptions.sort,this._grid.gotoPage(e)},_setViewAttr:function(e){e=i.indexOf(this._supportedViews,e)===-1?this._view:e,this._view=e,this._grid&&(this._grid.renderRow=this._renderers[e],g(this._grid.domNode,"!gallery!details."+e))},_setStoreAttr:function(e){this._store=e},_setQueryAttr:function(e,t){this._query=e||this._query,this._queryOptions=t||this._queryOptions},_setItemsAttr:function(e){this._store=this._store||new m(p({data:e})),this._store&&this._store.setData?this._store.setData(e):this._store=new m(p({data:e})),this.set("store",this._store),this.set("view",this._view)}})}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!storymaps/ui/SelectMapWidget/browse-dialog/js/templates/BrowseIdDlg.html",[],function(){return'<div class="widgetContent" >\r\n  <div data-dojo-type="dijit/Dialog" id="browse-id-dialog" title="${i18n.title}" execute="">\r\n    <div data-dojo-attach-point="formNode" class="esriItemLinks dijitDialogPaneContentArea">\r\n      <div id="browse-id-box" style="border:#333 1px solid; width:565px; min-height:330px; padding:0; overflow:hidden;">            \r\n        <div class="esriFloatLeading esriLeadingMargin1" style="width:250px; margin-top:10px;">\r\n          <select data-dojo-attach-point="_filterSelect"  data-dojo-type="dijit/form/Select" sortByLabel="false" maxHeight=\'350\' style="width:240px;">\r\n          </select>\r\n        </div>  \r\n        <div class="search esriFloatTrailing esriTrailingMargin1" style="width:250px;">\r\n          <div id="search-form" style="position:relative;">\r\n            <input class="esriSearchBox" type="text" data-dojo-type="dijit/form/TextBox" trim="true" id="browse-id-search-box" data-dojo-attach-point="searchText" data-dojo-attach-event="onKeyPress:_onSearchKeyPress,onFocus:_onSearchBoxFocus,onBlur:_onSearchBoxBlur" alt="${i18n.searchTitle}" title="${i18n.searchTitle}" placeholder="${i18n.placeholder}" />\r\n            <button class="esriLeadingMargin13 esriSearchButton dijitDialogCloseIcon hide" id="clear-box_submit" alt="${i18n.searchTitle}" title="searchTitle" data-dojo-attach-point="clearButton" data-dojo-attach-event="onclick:_onSearchClear" >&nbsp;&nbsp;</button>\r\n          </div>\r\n        </div>\r\n        <div style="position:relative; width:565px;clear:both;" data-dojo-attach-point="gallery"  id="gallery"></div>\r\n      </div>\r\n    </div>\r\n    <div class="submitButtons dijitDialogPaneActionBar esriPositionRight0">\r\n      <input data-dojo-type="dijit/form/Button" name="cancel" class="cancel esriFloatTrailing" type="button" data-dojo-attach-event="onClick:onCancel" label="${i18n.cancel}">  \r\n    </div>\r\n  </div>\r\n</div>\r\n'}),define("storymaps/ui/SelectMapWidget/browse-dialog/js/BrowseIdDlg",["require","dojo/_base/declare","dojo/_base/connect","dojo/_base/lang","dojo/_base/event","dojo/dom-class","dojo/keys","dijit/registry","dojo/on","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","./Grid","esri/arcgis/Portal","text!./templates/BrowseIdDlg.html","dijit/Dialog","dijit/form/Select","dijit/form/Button"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){return t([f,l,c],{templateString:d,constructor:function(e){r.mixin(this,e)},postMixInProperties:function(){this.inherited(arguments),this.i18n={},this.galleryType==="webmap"?this.i18n=i18n.configure.mapdlg:this.i18n=i18n.configure.groupdlg,this.selected=null},postCreate:function(){var e=[];e.push({label:this.i18n.items.contentLabel,value:"content"},{label:this.i18n.items.organizationLabel,value:"org"},{label:app.isPortal?app.portal.name:this.i18n.items.onlineLabel,value:"online"}),this.galleryType==="webmap"&&e.push({label:this.i18n.items.favoritesLabel,value:"favorites"}),this._filterSelect.set("options",e),this._filterSelectHandler=a(this._filterSelect,"change",r.hitch(this,"doSearch"));var t={},n=this.portal.user;n.username&&(t.q="owner: "+n.username),this.galleryType==="webmap"&&(t.q+=' type:"Web Map" -type:"Web Mapping Application"'),this._grid=new h({portal:this.portal,query:t,pagingLinks:!0,galleryType:this.galleryType,view:"gallery"},"gallery"),this._grid.refresh(),a(this._grid,"onItemClick",r.hitch(this,function(e){var t=e.row;e.row.data&&e.row.data.id&&(this.selected=t.data.id)}))},destroy:function(){this._filterSelectHandler.remove(),this.inherited(arguments)},doSearch:function(){var e=this._filterSelect.get("value"),t=this.portal.user,n=null,i=[];this.searchText.getValue()&&(n=this.searchText.getValue()),e==="org"&&(i.orgid=t.orgId),e==="content"&&(i.owner=t.username),e==="favorites"&&(i.group=t.favGroupId);if(e==="online"&&this.galleryType==="group"){var s=this.searchText.getValue();s===""&&(i.access="public")}this.galleryType==="webmap"&&(i.type='"Web Map" -type:"Web Mapping Application"');var o="";for(var u in i){var a=i[u];o+=u+":"+a+" "}var f={};n&&(o=n+" "+o),f.q=r.trim(o),this._grid.set("query",f),this._grid.refresh()},_onSearchClear:function(e){i.stop(e),e!=null&&e.prefentDefault&&e.preventDefault(),this.searchText.setValue(""),s.add("clear-box_submit","hide"),this.doSearch()},_onSearchBoxFocus:function(e){},_onSearchBoxBlur:function(e){this.searchText.getValue()==""},_onSearchKeyPress:function(e){e.keyCode==o.ENTER&&(i.stop(e),this.doSearch()),e.keyCode==8&&this.searchText.getValue().length==1?s.add("clear-box_submit","hide"):s.remove("clear-box_submit","hide"),this.onSearchFieldKeyPress(e)},onSearchFieldKeyPress:function(e){},onClose:function(){u.byId("browse-id-dialog").hide()},onCancel:function(){this.set("selected",null),u.byId("browse-id-dialog").hide()},show:function(e){u.byId("browse-id-dialog").show(),this._grid.refresh()}})}),define("storymaps/core/Core",["esri/map","esri/arcgis/Portal","esri/arcgis/utils","esri/dijit/Legend","storymaps/utils/Helper","storymaps/swipe/core/Config","storymaps/swipe/core/Data","storymaps/swipe/core/WebApplicationData","storymaps/swipe/core/SwipeHelper","storymaps/ui/header/Header","storymaps/ui/mapCommand/MapCommand","storymaps/ui/SelectMapWidget/browse-dialog/js/BrowseIdDlg","dojo/has","esri/IdentityManager","esri/config","esri/tasks/GeometryService","esri/request","esri/urlUtils","dojo/topic","dojo/on","dojo/_base/lang","dojo/_base/array","dojo/_base/kernel","dojo/Deferred","dojo/DeferredList","dojo/query","dijit/registry","esri/dijit/Popup","dojo/dom-construct","dojo/aspect"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){function _(e,t){var r=i.getUrlParams(),u=!1,a=!1,l=!1,c=!1,h=i.getSharingHost();console.log("swipe.core.Core - init"),M=e,ct(),t!=null&&(a=r.fromScratch!=null||r.fromscratch!=null,u=a||c||i.getAppID(ht()),l=r.Layout||r.layout,l&&(l=l.toLowerCase(),setTimeout(function(){if(l!="swipe"||l!="spyglass")l=!1},250))),!i.browserSupportHistory()&&(a||c)&&r.ieredirected=="undefined"&&(window.location=document.location.protocol+"//"+document.location.host+document.location.pathname+"#"+document.location.search+"&ieredirected");if(!s.checkConfigFileIsOK()){Q("invalidConfig");return}app={map:null,maps:[],mainMap:null,rootMapId:null,mapResponse:[],currentMapIndex:-1,portal:null,mode:"TWO_LAYERS",layout:"swipe",data:new o,popup:[],isPopup:!1,search:null,builder:t,isInBuilderMode:u,isDirectCreation:a,isDirectCreationFirstSave:a||c,isGalleryCreation:c,isCreationLayout:l,header:new f("#header",u),loadingTimeout:null,initInProgress:!1,config:{},userCanEdit:!1};if(!M.init(this))return;(!app.isDirectCreation||!app.isGalleryCreation)&&at();if(h)configOptions.sharingurl=h;else if(!configOptions.sharingurl){var v=document.location.pathname.indexOf("/apps/");v==-1&&(v=document.location.pathname.indexOf("/home/"));if(v!=-1){var m=location.pathname.substr(0,v);configOptions.sharingurl="//"+location.host+m+"/sharing/content/items",configOptions.proxyurl="//"+location.host+m+"/sharing/proxy"}else configOptions.sharingurl=APPCFG.DEFAULT_SHARING_URL}n.arcgisUrl=location.protocol+configOptions.sharingurl,configOptions.proxyurl||(configOptions.proxyurl=APPCFG.DEFAULT_PROXY_URL),d.defaults.io.proxyUrl=location.protocol+configOptions.proxyurl,p&&p.setProtocolErrorHandler(function(){return!0}),u&&APPCFG.CORS_SERVER&&$.each(APPCFG.CORS_SERVER,function(e,t){d.defaults.io.corsEnabledServers.push(t)}),APPCFG.PROXY_RULES&&APPCFG.PROXY_RULES.length&&$.each(APPCFG.PROXY_RULES,function(e,t){t&&t.urlPrefix&&t.proxyUrl&&g.addProxyRule(t)}),d.defaults.io.timeout=u?APPCFG.TIMEOUT_BUILDER_REQUEST:APPCFG.TIMEOUT_VIEWER_REQUEST,$.fn.modal.Constructor.prototype.enforceFocus=function(){},$(document).ready(w.hitch(this,D))}function D(){console.log("swipe.core.Core - initStep2"),m({url:n.arcgisUrl.split("/sharing/")[0]+"/sharing/rest/portals/self",content:{f:"json"},callbackParamName:"callback"}).then(w.hitch(this,function(e){!APPCFG.HELPER_SERVICES.geocode.length&&e.helperServices&&e.helperServices.geocode&&e.helperServices.geocode.length&&e.helperServices.geocode[0].url&&$.each(e.helperServices.geocode,function(e,t){APPCFG.HELPER_SERVICES.geocode.push(t)});var t;APPCFG.HELPER_SERVICES.geometry&&APPCFG.HELPER_SERVICES.geometry.url?t=APPCFG.HELPER_SERVICES.geometry.url:e.helperServices.geometry&&e.helperServices.geometry.url&&(t=e.helperServices.geometry.url),d.defaults.geometryService=new v(t),!APPCFG.BING_MAPS_KEY&&e.bingKey&&(APPCFG.BING_MAPS_KEY=e.bingKey),P()}),function(){Q("portalSelf")})}function P(){console.log("swipe.core.Core - initStep3"),app.header.initLocalization(),M.initLocalization(),$(window).resize(function(e){if(e.eventPhase==3)return;et()}),$("form").bind("keydown",function(e){if(e.keyCode==13)return!1});var e=i.getAppID(ht()),t=i.getWebmapsIDs(ht()).slice(0,2);u.setWebmaps(t),b(p,"dialog-create",tt),y.subscribe("CORE_UPDATE_UI",Z),y.subscribe("CORE_RESIZE",et),loadingIndicator.setMessage(i18n.viewer.loading.step2);var n=a.isOnMobileView();(app.isDirectCreation||app.isGalleryCreation)&&$("#fatalError").css("display",n?"block":"none");if(e)H(e);else if(t&&t.length==2&&!app.isDirectCreation&&!app.isGalleryCreation)q(t);else if(t.length&&!app.isDirectCreation&&!app.isGalleryCreation)i.getUrlParams().appid&&(!configOptions.authorizedOwners||!configOptions.authorizedOwners[0])?Q("unspecifiedConfigOwner"):R(t[0]);else if((app.isDirectCreation||app.isGalleryCreation)&&ht()&&!i.getPortalUser())it(),Q("initMobile2",null,!0);else if(app.isDirectCreation||app.isGalleryCreation){var r="initMobile2";h("touch")&&i.isMobile()&&(window.innerHeight>window.innerWidth?window.innerHeight>768&&(r="initMobile3"):window.innerWidth>768&&(r="initMobile3")),Q(r,null,!0),I().then(function(){var e={portal:app.portal,galleryType:"webmap"};app.browseDlg=new c(e),app.builder.initMapPicker(R),b(app.browseDlg._grid,"onItemClick",function(e){$("#initMapPopup").show(),$(".webmap-id-input").find("input").val(app.browseDlg.selected),app.browseDlg.onClose(),$(".webmap-id-input").keyup()}),b(app.browseDlg,"close",function(){$("#initMapPopup").show()}),b(app.browseDlg,"cancel",function(){$("#initMapPopup").show()});var t=C.byId("browse-id-dialog");t._onKey=function(e){e.keyCode==27&&dojo.stopEvent(e)}})}else ht()?Q("invalidConfigNoWebmap"):Q("invalidConfigNoAppDev")}function H(e){console.log("swipe.core.Core - loadWebMappingApp - appId:",e);var t=g.urlToObject(document.location.search).query||{},n=t.forceLogin!=undefined;n||app.isInBuilderMode?I().then(function(){B(e)},function(){Q("notAuthorized")}):B(e)}function B(e){var t=m({url:configOptions.sharingurl+"/"+e+"",content:{f:"json"},callbackParamName:"callback",load:function(e){app.data.setAppItem(e)},error:function(){}}),n=m({url:configOptions.sharingurl+"/"+e+"/data",content:{f:"json"},callbackParamName:"callback",load:function(e){u.set(e)},error:function(){}}),r=new T([t,n]);r.then(function(){if(!n.results||!n.results[0]||!t.results||!t.results[0]){t.results&&t.results[1]&&t.results[1]&&t.results[1].httpCode==403?Q("notAuthorized"):Q("invalidApp");return}app.userCanEdit=app.data.userIsAppOwner(),!app.isInBuilderMode&&!app.userCanEdit&&(document.__defineGetter__?(document.__defineGetter__("cookie",function(){return""}),document.__defineSetter__("cookie",function(){})):Object.defineProperty(document,"cookie",{get:function(){return""},set:function(){return!0}}));if(configOptions.authorizedOwners&&configOptions.authorizedOwners.length>0&&configOptions.authorizedOwners[0]){var e=!1;t.results[0].owner&&(e=$.inArray(t.results[0].owner,configOptions.authorizedOwners)!=-1),!e&&configOptions.authorizedOwners[0]=="*"&&(e=!0),configOptions.appid&&(e=!0);if(!e){Q("invalidConfigOwner");return}}var r=u.getWebmaps(!1),s=u.getWebmap(!1);app.rootMapId=s;if(t.results[0]&&t.results[0].appProxies){var o=E.map(t.results[0].appProxies,function(e){return{url:e.sourceUrl,mixin:{url:e.proxyUrl}}});app.data.setAppProxies(o)}if(app.isInBuilderMode&&!app.userCanEdit){Q("notAuthorized");return}if(r&&r.length==2&&u.getDataModel()=="TWO_WEBMAPS")q(r);else if(s&&u.getDataModel()&&u.getLayers()!=null)R(s);else if(s&&app.isInBuilderMode)R(s);else if(r&&!app.isInBuilderMode)app.userCanEdit?(loadingIndicator.setMessage(i18n.viewer.loading.loadBuilder),setTimeout(function(){app.header.switchToBuilder()},1200)):Q("noLayerView");else if(i.getPortalUser()||!ht()){app.isGalleryCreation=!0;if(app.isInBuilderMode==0){var a=t.results[0].id;History.replaceState({},"","index.html?appid="+a+"&edit"),location.reload(!0)}app.isDirectCreationFirstSave=!1,j()}else Q("invalidApp")})}function j(){Q("initMobile2",null,!0);if(app.isInBuilderMode&&h("ie")&&h("ie")<9)return Q("noBuilderIE8"),!1;I().then(function(){var e={portal:app.portal,galleryType:"webmap"};app.browseDlg=new c(e),$("").css("display","none"),app.builder.initMapPicker(R),b(app.browseDlg._grid,"onItemClick",function(e){$("#initMapPopup").show(),$(".webmap-id-input").find("input").val(app.browseDlg.selected),app.browseDlg.onClose(),$(".webmap-id-input").keyup()}),b(app.browseDlg,"close",function(){$("#initMapPopup").show()}),b(app.browseDlg,"cancel",function(){$("#initMapPopup").show()});var t=C.byId("browse-id-dialog");t._onKey=function(e){e.keyCode==27&&dojo.stopEvent(e)}})}function F(){var e="initMobile2";if(app.initInProgress||$("#initPopup").is(":visible")||u.getDataModel())return;app.initInProgress=!0,ft(),h("touch")&&i.isMobile()&&(window.innerHeight>window.innerWidth?window.innerHeight>768&&(e="initMobile3"):window.innerWidth>768&&(e="initMobile3")),Q(e,null,!0),et();var t=app.builder.presentInitPopup();t.then(function(){app.initInProgress=!1,rt();var e=u.getWebmaps(),t=u.getWebmap()||u.getWebmaps()[0];e&&e.length==2&&u.getDataModel()=="TWO_WEBMAPS"?q(u.getWebmaps()):R(t)},function(){G("noLayerView"),$("#loadingOverlay").css("top","0px"),$("#header").css("display","inherit"),$("#fatalError").css("display","block"),app.initInProgress=!1,et()})}function I(){var e=new x,n=configOptions.sharingurl.split("/sharing/")[0];return app.portal=new t.Portal(n),b(p,"dialog-create",nt),app.portal.on("load",function(){app.isPortal=!!app.portal.isPortal,app.portal.signIn().then(function(){if(app.isInBuilderMode&&!app.data.checkUserItemPrivileges()){Q("notAuthorizedBuilder");return}app.userCanEdit=app.data.userIsAppOwner(),e.resolve()},function(t){e.reject()})}),e}function q(e){u.getWebmaps().length==2&&(app.mode="TWO_WEBMAPS");var t=[];$.each(e,function(e,n){t.push(R(n,e))}),(new T(t)).then(function(){setTimeout(M.webmapLoaded,0)})}function R(e,t){console.log("swipe.core.Core - loadWebMap - webmapId:",e,t),t=t||0;var r=!1;t==0&&u.getLayout()=="swipe"&&app.mode=="TWO_WEBMAPS"&&(t=1,r=!0),t==1&&u.getLayout()=="swipe"&&app.mode=="TWO_WEBMAPS"&&r==0&&(t=0);var i=new x,s="mainMap"+t;return t==1&&u.getLayout()=="spyglass"&&app.mode=="TWO_WEBMAPS"&&(s="lensMapNode"),app.popup[t]=new k({highlight:!0,offsetX:0},L.create("div")),n.createMap(e,s,{mapOptions:{slider:s!="lensMapNode",autoResize:!1,infoWindow:app.popup[t],showAttribution:s!="lensMapNode",usePopupManager:!0},ignorePopups:!1,bingMapsKey:APPCFG.BING_MAPS_KEY,editable:!1,layerMixins:app.data.getAppProxies()}).then(w.hitch(this,function(e){z(e,i)}),function(){Q("createMap")}),i}function U(e){return $.inArray(e,i.getWebmapsIDs(ht()))}function z(e,t){console.log("swipe.core.Core - webMapCallback");var s=e.itemInfo.item;if(configOptions.authorizedOwners&&configOptions.authorizedOwners.length>0&&configOptions.authorizedOwners[0]){var o=s.owner,a=!1;o&&(a=$.inArray(o,configOptions.authorizedOwners)!=-1),!a&&configOptions.authorizedOwners[0]=="*"&&(a=!0),configOptions.appid&&(a=!0);if(!a){Q("invalidConfigOwner");return}}app.mainMap=app.map;if(app.mode=="TWO_WEBMAPS"){var f=$.inArray(e.itemInfo.item.id,u.getWebmaps());app.mapResponse[f]=e,app.maps[f]=e.map,app.mainMap=app.maps[0],u.setLabels(!1),e.itemInfo.item.id==app.rootMapId&&(app.map=e.map),f==0&&(app.data.setWebMapItem(e.itemInfo),app.maps[0]=e.map),f==1?app.data.setWebMapItem2(e.itemInfo):t.resolve();if(u.getLegend()||configOptions.legend){if(f==0){var l=new r({map:app.maps[0],layerInfos:n.getLegendLayers(e)},"legend0");l.startup(),X(l)}else{var c=new r({map:app.maps[1],layerInfos:n.getLegendLayers(e)},"legend1");c.startup()}V(c)}}else{app.map=e.map,app.mapResponse[0]=e,app.data.setWebMapItem(e.itemInfo);var h=app.map.getLayer(u.getLayers()[0])||{},p=h.id,d=app.map.getLayer("labels"),v=(app.map.layerIds||[]).concat(app.map.graphicsLayerIds),m=$.grep(v,function(e){return e==p});m.length||(p=(app.map.layerIds||[]).concat(app.map.graphicsLayerIds).slice(-1),h=app.map.getLayer(p),u.setLayers(p)),d&&$.each(d.featureLayers,function(e,t){t==h&&u.setLabels(!0)});if(u.getLegend()||configOptions.legend){var y=h&&h.arcgisProps&&h.arcgisProps.title?h.arcgisProps.title:h&&h.name?h.name:h,w=n.getLegendLayers(e),E=$.grep(w,function(e){return e.title!=y}),S=$.grep(w,function(e){return e.title==y}),l=new r({map:app.map,layerInfos:E},"legend0");l.startup();var c=new r({map:app.map,layerInfos:S},"legend1");c.startup(),W(l,c)}}Y(u.getLayout()||configOptions.layout),et();if(app.mode!="TWO_WEBMAPS"||app.mainMap==e.map){var x=configOptions.title||u.getTitle()||app.data.getAppItem().title||e.itemInfo.item.title,T=configOptions.subtitle||u.getSubtitle()||e.itemInfo.item.snippet,N=g.urlToObject(document.location.search).query||{},C=u.getColors(),k=u.getLogoURL()||APPCFG.HEADER_LOGO_URL,L=k==APPCFG.HEADER_LOGO_URL?APPCFG.HEADER_LOGO_TARGET:u.getLogoTarget();app.header.init(!app.isInBuilderMode&&(APPCFG.EMBED||N.embed||N.embed===""),x,T,C[0],k,L,!app.isInBuilderMode&&i.getAppID()&&(!ht()||app.userCanEdit)&&!N.preview,u.getHeaderLinkText()==undefined?APPCFG.HEADER_LINK_TEXT:u.getHeaderLinkText(),u.getHeaderLinkURL()==undefined?APPCFG.HEADER_LINK_URL:u.getHeaderLinkURL(),u.getSocial()),document.title=$("<div>"+x+"</div>").text()}try{t.resolve()}catch(A){}if((app.isInBuilderMode||app.isDirectCreation||app.isGalleryCreation)&&u.getWebmaps().length!=2&&!u.getDataModel()){b(app.map,"update-end",F),setTimeout(F,5e3);return}app.mode=="TWO_LAYERS"&&setTimeout(M.webmapLoaded,0)}function W(e,t){X(e),V(t)}function X(e){e&&e.layers.length==0&&($("#legend0").css("display","none"),$("#legend1").css("width","100%"),$("#legend1 .esriLegendServiceLabel").css("width","300px"))}function V(e){e&&e.layers.length==0&&($("#legend0").css("width","100%"),$("#legend1").css("display","none"),$("#legend0 .esriLegendServiceLabel").css("width","300px"))}function J(){console.log("swipe.core.Core - initMap");var e=0;new l(app.mainMap,M.zoomToDeviceLocation),app.mode=="TWO_WEBMAPS"&&new l(app.maps[1],M.zoomToDeviceLocation),et(),location.hash&&(location.hash="map"),window.onhashchange=function(e){if(location.hash==""||location.hash=="#")return;ot(),location.hash=="#map"?($("#mapViewLink").addClass("current"),ut(),u.getSeries()&&a.isOnMobileView()&&$("#footerMobile").show()):M.onHashChange()},M.appInitComplete(),app.builder&&app.builder.appInitComplete(),document.location.pathname.match(/\/apps\/[a-zA-Z]+\/$/)&&document.location.search.match(/^\?appid=/)&&(!h("ie")||h("ie")>=10)&&History.replaceState({},"","index.html"+document.location.search+document.location.hash)}function K(){$("#header").hasClass("hideDesktop")&&$("#sliderDiv").length&&$(window).resize(),app.loadingTimeout!=null&&$("#loadingOverlay, #loadingIndicator, #loadingMessage").fadeOut(),ft()}function Q(e,t,n){st(),ft(),$("#loadingIndicator, #loadingMessage").hide();if(e=="noLayerView"){loadingIndicator.setMessage(i18n.viewer.errors[e],!0);return}$("#fatalError .error-msg").html(i18n.viewer.errors[e]),n||$("#fatalError").show()}function G(e){$("#fatalError .error-msg").html(i18n.viewer.errors[e])}function Y(e){$("body").toggleClass("modern-layout",e=="integrated")}function Z(){console.log("swipe.core.Core - updateUI");var e=u.getColors();Y(u.getLayout()),app.header.setTitleAndSubtitle(u.getTitle()||app.data.getWebMapItem().item.title,u.getSubtitle()||app.data.getWebMapItem().item.snippet),app.header.setColor(e[0]);var t=u.getLogoURL()||APPCFG.HEADER_LOGO_URL;app.header.setLogoInfo(t,t==APPCFG.HEADER_LOGO_URL?APPCFG.HEADER_LOGO_TARGET:u.getLogoTarget()),app.header.setTopRightLink(u.getHeaderLinkText()==undefined?APPCFG.HEADER_LINK_TEXT:u.getHeaderLinkText(),u.getHeaderLinkURL()==undefined?APPCFG.HEADER_LINK_URL:u.getHeaderLinkURL()),app.header.setSocial(u.getSocial()),app.seriesPanel&&(app.seriesPanel.setColor(e[0]),app.mobileCarousel.setColor(e)),$("#infoWindowContent").css("background-color",e[1]),M.updateUI(),et()}function et(){var e=a.isOnMobileView(),t=$("#mapViewLink").hasClass("current");e?$("body").addClass("mobile-view"):$("body").removeClass("mobile-view"),e&&!u.getLegend()&&!app.isPopup&&(APPCFG.EMBED||i.getUrlParams().embed||i.getUrlParams().embed==="")&&($("#header").hide(),$("#header").css("cssText","height: 0px !important"),$(".banner").hide());var n=$("body").width(),r=$("body").height(),s=$("#header").height(),o=$("#seriesPanel").height(),f=r-s-o;e&&o>0&&(f-=$("#footerMobile").height()-o),app.header.resize(n),M.resize({isMobileView:e,isOnMobileMapView:t,width:n,height:f}),$("#contentPanel").height(f),$("#contentPanel").width(n),$("#mapPanel").width(n-$("#picturePanel").width()),(app.isInBuilderMode||app.isDirectCreation||app.isGalleryCreation)&&app.builder.resize({isMobileView:e});if(!e||e&&t)try{app.map?app.mainMap.resize(!0):app.maps[1]&&app.mode!="TWO_WEBMAPS"&&app.layout!="spyglass"&&app.maps[1].resize(!0)}catch(l){}e?$("#mainMap .esriControlsBR > div").first().removeClass("logo-med").addClass("logo-sm"):$("#mainMap .esriControlsBR > div").first().removeClass("logo-sm").addClass("logo-med")}function tt(){$(".esriSignInDialog td label").siblings("br").css("display","none"),$(".esriSignInDialog .dijitDialogPaneContentArea div:nth(1)").css("display","none"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("padding","0px"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("margin-bottom","0px"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("border","none"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("border-radius","0px"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("-webkit-border-radius","0px"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("-moz-border-radius","0px"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("box-shadow","none"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("-webkit-box-shadow","none"),$(".esriSignInDialog .dijitReset.dijitInputInner").css("-moz-box-shadow","none"),$(".esriSignInDialog .dijitReset.dijitValidationContainer").css("display","none"),$(".esriSignInDialog .esriErrorMsg").css("margin-top","10px"),$(".esriSignInDialog").find(".dijitDialogTitleBar").find(".dijitDialogTitle").first().html("Authentication is required"),$(".esriSignInDialog").find(".dijitDialogPaneContentArea:first-child").find(":first-child").first().css("display","none"),$(".esriSignInDialog").find(".dijitDialogPaneContentArea:first-child").find(":first-child").first().after("<div id='dijitDialogPaneContentAreaLoginText'>Please sign in with an account on <a href='http://"+p._arcgisUrl+"' title='"+p._arcgisUrl+"' target='_blank'>"+p._arcgisUrl+"</a> to access the application.</div>")}function nt(){$(".esriSignInDialog").find("#dijitDialogPaneContentAreaLoginText").css("display","none"),$(".esriSignInDialog").find(".dijitDialogPaneContentArea:first-child").find(":first-child").first().after("<div id='dijitDialogPaneContentAreaAtlasLoginText'>Please sign in with an account on <a href='http://"+p._arcgisUrl+"' title='"+p._arcgisUrl+"' target='_blank'>"+p._arcgisUrl+"</a> to configure this application.</div>")}function rt(){y.publish("BUILDER_INCREMENT_COUNTER"),C.byId("legend0")&&C.byId("legend0").destroy(),C.byId("legend1")&&C.byId("legend1").destroy(),$("#legendPanel").html('<div id="legend0"></div><div id="legend1"></div>'),app.map&&(app.map.destroy(),app.map=null),app.maps[0]&&(app.maps[0].destroy(),app.maps[0]=null),app.maps[1]&&(app.maps[1].destroy(),app.maps[1]=null),app.popup[0]&&app.popup[0].destroy(),app.popup[1]&&app.popup[1].destroy(),$("#header").css("display","inherit"),$("#footer").css("display","inherit"),$("#fatalError").css("display","none"),$("#loadingOverlay").css("top","0px"),$("#loadingIndicator").show(),loadingIndicator.setMessage(i18n.viewer.loading.step2),at(),et()}function it(){loadingIndicator.setMessage(i18n.viewer.loading.redirectSignIn+"<br />"+i18n.viewer.loading.redirectSignIn2),setTimeout(function(){window.location=n.arcgisUrl.split("/sharing/")[0]+"/home/signin.html?returnUrl="+encodeURIComponent(document.location.href)},2e3)}function st(){$("#header").hide(),$(".mobileView").hide(),$("#footer").hide(),$(".modal").hide()}function ot(){$(".mobileView").hide(),$("#footerMobile").hide(),$(".navBar span").removeClass("current")}function ut(){$("#contentPanel").show(),$("#footerMobile").show(),$("#mapPanel").show(),et()}function at(){app.loadingTimeout=setTimeout(lt,APPCFG.TIMEOUT_VIEWER_LOAD)}function ft(){typeof app!="undefined"&&app.loadingTimeout&&(clearTimeout(app.loadingTimeout),app.loadingTimeout=null)}function lt(){if(p&&p.dialog&&p.dialog._alreadyInitialized&&!p.loadingTimeoutAlreadyFired){clearTimeout(app.loadingTimeout),at(),p._busy||(p.loadingTimeoutAlreadyFired=!0);return}$("#loadingIndicator, #loadingMessage").hide(),loadingIndicator.setMessage(i18n.viewer.loading.fail+'<br /><button type="button" class="btn btn-medium btn-info" style="margin-top: 5px;" onclick="document.location.reload()">'+i18n.viewer.loading.failButton+"</button>",!0),app.map&&app.map.destroy()}function ct(){document.documentElement.lang=S.locale,N("#fatalError .error-title")[0].innerHTML=i18n.viewer.errors.boxTitle}function ht(){return O.environment!=["TPL","ENV","DEV"].join("_")}var O={environment:"TPL_ENV_PRODUCTION"},M=null;return{init:_,isProd:ht,appInitComplete:J,displayApp:K,openInitPopup:F,initError:Q}}),define("storymaps/swipe/ui/desktop/SidePanel",["storymaps/swipe/core/WebApplicationData","esri/dijit/Legend","dojo/topic","dojo/on","dojo/dom","dojo/dom-class"],function(e,t,n,r,i,s){return function(o,u){function x(){$("#legendView1").empty(),$("#legendView2").empty(),$("#legendView1").append($("#legend0").children().clone()),$("#legendView2").append($("#legend1").children().clone())}function T(e,t,n){var r=$("#legendTitle").height();$("#legendTitle").css("line-height",r+"px");var i=f.find("div").eq(3);t==1&&(u&&!E?nicEditors.findEditor("descriptionContentInner").nicInstances[0].setContent(e||""):!u&&!E&&i.html(e||""));if(!t&&!E||!w)$("#sidePanelUnderTabImg").css("display","block"),$("#sidePanelTabImg").css("display","none");(t||E)&&!w&&a.addClass("single"),!t&&!E&&(f.css("display","none"),h.css("display","none"),a.addClass("single"),c.addClass("only"),c.css("top",0));if(n==1)var s=setTimeout(x,1e3);else c.css("display","none"),h.css("display","none"),$("#legendView .noData").css("display","block"),u&&(a.addClass("builder"),f.css("height",a.css("height")));if(w==0&&b==0&&E==0){$("#sidePanelTabImg").css("display","none"),$("#sidePanelUnderTabImg").css("display","none"),$("#sidePanel").css("display","none");return}app.mode=="TWO_WEBMAPS"&&m=="spyglass"&&$("#mainMap1_zoom_slider").css("display","none"),a.hasClass("single")&&($("#descriptionPanel").addClass("single"),$("#sidePanel").css("height","auto"),parseInt($("#sidePanel").css("height"))>.6*parseInt(app.mainMap.height)?$("#sidePanel").css("height","60%"):$("#sidePanel").css("height","auto"),y?$("#sidePanel").css("top","0"):E?$("#sidePanel").css("top","146px"):$("#sidePanel").css("top","111px"))}function N(){if($("body").hasClass("mobile-view"))return;k()=="open"?A():O()}function C(){if($("body").hasClass("mobile-view"))return;L()=="open"?M():_()}function k(){return $("#sidePanelTabImg").hasClass("open")?"open":"close"}function L(){return $("#sidePanelUnderTabImg").hasClass("open")?"open":"close"}function A(){if($("#sidePanel").css("left")<0)return;D("in"),s.remove("sidePanelTabImg","closeImg"),$("#sidePanelTabImg").hasClass("open")&&$("#sidePanelTabImg").removeClass("open")}function O(){D("out"),s.add("sidePanelTabImg","closeImg"),$("#sidePanelTabImg").hasClass("open")||$("#sidePanelTabImg").addClass("open")}function M(){if($("#sidePanel").css("top")<0)return;P("up"),s.remove("sidePanelUnderTabImg","closeImg"),$("#sidePanelUnderTabImg").hasClass("open")&&$("#sidePanelUnderTabImg").removeClass("open")}function _(){P("down"),s.add("sidePanelUnderTabImg","closeImg"),$("#sidePanelUnderTabImg").hasClass("open")||$("#sidePanelUnderTabImg").addClass("open")}function D(e){$("#sidePanel").animate({left:e=="in"?-355:0,queue:!1},750),$(".mapCommandLocation").animate({left:e=="in"?20:375,queue:!1},750),app.autoplay&&$("#autoplay").animate({left:e=="in"?"50%":355+($(window).width()-355)/2,queue:!1},750),app.mode=="TWO_LAYERS"||m=="spyglass"?$("#mainMap0_zoom_slider").animate({left:e=="in"?20:375,queue:!1},750):($("#mainMap0_zoom_slider").animate({left:e=="in"?20:375,queue:!1},750),$("#mainMap1_zoom_slider").animate({left:e=="in"?20:375,queue:!1},750))}function P(e){var t=parseInt($("#sidePanel").css("height")),n=parseInt($("#sidePanel").css("height")),r=parseInt($("#header").css("height"));t-=parseInt($("#seriesPanel").css("height")),t-=parseInt(r),r+=parseInt($("#seriesPanel").css("height")),$("#sidePanel").animate({clip:e=="up"?"rect("+n+"px 350px "+parseInt(n+45)+"px 0px)":"rect(0px 350px "+parseInt(n+45)+"px 0px)",top:e=="up"?-t:r,queue:!1},750),$(".mapCommandLocation").animate({left:e=="up"?20:370,queue:!1},750),app.autoplay&&$("#autoplay").animate({left:e=="up"?"50%":355+($(window).width()-355)/2,queue:!1},750),app.mode=="TWO_LAYERS"||m=="spyglass"?$("#mainMap0_zoom_slider").animate({left:e=="up"?20:370,queue:!1},750):($("#mainMap0_zoom_slider").animate({left:e=="up"?20:370,queue:!1},750),$("#mainMap1_zoom_slider").animate({left:e=="up"?20:370,queue:!1},750),$("#mainMap_zoom_location").animate({left:e=="up"?20:370,queue:!1},750))}function H(e,t){f.css("background-color",e),f.find("#descriptionContent").css("background-color",e),c.css("background-color",e),h.css("background-color",t)}var a=o,f=o.find("#descriptionPanel"),l=o.find("#descriptionContent"),c=o.find("#legendPanel"),h=o.find("#legendTitle"),p="",d=null,v=null,m=null,g=null,y=!1,b=null,w=null,E=!1,S=this;this.init=function(e,t,n,s,a,f,c,d,k,L){v=f,m=d,g=k,b=s,w=a,E=c,g==null&&(g="TWO_LAYERS"),g=="TWO_LAYERS"?app.mainMap=app.map:app.mainMap=app.maps[0],y=L,o.height(app.mainMap.height);if(u&&s&&!E){$(l).addClass("builder");var A=new nicEditor({buttonList:["fontSize","fontFamily","bold","italic","underline","left","center","right","ul","link","html"]});$("#textEditPanel").addClass("builder"),A.setPanel("textEditPanel"),A.addInstance("descriptionContentInner"),p=e,A.addEvent("focus",function(){A.addEvent("blur",S.checkDescription)}),$(".nicEdit-main").parent().css("width","342px"),$(".nicEdit-main").css("width","330px"),$(".nicEdit-main").parent().css("border","none"),r($(" .nicEdit-panel").children().last().children().children().children(),"click",function(){$("#href").siblings()[0]&&($("#href").siblings()[0].addClass("hrefLabel"),$("#href").addClass("href")),$("#title").siblings()[0]&&$("#title").siblings()[0].addClass("hrefLabel")})}H(t,n),T(e,s,a),r(i.byId("sidePanelTabImg"),"click",N),r(i.byId("sidePanelUnderTabImg"),"click",C),h.html(i18n.swipe.swipeSidePanel.legendTitle),r(app.mainMap,"update-end",x),$(window).resize(function(){var e=$("#legendTitle").height();$("#legendTitle").css("line-height",e+"px"),S.resize()})},this.update=function(e,t){H(e,t)},this.resize=function(e,t){if(w&&E||w&&b)o.height(app.mainMap.height),$("#legendPanel").height($("#sidePanel").height()-$("#descriptionPanel").height()-$("#legendTitle").height()-10);if(w&&E){$("#descriptionContent").addClass("legend");var n=app.isInBuilderMode?$("#seriesControls").height()+10:0;$("#descriptionContent").height($("#descriptionPanel").height()-$("#descriptionTitle").height()-2*n-30),$("#descriptionContent").css("margin-bottom",n)}E&&app.seriesPanel.sizeTextDescription(),w&&!E&&!b?$("#legendPanel").height()>$("#contentPanel").height()&&$("#legendPanel").height($("#contentPanel").height()-45):app.isInBuilderMode&&$("#descriptionContent").height($("#descriptionPanel").height()-45),$(".nicEdit-panelContain").parent().css("width","348px")},this.checkDescription=function(t){setTimeout(function(){if(p==nicEditors.findEditor("descriptionContentInner").nicInstances[0].getContent())return;e.setSidePanelDescription(nicEditors.findEditor("descriptionContentInner").nicInstances[0].getContent()),p=nicEditors.findEditor("descriptionContentInner").nicInstances[0].getContent();if(t==1)return;n.publish("BUILDER_INCREMENT_COUNTER")},0)}}}),define("storymaps/ui/autoplay/Autoplay",["dojo/topic","dojo/has"],function(e,t){var n=6e3,r=10;return function(i,s){function c(e,t){console.log("Autoplay: start, delay:",e,"immediate:",t),o=!0,u&&clearTimeout(u),t?p(e):u=setTimeout(function(){p(e)},e)}function h(){if(!o)return;console.log("Autoplay: pause"),o=!1,u&&clearTimeout(u)}function p(e){a=s(),u=setTimeout(function(){p(e)},e)}function d(){return i.find(".btn-play-container").hasClass("status-play")}function v(e){i.find(".btn-play-container").removeClass("status-play status-pause"),i.find(".btn-play").removeClass("autoplay-icon-play autoplay-icon-pause"),i.find(".btn-play-container").addClass(e?"status-play":"status-pause"),i.find(".btn-play").addClass(e?"autoplay-icon-pause":"autoplay-icon-play")}function m(){var e=!d();e?g(!0):h(),v(e)}function g(e){var t=i.find(".slider input").slider("getValue").val()||r;c(t*1e3,e)}function y(){var e=Date.now();f>Date.now()-150&&i.removeClass("fade"),f=e}function b(){!l&&Date.now()>f+n&&i.addClass("fade")}function w(){i.find(".btn-play-container").click(m),i.find(".slider-container input").slider({min:5,max:60,value:r,formater:function(e){return e+"s"}}),i.find(".slider-container input").on("slideStop",function(){d()&&g(!1)}),t("touch")||(f=Date.now(),i.hover(function(){l=!0},function(){l=!1,b()}),$(window).mousemove(y),setInterval(b,1e3))}var o=!1,u=null,a=null,f=null,l=!1;(!i||!s||typeof s!="function")&&console.log("Autoplay: failed to initialize"),i.show(),w(),this.init=function(e){if(!e)return;e.color&&(e.useBackdrop?(i.find(".backdrop").css({backgroundColor:e.color,display:"block"}),i.find(".autoplay-container").css({backgroundColor:"inherit"})):i.find(".autoplay-container").css({backgroundColor:e.color})),e.themeMajor&&i.addClass("theme-"+e.themeMajor)},this.start=function(){g(!1),v(!0)},this.stop=function(){h(),v(!1)},this.onNavigationEvent=function(e){d()&&e!=a&&m()},this.destroy=function(){i.hide()}}}),define("storymaps/swipe/ui/mobile/MobileSwipeView",[],function(){return function(t,n){function i(e){var t=2;if(e.length!=t)return;r=new SwipeView(n,{numberOfPages:t,loop:!1});for(var i=0;i<t;i++){var s=e[i];$(r.masterPages[i+1]).html(s)}}function s(e){r.onTouchStart(function(e){}),r.onFlip(function(e){r.currentMasterPage==1?$(t).find(".swiper").removeClass("left").addClass("right"):$(t).find(".swiper").removeClass("right").addClass("left")}),r.onMoveOut(function(){}),$(t).find(".swiper").on("click",function(e){$(t).find(".swiper").hasClass("right")?r.next():r.prev()})}function o(e){$(t).css("background-color",e)}var r=null;this.init=function(e,t){o(t),i(e),s(e)},this.update=function(e){o(e)},this.show=function(){$(t).show(),r.refreshSize(),r.goToPage(0)},this.next=function(){r.next()},this.previous=function(){r.prev()}}}),define("storymaps/swipe/ui/mobile/Carousel",[],function(){return function(t,n){function u(e){r=new SwipeView(t+" .carousel",{numberOfPages:e.length}),o.length=e.length;var n=Math.min(3,Math.max(3,e.length));for(var i=0;i<n;i++){var s=e.length==1?0:i==0?e.length-1:i-1,u=e[s];if(!u)continue;var a=u.name,f=u.description,l=document.createElement("div");l.className="tpPreview";var c=document.createElement("div");c.className="tpImgPane",l.appendChild(c);var h=document.createElement("div");h.className="tpImgContainer seriesButton",c.appendChild(h);var p=document.createElement("p");p.className="seriesLabel";var d=e.indexOf(u)+1;p.innerHTML=d,h.appendChild(p);var v=document.createElement("div");v.className="tpTextPane",l.appendChild(v);var m=document.createElement("h4");m.className="tpName",m.innerHTML=a||"",v.appendChild(m);var g=document.createElement("p");g.className="tpDescription previewDescription",g.innerHTML=f||"",v.appendChild(g),r.masterPages[i].appendChild(l)}setTimeout(function(){o.setSelectedPoint(app.bookmarkIndex||0)},250)}function a(e){$(".tpPreview").click(function(e){if(Math.abs(e.clientX-s[0])<10&&Math.abs(e.clientY-s[1])<10){var t=$(this).find(".tpName").html(),n=$(this).find(".tpDescription").html(),r=!0;o.setDescriptionView(t,n,r)}}),$("#seriesTextView").click(function(){$("#seriesTextView").hide(),$("#footerMobile").show(),location.hash="map"}),$(t+" .carousel").mousedown(function(e){s=[e.clientX,e.clientY]}),r.onFlip(function(){var t=Math.min(3,e.length);for(var n=0;n<t;n++){var i=r.masterPages[n],s=i.dataset.upcomingPageIndex;if(!e[s])return;var o=e[s].name,u=e[s].description;if(s!=i.dataset.pageIndex){var a=i.querySelector(".tpName");a.innerHTML=o;var f=i.querySelector(".tpDescription");f.innerHTML=u;var l=i.querySelector(".seriesLabel");l.innerHTML=parseInt(s)+1}}$("#footerMobile").is(":visible")&&dojo.publish("CAROUSEL_SWIPE",r.pageIndex)})}function f(e){var n=$(t+" .carousel .swipeview-active");n.find(".tpName").html(e.name),n.find(".tpDescription").html(e.description)}var r=null,i=!1,s=[0,0],o=this;this.started=!1,this.needUpdate=!1,this.init=function(e,t){u(e),a(e),o.setColor(t)},this.update=function(e,n){o.setColor(n),r.destroy(),$(t+" .carousel").empty(),u(e),a(e),o.needUpdate=!1},this.setSelectedPoint=function(e){if(!r)return;o.started=!0,e==0?$(".embed-btn-left").addClass("disabled"):$(".embed-btn-left").removeClass("disabled"),e==app.bookmarkLength-1?$(".embed-btn-right").addClass("disabled"):$(".embed-btn-right").removeClass("disabled"),r.refreshSize(),r.goToPage(e)},this.setColor=function(e){$(t).css("background-color",e[1]),$(t+" .carousel").css("background-color",e[1]),$(t+" .embed-btn-container").css("background-color",e[1]),$(t+" .builderMobile").css("background-color",e[1]);var n=["#444","#000","#0e3867","#1a3606"],r=["#828282","#828282","#9096a9","#a8b09e"],i=0;$.each(n,function(t){n[t].match(e[0])&&(i=t)}),$(".seriesButton").css("background-color",r[i])},this.setDescriptionView=function(e,t,n){$("#seriesTitle").html(e),$("#seriesDescription").html(t),$("#seriesViewLabel").find(".seriesLabel").html(parseInt(app.bookmarkIndex)+1),n&&(location.hash="description")}}}),define("storymaps/swipe/ui/MapSwipe",["dojo/dnd/move","esri/widgets","dijit/registry","dojo/has","esri/geometry/Point","esri/geometry/Extent","esri/geometry/screenUtils","dojo/on","dojo/_base/connect","dojo/query","dojo/dom","dojo/dom-style","dojo/mouse"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){return function(h){function C(){$(".esriPopup").css("visibility","hidden"),$(".esriPopup .title").css("display","none"),$(".esriPopup .prev").css("display","none"),$(".esriPopup .next").css("display","none"),$(".esriPopup .maximize").css("display","none"),$(".esriPopup .title").after('<div class="swipeTitle"></div>')}function k(){$("#resizeWrapper").css("width","0%"),$("#mainMap1").css("width","0%"),$("#swipeImg").css("top",$("#mainMap0").height()/2-26+"px"),$("#swipeImg").show();var t=f(h+" #sliderDiv"),n=new e.parentConstrainedMoveable(t[0],{area:"mainMap0",within:!0});u(t,"mouseover",function(){$("#swipeImg").css("background","url(resources/icons/sprite-icons.png)-536px -1152px")}),u(t,"mouseout",function(){$("#swipeImg").css("background","url(resources/icons/sprite-icons.png)-536px -1254px")}),app.sliderDiv=n,r("touch")&&($(".moveable").addClass("touch"),$("#swipeImg").addClass("touch")),n.node.style.height=p[0].height+"px",n.node.style.top="0px",n.node.style.left=$("#mainMap0").width()/2+b+"px",L(n)}function L(e){var t=null,n=e.node.offsetLeft;O(n),u(p[0],"click",function(e){$(".esriPopup").css("visibility","hidden"),t=e,$("#swipeImg").fadeOut(),x="open"}),u(app.popup[0],"set-features",function(){setTimeout(function(){M(t,0)})}),a.connect(e,"onMove",function(r){var i=parseInt(e.node.offsetLeft);if(i<=0||i>=p[0].width)return;n=i,O(n),M(t)}),$(window).resize(function(){e.node.style.height=p[0].height+"px"}),a.connect(e,"onMoveStart",function(e){$("#swipeImg").fadeOut()}),u(p[0],"pan",function(t){O(e.node.offsetLeft)}),u(p[0],"pan-end",function(e){M(t)});var r=app.mainMap.getLayer(d[0]).type=="Feature Layer";if(r){u(p[0],"pan-end",function(t){O(e.node.offsetLeft)});var i=app.mainMap.getLayer(d[0]);if(i._collection)dojo.connect(app.mainMap,"onZoomEnd",function(){O(e.node.offsetLeft)});else{var s=i._params&&i._params.opacity?i._params.opacity:1,o=!1;u(app.mainMap,"zoom-start",function(){o=!0}),u(app.mainMap.getLayer(d[0]),"update-start",function(){o&&app.mainMap.getLayer(d[0]).setOpacity(0)}),u(app.mainMap.getLayer(d[0]),"update-end",function(){o&&app.mainMap.getLayer(d[0]).setOpacity(s),O(e.node.offsetLeft),o=!1})}}p[0].navigationMode==="css-transforms"&&u(p[0],"pan",function(t){O(e.node.offsetLeft)})}function A(e){var t=app.mainMap.toMap(new i(0,app.mainMap.height,app.mainMap.spatialReference)),n=app.mainMap.toMap(new i(e,0,app.mainMap.spatialReference)),r=new s(t.x,t.y,n.x,n.y,app.mainMap.spatialReference);$.each(p[0].getLayer(d[0]).graphics,function(e,t){var n=t.geometry.type=="point"?t.geometry:t.geometry.getExtent().getCenter();r.contains(n)?t.show():t.hide()})}function O(e){var t=l.byId("sliderDiv"),n;if(p[0].getLayer(d[0]).renderer&&p[0].getLayer(d[0]).renderer.type=="heatmap"){if(!p[0].getLayer(d[0]).visibleAtMapScale)return;n=p[0].getLayer(d[0])._heatmapManager.imageLayer._div}else n=p[0].getLayer(d[0])._div;if(t!=null){offset_left=parseFloat(t.style.left),offset_top=parseFloat(t.style.top);var r,i,s,o;offset_left>0?(r=parseFloat(e)-Math.abs(offset_left),i=offset_left):offset_left<0?(i=0,r=parseFloat(e)+Math.abs(offset_left)):(i=0,r=parseFloat(e)),offset_top>0?(s=-offset_top,o=p[0].height-offset_top):offset_top<0?(s=0,o=p[0].height+Math.abs(offset_top)):(s=0,o=p[0].height);var u=app.mainMap.getLayer(d[0]).type=="Feature Layer"&&app.mainMap.getLayer(d[0]).renderer.type!="heatmap";if(u){r=app.mainMap.width;var a=app.mainMap.getLayer(d[0])._div,f,c;if($(a.parent.rawNode).css("transform")){f=$(a.parent.rawNode).css("transform"),c=f.match(/-?[\d\.]+/g);if(f&&c)i+=-parseInt(c[4]),s+=-parseInt(c[5]);else if(n.getTransform()){var h=n.getTransform();h.hasOwnProperty("dx")&&(i+=-h.dx),f.hasOwnProperty("dy")&&(s+=-h.dy)}}n.setClip({x:i,y:s,width:r,height:o}),v&&app.mainMap.getLayer("labels")._div.setClip({x:i,y:s,width:r,height:o});return}var m=dojo.position(dojo.byId("sliderDiv")),g=dojo.position(n),y=m.x-g.x,b=m.y-g.y;i=y,o=m.h+(m.y-g.y),r=parseInt(app.mainMap.width)+Math.abs(g.x),s=b;var w="rect("+s+"px, "+r+"px, "+o+"px, "+i+"px)";n.style.clip=w}}function M(e){if(!e||!app.popup[0]||x=="closed"||!y||$(".esriPopup .arcgisSearch").length)return;var t=o.toScreenGeometry(app.mainMap.extent,app.mainMap.width,app.mainMap.height,e.mapPoint),n=app.mainMap.getLayer(d[0]).type=="Feature Layer",r=parseInt(l.byId("sliderDiv").style.left.split("px",1)),i=t.x>r,s=d[0],a=i?0:1;w=e;if(!app.popup[0].features)return;var c=!1;for(var h=0;h<app.popup[0].features.length;h++){var p=app.popup[0].features[h],v=p._graphicsLayer?p._graphicsLayer.id:p._layer.id;(v.charAt(v.length-2)==="_"||v.charAt(v.length-3)==="_")&&!n&&(v=v.split("_").slice(0,-1).join("_"));if(i&&v==s||!i&&v!=s){c=!0,$(".esriPopup .titlePane").css("backgroundColor","#"+m[a]),$(".esriPopup .swipeTitle").html(g[a]||"&nbsp;"),$(".esriPopup .swipeTitle").append('<div id="popup0" class="closePopup"><a ><i class="icon-remove icon-white"></i></a></div>'),$(".esriPopup").css("visibility","visible"),u(f(".titleButton.close"),"click",function(){x="closed"}),n&&app.popup[0]._highlighted._graphicsLayer.graphics[0].show(),app.popup[0].select(h),x="open";break}}c||($(".esriPopup").css("visibility","hidden"),app.popup[0]._highlighted._graphicsLayer.graphics[0].hide());var b=!1,E=!1;for(var h=0;h<app.popup[0].features.length;h++){var p=app.popup[0].features[h],v=p._graphicsLayer?p._graphicsLayer.id:p._layer.id,S=v.slice(0,-(v.length-v.lastIndexOf("_")));!b&&v!=s&&S!=s&&(b=!0,R(1,p)),!E&&(v==s||S==s)&&(E=!0,R(0,p));if(b&&E)break}}function _(){$("#swipeImg1").css("background","url(resources/icons/sprite-icons.png)-536px -1152px"),$("#swipeImg2").css("background","url(resources/icons/sprite-icons.png)-536px -1152px")}function D(){$("#swipeImg1").css("background","url(resources/icons/sprite-icons.png)-536px -1254px"),$("#swipeImg2").css("background","url(resources/icons/sprite-icons.png)-536px -1254px")}function P(){$("#resizeWrapper").resizable({handles:"e",containement:"parent",minWidth:2}),r("touch")&&($(".ui-resizable-e").addClass("touch"),$("#swipeImg").addClass("touch")),$(".ui-resizable-e").append("<div id='swipeImg2'></div>"),$(".ui-resizable-e").hover(_,D),$("#mainMap1").css("width","100%"),$(".esriPopup").css("zIndex","99");var e=null;H(),u(p[0],"click",function(t){app.popup[0].hide(),app.popup[1].hide();var n=t;t.target.e_graphic&&t.target.e_graphic.geometry.type=="point"&&(n.screenPoint=app.maps[0].toScreen(t.target.e_graphic.geometry)),$("#swipeImg1").fadeOut(),$("#swipeImg2").fadeOut(),e=t,x="open";if(app.popup[0].isShowing==1)return;if(t.val==="other")return;n.val="other",n.graphic=null,p[1].onClick(n)}),u(app.popup[0],"set-features",function(){setTimeout(function(){q(e,0)},0)}),u(p[1],"click",function(t){app.popup[0].hide(),app.popup[1].hide();var n=t;t.target.e_graphic&&t.target.e_graphic.geometry.type=="point"&&(n.screenPoint=app.maps[1].toScreen(t.target.e_graphic.geometry)),e=t,x="open";if(app.popup[1].isShowing==1)return;if(t.val==="other")return;n.val="other",n.graphic=null,p[0].onClick(n,"other")}),u(app.popup[1],"set-features",function(){setTimeout(function(){q(e,1)},0)}),u(p[0],"pan-end",function(e){var t={};if(app.popup[0].isShowing==1)t.x=app.popup[0].domNode.offsetLeft;else{if(app.popup[1].isShowing!=1)return;t.x=app.popup[1].domNode.offsetLeft}q(t)}),u(p[1],"pan-end",function(e){var t={};if(app.popup[0].isShowing==1)t.x=app.popup[0].domNode.offsetLeft;else{if(app.popup[1].isShowing!=1)return;t.x=app.popup[1].domNode.offsetLeft}q(t)}),$(window).resize(function(){var e=null;app.popup[0].isShowing&&(e=app.popup[0].domNode.offsetLeft),app.popup[1].isShowing&&(e=app.popup[1].domNode.offsetLeft),$("#swipeImg1").hide(),$("#swipeImg2").fadeOut(),B({x:e})});var t=$("#mainMap0").find(".esriPopup");t.after($("#mainMap1").find(".esriPopup")),c.set(l.byId("sliderDiv"),"display","none"),I()}function H(){$(".esriPopup .titlePane").eq(0).css("backgroundColor","#"+m[0]),$(".esriPopup .swipeTitle").eq(0).html(g[0]||"&nbsp;"),$(".esriPopup .swipeTitle").eq(0).append('<div id="closePopup0" class="closePopup"><a ><i class="icon-remove icon-white"></i></a></div>'),l.byId("closePopup0")&&u(l.byId("closePopup0"),"click",function(){x="closed",$(".esriPopup").css("visibility","hidden")}),$(".esriPopup .titlePane").eq(1).css("backgroundColor","#"+m[1]),$(".esriPopup .swipeTitle").eq(1).html(g[1]||"&nbsp;"),$(".esriPopup .swipeTitle").eq(1).append('<div id="closePopup1" class="closePopup"><a ><i class="icon-remove icon-white"></i></a></div>'),l.byId("closePopup1")&&u(l.byId("closePopup1"),"click",function(){x="closed",$(".esriPopup").css("visibility","hidden")})}function B(e){$("#mainMap1").css("width",l.byId("mainMap0").clientWidth),$("#mainMap1").css("height",l.byId("mainMap0").clientHeight),p[0]&&p[0].resize(),p[1]&&p[1].resize(),e.x&&q(e)}function j(){if(E==1){E=!1;return}E=!0,p[1].setExtent(p[0].extent)}function F(){if(E==1){E=!1;return}E=!0,p[0].setExtent(p[1].extent)}function I(){$("#mainMap1").css("width",l.byId("mainMap0").clientWidth),$("#resizeWrapper").css("width",$("#mainMap0").width()/2+b),$("#swipeImg1").css("left",$("#mainMap0").width()/2-48+b+"px"),$("#swipeImg1").css("top",$("#mainMap0").height()/2-26+"px"),$("#swipeImg1").show(),$("#swipeImg2").css("top",$("#mainMap0").height()/2-26+"px"),$("#swipeImg2").show(),app.maps[0].resize(!0),app.maps[1].resize(!0),p[0].setExtent(p[1].extent).then(function(){u(p[1],"extent-change",F),u(p[0],"extent-change",j),E=!1})}function q(e,t){if($(".esriPopup .arcgisSearch").length)return;H();if(!e||x=="closed"||!y)return;S=e.pageY?e.mapPoint:S;var n=e.pageX||e.x,r=n>$("#resizeWrapper").width()?0:1;app.popup[r].show(S),app.popup[r?0:1].hide(),$(".esriPopup").css("visibility","hidden"),$(".esriPopup").eq(r).css("visibility","visible"),t!=null&&R(t,(app.popup[t].features||[null])[0])}function R(e,t){t?n.byId("infoView-mobile"+e).set("content",t.getContent()):n.byId("infoView-mobile"+e).set("content",'<div class="noDataMap"><div class="title">'+i18n.swipe.mobileData.noDataMap+"</div></div>"),$("#infoWindowView .noData").hide(),$(".swiper.infoWindowView").css("display","block")}var p=null,d=null,v=null,m=null,g=null,y=!0,b=null,w=null,E=!0,S=null,x=null,T=null,N=null;this.init=function(e,t,n,r,i,s,o){console.log("MapSwipe init",e,t,n,r,i,o),p=e,d=t,v=n,m=r,g=i,b=s,y=o,$("#infoWindowTabImg").css("display","none"),$("#infoWindow").css("display","none"),!y,C(),p.length==1?k():P()},this.updateSettings=function(e,t){if(!p||p.length==0)return;m=e,g=t,p.length==1?w&&M(w):H()},this.reposition=function(e){app.mode=="TWO_LAYERS"?app.sliderDiv&&(app.sliderDiv.node.style.left=$("#mainMap0").width()/2+b+"px",L(app.sliderDiv)):$("#resizeWrapper").css("width",$("#mainMap0").width()/2+b+"px")}}}),define("storymaps/swipe/ui/SpyGlass",["dojo/_base/declare","dojo/_base/connect","dojo/_base/html","dojo/_base/lang","dojo/dnd/move","dojo/has","dojo/dom","dojo/dom-attr","dojo/dom-style","dojo/dom-class","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/registry","esri/geometry/Point","esri/geometry/Extent","esri/geometry/Polygon","esri/config","esri/geometry/webMercatorUtils","esri/geometry/screenUtils","esri/geometry/ScreenPoint","esri/SpatialReference","dojo/on"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){function N(e,t,n){if(!_popup)return;var r=app.popup[e].getSelectedFeature();if(!r){$("#infoWindowTitle").css("backgroundColor","#"+_popupColors[t]),$("#infoWindowTitle").html(_popupTitles[t]||"&nbsp;"),$("#infoWindowContent").html(i18n.swipe.mobileData.noPopup);return}C(r,e,n),n!=0&&($("#infoWindowTitle").css("backgroundColor","#"+_popupColors[t]),$("#infoWindowTitle").html(_popupTitles[t]||"&nbsp;"),x.getInfoWindowState()=="close"&&!x._popupClosedByUser&&x.openInfoWindow())}function C(e,t,n){e?p.byId("infoView-mobile"+t).set("content",e.getContent()):p.byId("infoView-mobile"+t).set("content",'<div class="noDataMap"><div class="title">'+i18n.swipe.mobileData.noDataMap+"</div></div>"),$("#infoWindowView .noData").hide(),$(".swiper.infoWindowView").css("display","block");if(n!=0){$("#infoWindowContent").removeClass("noData");var r=e.getContent();p.byId("infoWindowContent").set("content",r)}}var x=null,T=e([l,c,h],{templateString:"<div></div>",_lensMap:null,_started:!1,_clickPoint:null,_popupColors:null,_popupTitles:null,_popupColors2:[],_popupTitles2:[],_layers:null,_labels:null,_displayedPopupIndex:null,_spyExtent:null,_rightVal:null,_leftVal:null,_topVal:null,_bottomVal:null,_isGraphics:!1,_moving:!1,_popupClosedByUser:!1,_clickOnLens:!1,_popup:!0,_mode:null,startup:function(e,u,f,l,c,h,p,v,m){x=this,this.lensWin="lensWin",$("#lensWin").css("display","block"),a.set(o.byId("sliderDiv"),"display","none"),$("#mapPanel").css("overflowX","hidden"),$(".esriPopup").addClass("hidePopup"),$("#infoWindowTitle").html(i18n.swipe.infoWindow.noFeature),$("#infoWindowContent").html('<div class="noFeature">'+i18n.swipe.infoWindow.noFeatureExplain+"</div>"),_layers=h,_labels=p,_popupColors=f,_popupTitles=l,_mode=c,_popup=m,_popup||$("#infoWindow").addClass("disable"),x.lensCenterOffset=v,x._isGraphics=!1,app.mainMap.getLayer(_layers[0])&&(x._isGraphics=app.mainMap.getLayer(_layers[0]).type=="Feature Layer"&&app.mainMap.getLayer(_layers[0]).renderer.type!="heatmap");var b=function(){var e=n.coords("mainMap0"),t={};return t.t=0,t.l=0,t.w=e.l+e.w,t.h=e.h+e.t,t},w=function(e){setTimeout(function(){if(x._moving){x._moving=!1;return}if(!_popup){app.popup[1]&&app.popup[1]._highlighted._graphicsLayer.graphics[0].hide();return}var t=parseInt($("#seriesPanel").css("height"));$("#seriesPanel").css("display")=="none"&&(t=0);var n=e.pageX,r=e.pageY-$("#header").height()-t;e.x=n,e.y=r,e.screenPoint={x:n,y:r},e.type="click",e.fromLens=!0,e.mapPoint=app.mainMap.toMap(new d(n,r,app.mainMap.spatialReference)),e.graphic=null,app.mainMap.onClick(e,"other"),x._moving=!1},100)},E=function(){var e=parseInt(o.byId("mainMap0").getAttribute("data-zoom"));app.mainMap.setZoom(e+1)};$("#lensTool").click(function(e){var t=this;setTimeout(function(){var n=parseInt($(t).data("double"),10);n>0?$(t).data("double",n-1):w.call(this,e)},300)}).dblclick(function(e){$(this).data("double",2),E.call()});var T=$("#lensTool"),C=!1,k=0,L=0,A=0,O=0;T.on("touchstart mousedown",function(e){e.preventDefault(),A=e.pageX,O=e.pageY,C=!0,setTimeout(function(){k=e.pageX,L=e.pageY,A===k&&!C&&O===L&&w(e.originalEvent)},200)}),T.on("touchend mouseup touchcancel",function(e){e.preventDefault(),C=!1}),T.on("touchmove mousemove",function(e){e.preventDefault()}),S(o.byId("lensWin"),s("mozilla")?"DOMMouseScroll":"mousewheel",function(e){var t=e[s("mozilla")?"detail":"wheelDelta"]*(s("mozilla")?-1:1),n=parseInt(o.byId("mainMap0").getAttribute("data-zoom")),r=s("mozilla")?3:120,i=parseInt(t/r);app.mainMap.setZoom(n+i)}),this.draggableWin=new i.constrainedMoveable(this.lensWin,{handle:this.lensWin,constraints:b,within:!0});var M=130;$("#lensTool").css("width")=="200px"&&(M=100);var _=Math.floor(parseInt($("#mainMap0").css("height"))/2)-M+"px",D=Math.floor(parseInt($("#mainMap0").css("width"))/2)-M+v+"px";a.set(this.lensWin,{top:_,left:D}),S(app.popup[0],"set-features",function(){c=="TWO_WEBMAPS"?(x._clickOnLens||N(0,1),x._displayedPopupIndex=x._clickOnLens?1:0):(x._displayedPopupIndex=0,x._isGraphics?x.clipGraphics():x.clipGlass())}),c=="TWO_WEBMAPS"&&S(app.popup[1],"set-features",function(e){N(1,0,x._clickOnLens?!0:!1)}),S(app.mainMap,"click",function(e){_popup||app.popup[0]._highlighted._graphicsLayer.graphics[0].hide(),x._popupClosedByUser=!1,$(".esriPopup").css("visibility","hidden"),x._clickPoint=e,x._clickOnLens=e.fromLens;var t=e.pageX-$("#lensWin").position().left,n=e.pageY-($("#lensWin").position().top+$("#header").height());e.x=t,e.y=n,e.screenPoint.x=t,e.screenPoint.y=n;if(c=="TWO_WEBMAPS"){var r={};e.target.e_graphic&&e.target.e_graphic.geometry.type=="point"?r.screenPoint=app.maps[1].toScreen(e.target.e_graphic.geometry):r=e,app.maps[1].onClick(r,"other")}}),app.maps[1]&&S(app.maps[1],"click",function(e){$(".esriPopup").css("visibility","hidden")}),S(o.byId("infoWindowTabImg"),"click",x.toggleInfoWindow),t.connect(this.draggableWin,"onMove",function(){x._moving=!0});if(c=="TWO_WEBMAPS"){$("#lensTool").addClass("twoMaps"),g.defaults.map.panDuration=0;var P=function(){var e=y.webMercatorToGeographic(app.maps[0].extent.getCenter());return[parseFloat(e.x.toFixed(3)),parseFloat(e.y.toFixed(3))]}();this._lensMap=app.maps[1],t.connect(this.draggableWin,"onMove",r.hitch(this,this.syncLensExtent)),S(app.maps[0],"pan",r.hitch(this,this.syncLensExtent)),S(app.maps[0],"extent-change",r.hitch(this,this.syncLensExtent)),s("touch")?(t.connect(this.draggableWin,"onMoveStop",r.hitch(this,this.checkLensFeature)),S(app.maps[0],"pan-end",r.hitch(this,this.checkLensFeature))):(t.connect(this.draggableWin,"onMove",r.hitch(this,this.checkLensFeature)),S(app.maps[0],"pan",r.hitch(this,this.checkLensFeature))),(s("safari")||s("ie")==8||s("agent-ios")||s("agent-android"))&&$("#lensMapNode, #lensTool").addClass("safariFix"),r.hitch(this,this.syncLensExtent())}else $("#lensTool").addClass("twoLayers"),x._isGraphics?t.connect(this.draggableWin,"onMove",r.hitch(this,this.clipGraphics)):(t.connect(this.draggableWin,"onMove",r.hitch(this,this.clipGlass)),S(app.map,"pan",r.hitch(this,function(){this.clipGlass("pan")})),s("touch")&&(t.connect(this.draggableWin,"onMoveStop",r.hitch(this,this.clipGlass)),S(app.map,"pan-end",r.hitch(this,this.clipGlass)))),S(app.map,"pan",r.hitch(this,this.clipGraphics)),x._isGraphics&&S(app.map,"zoom-end",r.hitch(this,this.clipGraphics)),$(window).resize(function(){x._isGraphics?this.clipGraphics:x.clipGlass()}),x._isGraphics?setTimeout(this.clipGraphics,1500):setTimeout(this.clipGlass,500),$("#lensWin").css({borderRadius:0});x._isGraphics&&S(app.map,"pan-end",r.hitch(this,this.clipGraphics)),this._started=!0},reposition:function(e){if(x&&x.lensCenterOffset){var t=$("#lensTool").css("width")=="200px"?100:130,n=Math.floor(parseInt($("#mainMap0").css("width"))/2)-t+x.lensCenterOffset;$("#lensWin").css({left:n})}},clipGraphics:function(){if(!x._isGraphics||app.mode=="TWO_WEBMAPS")return;var e=$("#lensWin"),t=parseFloat(e.css("left")),n=parseInt($("#lensWin").css("width")),r=parseFloat(e.css("top")),i=parseInt($("#lensWin").css("height")),s,s=app.mainMap.getLayer(_layers[0])._div,o,u;if($(s.parent.rawNode).css("transform")){o=$(s.parent.rawNode).css("transform"),u=o.match(/-?[\d\.]+/g);if(o&&u)t+=-parseInt(u[4]),r+=-parseInt(u[5]);else if(s.getTransform()){var a=s.getTransform();a.hasOwnProperty("dx")&&(t+=-a.dx),o.hasOwnProperty("dy")&&(r+=-a.dy)}}s.setClip({x:t+9,y:r+9,width:n-18,height:i-18}),_labels&&app.map.getLayer("labels")._div.setClip({x:t+9,y:r+9,width:n-18,height:i-18}),x.calculateSpyExtent()},syncLensExtent:function(){var e=n.coords(x.lensWin),t=app.mainMap.toMap(new d(e.l,e.t+400,app.mainMap.spatialReference)),r=app.mainMap.toMap(new d(e.l+400,e.t,app.mainMap.spatialReference));_spyExtent=new v(t.x,t.y,r.x,r.y,app.mainMap.spatialReference),x._lensMap.setExtent(_spyExtent);if($("#lensTool").css("width")=="200px")return},checkLensFeature:function(){if(!_popup)return;var e=400,t=$("#lensTool").width(),n=new d(_spyExtent.xmin+(_spyExtent.xmax-_spyExtent.xmin)/e*t/2,_spyExtent.ymax+(_spyExtent.ymin-_spyExtent.ymax)/e*t/2,_spyExtent.spatialReference),r=(_spyExtent.xmax-_spyExtent.xmin)/(e/t)/2,i=[];for(var s=1;s<31;s++){var o=s*12*Math.PI/180,u=n.x+r*Math.cos(o),a=n.y+r*Math.sin(o);i.push([u,a])}i.push(i[0]);var f=new m(new E(app.maps[0].spatialReference));f.addRing(i),x._clickPoint&&(f.contains(x._clickPoint.mapPoint)?N(1,0):N(0,1))},clipGlass:function(e){var t=$("#lensWin"),n,r=!1;if(app.mainMap.getLayer(_layers[0]).renderer&&app.mainMap.getLayer(_layers[0]).renderer.type=="heatmap"){r=!0;if(!app.mainMap.getLayer(_layers[0]).visibleAtMapScale)return;n=app.mainMap.getLayer(_layers[0])._heatmapManager.imageLayer._div.children[0]}else n=app.mainMap.getLayer(_layers[0])._div;if(t!=null){_leftVal=parseFloat(t.css("left")),_topVal=parseFloat(t.css("top")),_rightVal=_leftVal+parseInt($("#lensWin").css("width")),_bottomVal=_topVal+parseInt($("#lensWin").css("height"));var i=$("#lensWin").position(),s=r?$(n).offsetParent()[0]:$(n).position(),o=r?s._left:s.left,u=r?s._top:s.top,a=i.left-o,f=i.top-u,l=f+9,c=f+252,h=f+7,p=f+193;$("#lensTool").css("width")=="200px"?(_leftVal=a+7,_rightVal=a+194,_topVal=h,_bottomVal=p):(_leftVal=a+9,_rightVal=a+252,_topVal=l,_bottomVal=c);var d="rect("+_topVal+"px, "+_rightVal+"px, "+_bottomVal+"px, "+_leftVal+"px)";n.style.clip=d,x.calculateSpyExtent()}},calculateSpyExtent:function(e){var t=app.map.extent,n=app.map.width,r=app.map.height;if(x._isGraphics){var i=$("#lensWin");i!=null&&(_leftVal=parseFloat(i.css("left")),_rightVal=_leftVal+parseInt($("#lensWin").css("width")),_topVal=parseFloat(i.css("top")),_bottomVal=_topVal+parseInt($("#lensWin").css("height")),$("#lensTool").css("width")=="200px"?(_leftVal+=6,_rightVal+=-6,_topVal+=6,_bottomVal+=-6):(_leftVal+=9,_rightVal+=-9,_topVal+=9,_bottomVal+=-9))}var s=new w(_rightVal,_topVal),o=new w(_leftVal,_bottomVal),u=b.toMapGeometry(t,n,r,s),a=b.toMapGeometry(t,n,r,o);spyExtent=new v(a.x,a.y,u.x,u.y,new E(app.map.spatialReference));var f=null;spyExtent=new v(a.x,a.y,u.x,u.y,new E(app.map.spatialReference)),x._clickPoint?x.checkSelectedFeature(spyExtent):setTimeout(function(){x.checkSelectedFeature(spyExtent)},0)},hideGraphics:function(e){$.each(app.map.getLayer(_layers[0]).graphics,function(t,n){var r=n.geometry.type=="point"?n.geometry:n.geometry.getExtent().getCenter();e.contains(r)?n.show():n.hide()})},checkSelectedFeature:function(e){if(!_popup||!app.popup[0].features)return;e=e;if(x._clickPoint!=null&&app.popup[0].features){var t=e.contains(x._clickPoint.mapPoint),n=_layers[0];colorTitleIndex=t?0:1;for(var r=0;r<app.popup[0].features.length;r++){var i=app.popup[0].features[r],s=i._graphicsLayer?i._graphicsLayer.id:i._layer.id;(s.charAt(s.length-2)==="_"||s.charAt(s.length-3)==="_")&&!x._isGraphics&&(s=s.split("_").slice(0,-1).join("_"));if(!t&&s==n||t&&s!=n){var i=app.popup[0].features[r];p.byId("infoView-mobile1").set("content",i.getContent()),$("#infoWindowView .noData").hide(),$(".swiper.infoWindowView").css("display","block"),app.popup[0]._highlighted._graphicsLayer.graphics[0].hide();break}}for(var r=0;r<app.popup[0].features.length;r++){var i=app.popup[0].features[r],s=i._graphicsLayer?i._graphicsLayer.id:i._layer.id;(s.charAt(s.length-2)==="_"||s.charAt(s.length-3)==="_")&&!x._isGraphics&&(s=s.split("_").slice(0,-1).join("_"));if(t&&s==n||!t&&s!=n){app.popup[0].select(r),N(0,colorTitleIndex),x._isGraphics&&app.popup[0]._highlighted._graphicsLayer.graphics[0].show();break}}x._displayedPopupIndex=colorTitleIndex}},toggleInfoWindow:function(){x.getInfoWindowState()=="open"?x.closeInfoWindow():x.openInfoWindow(),x._popupClosedByUser=!x._popupClosedByUser},getInfoWindowState:function(){return $("#infoWindowTabImg").hasClass("open")?"open":"close"},closeInfoWindow:function(){if($("#infoWindow").css("right")=="-260px")return;x.infoWindowSlide("in"),f.remove("infoWindowTabImg","closeImg"),$("#infoWindowTabImg").hasClass("open")&&$("#infoWindowTabImg").removeClass("open")},openInfoWindow:function(){x.infoWindowSlide("out"),f.add("infoWindowTabImg","closeImg"),$("#infoWindowTabImg").hasClass("open")||$("#infoWindowTabImg").addClass("open")},infoWindowSlide:function(e){$("#infoWindow").animate({right:e=="in"?-240:3},{duration:1e3})},updateSettings:function(e,t){if(!this._started)return;if(this._displayedPopupIndex==null)return;$("#infoWindowTitle").css("backgroundColor","#"+_popupColors[this._displayedPopupIndex]),$("#infoWindowTitle").html(_popupTitles[this._displayedPopupIndex]||"&nbsp;")}});return T}),define("storymaps/swipe/ui/desktop/SeriesPanel",["dojo/has","dojo/topic","esri/geometry/Extent","esri/SpatialReference","storymaps/swipe/core/WebApplicationData","dojo/on","dojo/_base/lang"],function(e,t,n,r,i,s,o){return function(u,a){function c(e){var t=1,n=s(app.mainMap,"extent-change",function(r){r&&r.delta&&(r.delta.x||r.delta.y)&&(t==e&&($(".series-extentSave").removeAttr("disabled"),n.remove()),t++)})}function h(){var e=f.length<=1;$("#seriesControls .series-discard").attr("disabled",e),$("#seriesControls .series-discard").attr("title",e?i18n.swipe.seriesPanel.discardDisabled:"")}function p(){setTimeout(function(){$.each($(".seriesLabel"),function(e,t){$(t).html(e+1)});var e=$("#seriesPanel").find($(".seriesButton")),n=[];$.each($(e),function(e,t){var r=$(t).data("bookmarkid");$(".seriesButton").eq(e).data("original-title",f[r].name),$(".seriesButton").eq(e).data("bookmarkid",e);var i=$.grep(f,function(e){e.indexId==r&&n.push(e)})}),i.setSeriesBookmarks(n),f=n,t.publish("BUILDER_INCREMENT_COUNTER")},500)}var f=null,l=this;this.started=!1,this.init=function(t,r){if($(u).height()=="35")return;$(u).height("35px"),this.setColor(r),f=t,app.bookmarkLength=t.length,f.length||($.each(app.mapResponse,function(e,t){t.itemInfo.itemData.bookmarks&&t.itemInfo.itemData.bookmarks.length&&$.each(t.itemInfo.itemData.bookmarks,function(e,t){var r=o.clone(t);r.extent=new n(r.extent),f.push(r)})}),f.length||f.push({name:i18n.swipe.seriesPanel.title,extent:app.mainMap._params.extent,description:i18n.swipe.seriesPanel.descr}));if(f)for(var i=0;i<f.length;i++){f[i].indexId=i;var c=f[i].name;c=="<br>"&&(c="");var d=document.createElement("DIV");d.innerHTML=c;var v=d.textContent||d.innerText||"";$("#seriesNav").append('<div id="series_'+i+'" class="seriesButton" data-bookmarkid = '+i+' data-toggle="tooltip" data-placement="bottom" title data-original-title="'+v+'"><p class="seriesLabel"> '+(i+1)+"</div>"),e("touch")||$("#series_"+i).tooltip()}$("#series_0").addClass("seriesButton selected"),$(".seriesButton").fastClick(function(){l.showSeries(this)}),$("#descriptionTitle").addClass("series"),$("#descriptionContent").addClass("series");if(a){$("#seriesBuilder").append('<div id="addSeries" class="addSeriesButton" data-toggle="tooltip" data-placement="bottom" title data-original-title="Add a bookmark"><p class="addSeriesLabel"> +</div>'),$("#addSeries").fastClick(this.addSeries),$("#addSeries").tooltip(),$("#seriesControls").addClass("series"),$("#descriptionContent").addClass("builder"),$("#descriptionTitle").addClass("builder"),$("#seriesNav").sortable({stop:p}),$("#seriesControls .series-discard").html(i18n.swipe.seriesPanel.discard),$("#seriesControls .series-extentSave").html(i18n.swipe.seriesPanel.saveExtent),$(".series-discard").fastClick(l.discardBookmark),$(".series-extentSave").fastClick(l.saveBookmarkExtent);var m=new nicEditor({buttonList:["fontSize","fontFamily","bold","italic","underline","left","center","right","ul","link","html"]});$("#textEditPanel").addClass("builder"),m.setPanel("textEditPanel"),m.addInstance("descriptionTitle"),m.addInstance("descriptionContentInner"),m.addEvent("focus",function(){m.addEvent("blur",function(){l.checkText()})}),$(".nicEdit-main").parent().css("width","342px"),$(".nicEdit-main").css("width","330px"),$(".nicEdit-main").parent().css("border","none"),s($(" .nicEdit-panel").children().last().children().children().children(),"click",function(){$("#href").siblings()[0]&&($("#href").siblings()[0].addClass("hrefLabel"),$("#href").addClass("href")),$("#title").siblings()[0]&&$("#title").siblings()[0].addClass("hrefLabel")}),$(".series-extentSave").attr("disabled","disabled"),h(),l.started=!0}else $("#descriptionTitle").addClass("viewer");var g=!0;t?l.renderText(t[0],g):l.renderText(null)},this.appIsReady=function(){a&&c(1)},this.setColor=function(e){$(u).css("background-color",e)},this.showSeries=function(e){$(u).find(".seriesButton").removeClass("selected");var n=$(e).data("bookmarkid")!=null&&$(e).data("bookmarkid")>-1?$(e).data("bookmarkid"):e;app.bookmarkIndex=n>-1?n:app.bookmarkIndex,l.renderText(f[app.bookmarkIndex]);var r=$(u).find("[data-bookmarkid='"+app.bookmarkIndex+"']");$(r).addClass("selected"),$(".series-extentSave").attr("disabled","disabled"),c(2),h(),setTimeout(function(){t.publish("CORE_UPDATE_EXTENT",f[app.bookmarkIndex].extent)},0),$("#descriptionContent").scrollTop(0),app.autoplay&&app.autoplay.onNavigationEvent(app.bookmarkIndex)},this.addSeries=function(){var e=$(u).find(".seriesButton").length;app.bookmarkIndex=e,$("#seriesNav").append('<div id="series_'+e+'" class="seriesButton" data-bookmarkid = '+e+' data-toggle="tooltip" data-placement="bottom" title data-original-title="Add Title"><p class="seriesLabel"> '+(e+1)+"</div>"),$("#series"+e).tooltip(),$(".seriesButton").removeClass("selected"),$(".seriesButton").eq(e).addClass("selected"),$(".seriesButton").eq(e).fastClick(function(){l.showSeries(this)});var n=app.mainMap.extent,r={name:"",extent:n,description:"",indexId:e};f.push(r);var o=[],a={name:i18n.swipe.seriesPanel.title,extent:n,description:i18n.swipe.seriesPanel.descr};o.push(a),l.renderText(o[0]),$(".series-extentSave").attr("disabled","disabled"),s.once(app.mainMap,"extent-change",function(){$(".series-extentSave").removeAttr("disabled")}),h(),i.setSeriesBookmarks(f),app.mobileCarousel.needUpdate=!0,t.publish("BUILDER_INCREMENT_COUNTER")},this.discardBookmark=function(){var e=$(".seriesButton.selected"),n=$(e).data("bookmarkid"),r=$(".seriesButton.selected").index();f.splice(n,1),$(".seriesButton").eq(r).remove();for(var s=0;s<$("#seriesNav").find(".seriesButton").length;s++){f[s].indexId=s,$(".seriesButton").eq(s).attr("id","series_"+s),$(".seriesButton").eq(s).data("bookmarkid",s),$(".seriesButton").eq(s).data("original-title",f[s].name);var o=$(".seriesButton").eq(s).find(".seriesLabel");o.text(s+1)}r==$(u).find(".seriesButton").length&&(r-=1),i.setSeriesBookmarks(f),l.showSeries($(".seriesButton").eq(r)),app.mobileCarousel.needUpdate=!0,t.publish("BUILDER_INCREMENT_COUNTER")},this.saveBookmarkExtent=function(){var e=$(".seriesButton").index($(".selected")),n=app.mainMap.extent;f[e].extent=n,i.setSeriesBookmarks(f),t.publish("BUILDER_INCREMENT_COUNTER"),$(".series-extentSave").attr("disabled","disabled")},this.renderText=function(e,t){if(!e&&a){nicEditors.findEditor("descriptionTitle").nicInstances[0].setContent(""),nicEditors.findEditor("descriptionContentInner").nicInstances[1].setContent("");return}a&&(nicEditors.findEditor("descriptionTitle").nicInstances[0].setContent(e.name||""),nicEditors.findEditor("descriptionContentInner").nicInstances[1].setContent(e.description||"")),e?($("#descriptionTitle").html(e.name),$("#descriptionContentInner").html(e.description)):($("#descriptionTitle").html(""),$("#descriptionContentInner").html(""));if($("#legendPanel").css("display")=="none"){$("#descriptionPanel").addClass("single"),$("#sidePanel").removeClass("single"),$("#sidePanel").addClass("singleSeries"),$("#sidePanel").css("height","auto"),parseInt($("#sidePanel").css("height"))>.6*parseInt(app.mainMap.height)?$("#sidePanel").css("height","60%"):$("#sidePanel").css("height","auto");var n=parseInt($("#sidePanel").css("height")),r=$("#sidePanelUnderTabImg").hasClass("open")?"rect(0px 355px "+parseInt(n+45)+"px 0px)":"rect("+n+"px 355px "+parseInt(n+45)+"px 0px)";$("#sidePanel").css("clip",r)}var i=parseInt($("#sidePanel").css("height")),s=parseInt($("#header").css("height"))+parseInt($("#seriesPanel").css("height"));i-=parseInt($("#seriesPanel").css("height")),i-=parseInt(s);var o=$("#sidePanelUnderTabImg").hasClass("open")?s:-i;$("#sidePanel").css({top:o}),navigator.userAgent.match(/iPad/i)&&setTimeout(function(){descScroll.refresh()},0),l.sizeTextDescription(t)},this.checkText=function(){if($("#headerMobile").css("display")=="block")return;var e=$(".seriesButton").index($(".selected"));if(f[e].description==nicEditors.findEditor("descriptionContentInner").nicInstances[1].getContent()&&f[e].name==nicEditors.findEditor("descriptionTitle").nicInstances[0].getContent())return;f[e].name=nicEditors.findEditor("descriptionTitle").nicInstances[0].getContent(),f[e].description=nicEditors.findEditor("descriptionContentInner").nicInstances[1].getContent(),f[e].name==i18n.swipe.seriesPanel.title&&(f[e].name=""),f[e].description==i18n.swipe.seriesPanel.descr&&(f[e].description=""),$(".seriesButton").eq(e).attr("data-original-title",f[e].name),i.setSeriesBookmarks(f),t.publish("BUILDER_INCREMENT_COUNTER"),app.mobileCarousel.update(f,i.getColors());var n=!1;app.mobileCarousel.setDescriptionView(f[e].name,f[e].description,n)},this.sizeTextDescription=function(e){var t=app.isInBuilderMode?$("#seriesControls").height()+10:0;setTimeout(function(){$("#descriptionContent").height("auto"),$("#descriptionContent").css("margin-bottom",t)},e?5e3:0),setTimeout(function(){$("#descriptionContent").height()>$("#descriptionPanel").height()-$("#descriptionTitle").height()-2*t-30&&$("#descriptionContent").height($("#descriptionPanel").height()-$("#descriptionTitle").height()-2*t-30)},e?5e3:0);var n=parseInt($("#sidePanel").css("height")),r=parseInt($("#header").css("height"))+parseInt($("#seriesPanel").css("height"));n-=parseInt($("#seriesPanel").css("height")),n-=parseInt($("#header").css("height"));var i=$("#sidePanelUnderTabImg").hasClass("open")?r:-n;$("#sidePanel").css({top:i})}}}),define("storymaps/swipe/core/MainView",["dojo/dom-construct","dojo/_base/window","dojo/_base/connect","storymaps/swipe/core/WebApplicationData","esri/geometry/Extent","esri/geometry/webMercatorUtils","storymaps/swipe/ui/desktop/SidePanel","storymaps/ui/autoplay/Autoplay","storymaps/swipe/ui/mobile/MobileSwipeView","storymaps/swipe/ui/mobile/Carousel","storymaps/swipe/ui/MapSwipe","storymaps/swipe/ui/SpyGlass","storymaps/swipe/ui/desktop/SeriesPanel","storymaps/swipe/core/SwipeHelper","storymaps/utils/Helper","dojo/has","esri/config","dojo/topic","dojo/on","dojo/Deferred","dojo/DeferredList","esri/dijit/Search","esri/tasks/locator","esri/request","dojo/_base/lang"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){return function(){function T(e){app.bookmarkIndex=e,app.seriesPanel.showSeries(e);if(!$("#footerMobile").is(":visible"))return}function N(){if(APPCFG.HELPER_SERVICES.geocode.length){var e=[];$.each(APPCFG.HELPER_SERVICES.geocode,function(t,n){var r=x({url:n.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});e.push(r)});var t=new w(e);t.then(function(e){var t=[];$.each(e,function(e,n){if(!n[0])return;if(!n[1]||!n[1].singleLineAddressField)return;var r={};r.singleLineFieldName=n[1].singleLineAddressField.name;var i=new S(APPCFG.HELPER_SERVICES.geocode[e].url);r.name=APPCFG.HELPER_SERVICES.geocode[e].name?APPCFG.HELPER_SERVICES.geocode[e].name:n[1].name,r.locator=i,t.push(r)});var n=r.getLayout()=="swipe"?!0:!1;if(t.length){app.search=new E({map:app.mainMap,enableInfoWindow:n,sources:[]},"locationSearch"),y(app.search,"select-result",function(){$(".esriPopup .title").show(),$(".swipeTitle").css("display","none"),setTimeout(function(){$(".titlePane").css("background-color","#444")},0)});var i=app.search.get("sources");$.each(t,function(e,t){i.push(t)}),app.search.set("sources",i),app.search.startup()}})}}var n=null,i=this;this.init=function(t){n=t;if(app.isInBuilderMode&&v("ie")&&v("ie")<9)return n.initError("noBuilderIE8"),!1;app.mapSwipe=new l("#mapPanel");var i=e.create("div",{id:"lensWidget"},"mapPanel");app.spyGlass=new c(r.getWebmaps()[1],i),app.sidePanel=new o($("#sidePanel"),app.isInBuilderMode),app.seriesPanel=new h("#seriesPanel",app.isInBuilderMode),app.mobileInfoWindowView=new a("#infoWindowView","#infoWindowViewCarousel"),app.mobileLegendView=new a("#legendView","#legendViewCarousel"),app.mobileCarousel=new f("#footerMobile",app.isInBuilderMode);var s=d.getUrlParams();return!app.isInBuilderMode&&s.autoplay!==undefined&&s.autoplay!=="false"&&(app.bookmarkIndex=0,app.autoplay=new u($("#autoplay"),function(){var e=0,t=r.getSeriesBookmarks().length;return t||$.each(app.mapResponse,function(e,n){n.itemInfo.itemData.bookmarks&&n.itemInfo.itemData.bookmarks.length&&$.each(n.itemInfo.itemData.bookmarks,function(e,n){t++})}),app.bookmarkIndex!=t-1&&(e=app.bookmarkIndex+1),setTimeout(function(){T(e)},50),e})),g.subscribe("CORE_UPDATE_EXTENT",function(e){app.mainMap.setExtent(e,!0)}),$(document).bind("touchmove",function(e){!$(e.target).parents("#legendPanel").length&&!$(e.target).parents("#descriptionPanel").length&&!$(e.target).parents("#seriesTextView").length&&!$(e.target).parents("#infoWindowView").length&&!$(e.target).parents("#legendView").length&&!$(e.target).hasClass("subtitle")&&e.preventDefault()}),!0},this.webmapLoaded=function(){var e=r.getColors(),t=r.getDescription(),s=r.getLegend(),o=r.getSidePanelDescription(d.getAppID()),u=r.getLayout(),a=app.mode;loadingIndicator.setMessage(i18n.viewer.loading.step3),t==null&&(t=!0),s==null&&(s=!0),!o&&app.isInBuilderMode&&(o=i18n.swipe.swipeSidePanel.editMe);var f=d.getUrlParams();app.sidePanel.init(o,e[1],e[0],t,s,r.getLayers(),r.getSeries()||configOptions.series,u,a,APPCFG.EMBED||f.embed||f.embed==="");if(v("ie")==undefined||v("ie")>8)r.getPopup()?(app.mobileInfoWindowView.init([$("#infoView-mobile1"),$("#infoView-mobile0")],e[1]),app.isPopup=!0):$("#rightViewLink").css("display","none"),r.getLegend()?(app.mobileLegendView.init(["<div id='legendView2'></div>","<div id='legendView1'></div>"],e[1]),$("#legendView1").parent().css("overflow-y","auto"),$("#legendView2").parent().css("overflow-y","auto")):$("#leftViewLink").css("display","none");var l=null;if(r.getSeries()||configOptions.series&&configOptions.bookmarks&&configOptions.bookmarks.length){var c=r.getSeriesBookmarks();l=c&&c.length?c[0].extent:null,app.seriesPanel.init(c,e[0]),$("#descriptionTitle").addClass("series"),$("#descriptionContent").addClass("series");if(v("ie")==undefined||v("ie")>8)app.mobileCarousel.init(c,e),app.mobileCarousel.setSelectedPoint(0),dojo.subscribe("CAROUSEL_SWIPE",T),$(".embed-btn-left").on("click",function(){if($(".embed-btn-left").hasClass("disabled"))return;app.mobileCarousel.setSelectedPoint(app.bookmarkIndex-1)}),$(".embed-btn-right").on("click",function(){if($(".embed-btn-right").hasClass("disabled"))return;app.mobileCarousel.setSelectedPoint(app.bookmarkIndex+1)})}else $("#descriptionTitle").removeClass("series"),$("#descriptionContent").removeClass("series");r.getLocationSearch()&&N(),$(window).resize(),i.setMapExtent(l||d.getWebMapExtentFromItem(app.data.getWebMapItem().item)).then(function(){if(app.maps.length==2&&app.maps[0].spatialReference.wkid!=app.maps[1].spatialReference.wkid){n.appInitComplete(),$("#projectionPopup").modal();return}r.getLayout()=="spyglass"?app.spyGlass.startup(r.getWebmaps()[1],$("#lensWidget"),r.getPopupColors(),r.getPopupTitles(),app.mode,r.getLayers(),r.getLabels(),!p.isOnMobileView()&&(t||s)?175:0,r.getPopup()):app.mapSwipe.init(app.mode=="TWO_LAYERS"?[app.map]:app.maps,r.getLayers(),r.getLabels(),r.getPopupColors(),r.getPopupTitles(),!p.isOnMobileView()&&(t||s)?175:0,r.getPopup());if(app.mode=="TWO_WEBMAPS"){var e=r.getLayout()=="swipe"?0:1,i=!1;y.once(app.maps[e],"extent-change",function(){setTimeout(function(){i||(n.appInitComplete(),i=!0)},r.getLayout()=="spyglass"?3e3:1e3)}),setTimeout(function(){i||(n.appInitComplete(),i=!0)},3500)}else setTimeout(function(){n.appInitComplete()},r.getLayout()=="spyglass"?2e3:500)})},this.appInitComplete=function(){console.log("mainView.appInitComplete"),n.displayApp(),g.publish("SWIPE_READY"),r&&!r.getLegend()&&!r.getDescription()&&!r.getSeries()||!configOptions.legend&&!configOptions.description&&!configOptions.series?($("#mainMap1_zoom_slider").addClass("closed"),$("#mainMap0_zoom_slider").addClass("closed"),$("#mainMap_zoom_location").addClass("closed")):($("#mainMap1_zoom_slider").addClass("open"),$("#mainMap0_zoom_slider").addClass("open"),$.each($(".mapCommandLocation"),function(e,t){$(t).addClass("open")})),r.getGeolocator()?$(".mapCommandLocation").show():$(".mapCommandLocation").hide(),app.seriesPanel&&app.seriesPanel.appIsReady(),app.autoplay&&(r.getSeries()&&r.getSeriesBookmarks()?(app.header.enableAutoplay(),$("body").hasClass("mobile-view")||app.autoplay.start()):app.autoplay.destroy())},this.onHashChange=function(){$("#seriesTextView").hide(),$("#footerMobile").hide(),location.hash=="#swipe"?($("#leftViewLink").addClass("current"),app.mobileLegendView.show()):location.hash=="#list"?($("#rightViewLink").addClass("current"),app.mobileInfoWindowView.show()):location.hash=="#description"&&($("#seriesTextView").show(),$("#footerMobile").hide())},this.updateUI=function(){var e=r.getColors();app.sidePanel.update(e[1],e[0]),app.mobileInfoWindowView.update(e[1]),app.mobileLegendView.update(e[1]),r.getGeolocator()?$(".mapCommandLocation").show():$(".mapCommandLocation").hide(),r.getLocationSearch()?(app.search||N(),$("#locationSearch").show()):$("#locationSearch").hide()},this.resize=function(e){app.initInProgress&&($("#loadingOverlay").css("top",e.isMobileView?"0px":$("#header").height()),$("#header").css("display",e.isMobileView?"none":"block"),$("#fatalError").css("display",e.isMobileView?"block":"none")),$("#initMapPopup").css("display")=="block"&&($("#header").css("display","none"),$("#contentPanel").css("display","none !important")),(app.isDirectCreation||app.isGalleryCreation)&&$("#fatalError").css("display",e.isMobileView?"block":"none"),e.isMobileView&&(location.hash!="#map"?location.hash="map":i.onHashChange()),r.getSeries()&&(e.isMobileView&&e.isOnMobileMapView&&($("#footerMobile").show(),$("#seriesPanel").hide(),app.mobileCarousel.started&&app.mobileCarousel.needUpdate&&app.mobileCarousel.update(r.getSeriesBookmarks(),r.getColors()),app.mobileCarousel.started&&!app.mobileCarousel.needUpdate&&app.mobileCarousel.setSelectedPoint(app.bookmarkIndex||0)),e.isMobileView&&!e.isOnMobileMapView?($("#footerMobile").hide(),$("#seriesPanel").hide()):e.isMobileView||($("#footerMobile").hide(),$("#seriesPanel").show())),!r.getSeries()&&!app.seriesPanel.started&&($("#footerMobile").hide(),$("#seriesPanel").hide()),e.isMobileView==0&&(location.hash="",$("#infoWindowView").css("display","none"),$("#legendView").css("display","none"),$("#footerMobile").hide(),$("#seriesTextView").hide()),app.sidePanel.resize(e.width,e.height),r.getLayout()=="swipe"?app.mapSwipe.reposition(e):app.spyGlass.reposition(e),$("#autoplay").css({left:355+($(window).width()-355)/2}),e.isMobileView&&app.autoplay&&app.autoplay.stop()},this.centerMap=function(e,t){t?app.map.centerAndZoom(e,t):app.mainMap.centerAt(e)},this.setMapExtent=function(e){var t=new b,n=[],r=app.mode=="TWO_LAYERS"?[app.map]:app.maps;return $.each(r,function(t,r){n.push(r.setExtent(e,!0))}),(new w(n)).then(function(){t.resolve()}),t},this.zoomToDeviceLocation=function(e,t){e&&(app.mainMap.spatialReference.wkid==102100?t=s.geographicToWebMercator(t):app.mainMap.spatialReference.wkid!=4326&&m.defaults.geometryService.project([t],app.mainMap.spatialReference,function(e){if(!e||!e[0])return;i.centerMap(e[0])}),i.centerMap(t))},this.initLocalization=function(){$("#infoWindowView .noData .title").html(i18n.swipe.mobileData.noData),$("#infoWindowView .noData .explain").html(i18n.swipe.mobileData.noDataExplain),$("#legendView .noData .title").html(i18n.swipe.mobileLegend.noLegend),$("#projectionPopup").find("h3").html(i18n.viewer.errors.conflictingProjectionsTitle),$(".projectionExplain").html(i18n.viewer.errors.conflictingProjections),$("#projectionPopup").find(".btnClose").html(i18n.viewer.errors.cpButton)}}}),define("storymaps/builder/SaveErrorPopupSocial",["../utils/Helper","storymaps/swipe/core/WebApplicationData","dojo/Deferred"],function(e,t,n){return function(i){function o(){i.find(".modal-title").html(i18n.swipe.saveErrorSocial.title),i.find(".panel1lbl").html(i18n.swipe.saveErrorSocial.panel1),i.find(".panel2lbl").html(i18n.swipe.saveErrorSocial.panel2),i.find(".panel2q1lbl").html(i18n.swipe.saveErrorSocial.panel2q1),i.find(".panel2q2lbl").html(i18n.swipe.saveErrorSocial.panel2q2),i.find(".panel3").html(i18n.swipe.saveErrorSocial.panel3.replace("${MYSTORIES}",'<a href="'+e.getMyStoriesURL()+'" target="_blank">'+i18n.swipe.saveErrorSocial.mystories+"</a>")),i.find(".panel4lbl").html(i18n.swipe.saveErrorSocial.panel4),i.find(".btn-primary").html(i18n.swipe.saveErrorSocial.btnSave),i.find(".panel1 .help img").attr("src","resources/icons/builder-help.png"),i.find(".panel2 .help img").attr("src","resources/icons/builder-help.png")}function u(){i.find("input[name='optErrorSocial']").change(function(){var e=i.find("input[name='optErrorSocial']:checked").val();e=="story"?(i.find(".stop-asking input").attr("disabled","disabled").prop("checked",!1),i.find(".stop-asking label").addClass("disabled")):(i.find(".stop-asking input").removeAttr("disabled"),i.find(".stop-asking label").removeClass("disabled"))}),i.find(".btn-primary").click(function(){i.find(".stop-asking input").is(":checked")&&t.setDoNotWarnTitle(!0),s.resolve({choice:i.find("input[name='optErrorSocial']:checked").val()}),i.modal("hide")})}var s=null;o(),u(),this.present=function(){return s=new n,i.find(".panel1 .help").tooltip({title:i18n.swipe.saveErrorSocial.panel1tooltip+'<img src="resources/icons/builder-help-social.png"/>',html:!0,placement:"left"}),i.find(".panel2 .help").tooltip({title:i18n.swipe.saveErrorSocial.panel2q1tooltip,html:!0}),i.modal({keyboard:!1}),s}}}),define("storymaps/builder/BuilderPanel",["storymaps/swipe/core/WebApplicationData","storymaps/utils/Helper","dojo/topic","./SaveErrorPopupSocial"],function(e,t,n,r){return function(s,o,u,a){function h(){console.log("swipe.builder.Builder - save"),k(!1),S(),s.find(".builder-settings").popover("show");if(app.isDirectCreationFirstSave){var t=$("#headerDesktop .title .text_edit_label").text(),n=$("#headerDesktop .subtitle .text_edit_label").text();n==i18n.builder.header.editMe&&(n="");if(!t||t==i18n.builder.header.editMe){f.saveFailed("NONAME");return}u(t,n)}else{var r="",i="";e.getTitle()&&(r=e.getTitle().trim()),app.data.getAppItem()&&app.data.getAppItem().title&&(i=app.data.getAppItem().title.trim());var l=function(e){if(!e||!e.success){appSaveFailed("APP");return}a(e)};if(!app.builder.titleMatchOnLoad&&!e.getDoNotWarnTitle()&&app.data.getAppItem().access=="public"&&r!=i)app.builder.titleMatchDialogDisplayed?o(app.builder.titleFromItem,l):(app.builder.titleMatchDialogDisplayed=!0,_saveErrorPopupSocial.present().then(function(e){app.builder.titleFromItem=e&&e.choice=="item",o(app.builder.titleFromItem,l)}));else{var c=e.getDoNotWarnTitle()||app.data.getAppItem().access!="public"&&!app.builder.titleMatchOnLoad;o(c,l)}}}function p(t){t&&(k(!1),e.restoreOriginalData(),app.data.discardChanges(),y(),n.publish("CORE_UPDATE_UI"),k(!0)),s.find(".builder-discard").popover("hide")}function d(){b(),c.openSettingPopup(!1)}function v(){b(),window.open("https://storymaps.arcgis.com/en/app-list/swipe-spyglass/","_blank")}function m(e){e?document.location="?"+document.location.search.split("edit")[0].slice(1,-1):s.find(".builder-view").popover("hide")}function g(){window.open(t.getItemURL(configOptions.sharingurl,app.data.getAppItem().id),"_blank")}function y(){s.find("#save-counter").html(i18n.builder.builder.noPendingChange),s.find("#save-counter").css("color","#999"),x()}function b(){s.find(".discard-popover").length>0&&s.find(".builder-discard").popover("hide"),s.find(".view-popover").length>0&&s.find(".builder-view").popover("hide")}function w(){var e="#"+s.attr("id");s.find(".builder-discard").popover({trigger:"manual",placement:"bottom",html:!0,content:'<script> $("'+e+' .builder-discard").next(".popover").addClass("discard-popover");'+' $("'+e+' .builder-view").popover("hide");'+' $("'+e+' .builder-save").popover("hide");'+"</script>"+i18n.builder.builder.popoverDiscard+" "+'<button type="button" class="btn btn-danger btn-small" onclick="app.builder.discard(true)">'+i18n.builder.builder.yes+"</button> "+'<button type="button" class="btn btn-small" onClick="app.builder.discard(false)">'+i18n.builder.builder.no+"</button>"}),s.find(".builder-view").popover({trigger:"manual",html:!0,content:'<script> $("'+e+' .builder-view").next(".popover").addClass("view-popover");'+' $("'+e+' .builder-discard").popover("hide");'+' $("'+e+' .builder-save").popover("hide");'+"</script>"+i18n.builder.builder.popoverOpenViewExplain+" "+'<button type="button" class="btn btn-danger btn-small" onclick="app.builder.switchToView(true)">'+i18n.builder.builder.popoverOpenViewOk+"</button> "+'<button type="button" class="btn btn-small" onClick="app.builder.switchToView(false)">'+i18n.builder.builder.popoverOpenViewCancel+"</button>"}),s.find(".builder-save").popover({trigger:"manual",placement:"left",html:!0,content:'<script>$("'+e+' .builder-save").next(".popover").addClass("save-popover");</script>'+i18n.builder.builder.popoverSaveWhenDone}),s.find(".builder-view").attr("title",i18n.builder.builder.buttonView)}function E(){var e="#"+s.attr("id");s.find(".builder-settings").popover({containerId:e,html:!0,trigger:"manual",placement:"bottom",content:'<script>$("'+e+' .builder-settings").next(".popover").css("margin-left", "0px").addClass("save-popover-2");'+'setTimeout(function(){$("'+e+' .builder-settings").next(".popover").css("margin-left", - ($(".builder-save").outerWidth()/2 + $(".builder-share").outerWidth() + $(".builder-settings").outerWidth()/2+8));}, 0);'+'$("'+e+' .builder-settings").next(".popover").find(".stepSave").css("display", "block");'+'$("'+e+' .builder-settings").next(".popover").find(".stepSaved").css("display", "none");'+'$("'+e+' .builder-settings").next(".popover").find(".stepFailed").css("display", "none");'+'$("'+e+' .builder-settings").next(".popover").find(".stepFailed3").css("display", "none");'+"</script>"+'<div class="stepSave" style="margin-top: 3px">'+i18n.builder.builder.savingApplication+'... <img src="resources/icons/loader-upload.gif" class="addSpinner" alt="Uploading">'+"</div>"+'<div class="stepSaved">'+i18n.builder.builder.saveSuccess+" "+'<button type="button" class="btn btn-success btn-small" onclick="app.builder.hideSaveConfirmation()" style="vertical-align: 1px;">'+i18n.builder.builder.gotIt+"</button> "+"</div>"+'<div class="stepFailed" style="color: red;">'+i18n.builder.builder.saveError+" "+'<button type="button" class="btn btn-danger btn-small" onclick="app.builder.hideSaveConfirmation()" style="vertical-align: 1px;">'+i18n.builder.builder.gotIt+"</button> "+"</div>"+'<div class="stepHidden stepFailed3" style="color: red;">'+i18n.builder.builder.saveError3+" "+'<button type="button" class="btn btn-danger btn-small" onclick="app.builder.hideSaveConfirmation()" style="vertical-align: 1px;">'+i18n.builder.builder.gotIt+"</button> "+"</div>"})}function S(){s.find(".builder-save").popover("destroy"),l=!1}function x(){s.find(".builder-view").click(N),s.find(".builder-discard").click(T)}function T(){f.hasPendingChange()&&s.find(".builder-discard").popover("show")}function N(){f.hasPendingChange()?s.find(".builder-view").popover("show"):m(!0)}function C(){s.find(".builder-settings").popover("hide"),$("#headerDesktop .title").removeClass("titleEmpty")}function k(e){s.find(".builder-cmd").attr("disabled",!e)}function L(){s.find("h4").html(i18n.builder.builder.panelHeader),s.find("button").eq(0).html(i18n.builder.builder.buttonSave),s.find("button").eq(1).html(i18n.builder.builder.buttonShare.toUpperCase()),s.find("button").eq(2).html(i18n.builder.builder.buttonSettings.toUpperCase()),s.find("button").eq(3).html(i18n.builder.builder.buttonHelp.toUpperCase()),s.find("#save-counter").html(i18n.builder.builder.noPendingChange)}var f=this,l=!0,c=null;this.init=function(e){c=e,L(),s.show(),x(),w(),E(),app.builder.closeBuilderSaveIntro=S,app.builder.switchToView=m,app.builder.discard=p,app.builder.hideSaveConfirmation=C,s.find(".builder-save").click(h),s.find(".builder-share").click(function(){app.builder.openSharePopup(!1)}),s.find(".builder-settings").click(d),s.find(".builder-help").click(v),_saveErrorPopupSocial=new r($("#saveErrorPopupSocial"))},this.saveSucceeded=function(){s.find(".builder-settings").popover("hide"),(app.isDirectCreationFirstSave||app.isGalleryCreation)&&app.builder.openSharePopup(!0),b(),y(),k(!0)},this.saveFailed=function(e){s.find(".builder-settings").next(".popover").find(".stepSave").css("display","none");if(e=="NONAME"){s.find(".builder-settings").next(".popover").find(".stepFailed3").css("display","block"),$("#headerDesktop .title").addClass("titleEmpty"),s.find(".builder-save").attr("disabled",!1),s.find(".builder-settings").attr("disabled",!1),s.find(".builder-help").attr("disabled",!1);return}s.find(".builder-save").next(".popover").find(".stepFailed").css("display","block"),k(!0)},this.hasPendingChange=function(){return s.find("#save-counter").html()&&s.find("#save-counter").html()!=i18n.builder.builder.noPendingChange},this.incrementSaveCounter=function(e){var t=s.find("#save-counter").html();f.hasPendingChange()||(t=0,l&&(setTimeout(function(){s.find(".builder-save").popover("show")},250),setTimeout(function(){l&&s.find(".builder-save").popover("destroy")},3500))),t==0?e==1||isNaN(parseInt(e))?t=i18n.builder.builder.unSavedChangeSingular:t=e+" "+i18n.builder.builder.unSavedChangePlural:t=parseInt(t)+(e?e:1)+" "+i18n.builder.builder.unSavedChangePlural,s.find("#save-counter").html(t),s.find("#save-counter").css("color","#FFF")},this.updateSharingStatus=function(){app.isDirectCreationFirstSave||app.isGalleryCreation?($("#sharing-status").html("<span style='color: #FFF'>; "+i18n.swipe.share.shareStatus1+"</span>"),s.find(".builder-share").attr("disabled","disabled")):app.data.getAppItem().access=="public"?$("#sharing-status").html("; "+i18n.swipe.share.shareStatus2):app.data.getAppItem().access=="account"?$("#sharing-status").html("; "+i18n.swipe.share.shareStatus3):$("#sharing-status").html("; "+i18n.swipe.share.shareStatus4)},this.resize=function(){s.css("margin-left",$("body").width()/2-s.outerWidth()/2)}}}),define("storymaps/builder/SettingsPopup",["storymaps/swipe/core/WebApplicationData","dojo/topic"],function(e,t){return function(r,i,s){function c(){if($(this).hasClass("disabled"))return;m($(this).index()),e.getPopup()||$(".settingsPopupHeader").find(".tab").eq(3).addClass("disabled")}function h(n){var r=[],i=-1;$.each(o,function(e,t){var n=t.save();n===!1&&(i=e),r.push(n)});var s=e.getLayout()!=r[0].layout||e.getDataModel()!=r[1].dataModel||e.getWebmaps().toString()!=r[1].webmaps.toString()||e.getLayers().toString()!=r[1].layers.toString()||e.getLegend()!=r[2].legend||e.getDescription()!=r[2].description||e.getSeries()!=r[2].series||e.getPopup()!=r[2].popup;if(n!==!0&&s)return p(),!1;if(i!=-1)return m(i),!1;t.publish("SETTINGS_POPUP_SAVE",{settings:r})}function p(){f.popover({html:!0,trigger:"manual",content:'<script>$("#settingsPopup .btnSave").next(".popover").addClass("savePopover");</script>'+i18n.swipe.settingsLayout.settingsSaveConfirm+' <button type="button" class="btn btn-success btn-small" onclick="app.builder.settingsPopupSaveConfirmationCallback(true);">'+i18n.builder.builder.popoverOpenViewOk+"</button> "}),f.popover("show")}function d(e){e&&h(!0),v()}function v(){f.popover("destroy"),$(r).modal("hide")}function m(e){u.removeClass("active disabled"),a.hide(),u.eq(e).addClass("active"),o[e].show(),a.eq(e).show()}var o=[],u=$(r).find(".tab"),a=$(r).find(".tab-content"),f=$(r).find(".btnSave"),l=$(r).find(".btnClose");u.click(c),f.click(h),this.init=function(e){o=e.getSettingsTab(u,a,f,{colorSchemes:i,defaultLogoURL:s}),app.builder.settingsPopupSaveConfirmationCallback=d},this.present=function(e,t){u.removeClass("disabled"),l.removeAttr("disabled"),$(".error-msg",r).hide(),$(".modal-header .close",r).attr("data-dismiss","modal"),$(".modal-footer .error",r).hide(),$.each(o,function(n,r){r.init(e[n],n==t)}),m(t?t:0),t?(u.addClass("disabled"),u.eq(t).removeClass("disabled"),l.attr("disabled","disabled"),$(".modal-header .close",r).attr("data-dismiss","none")):m(0),$(r).modal({keyboard:t==undefined})},this.initLocalization=function(){$(r).find("h3").html(i18n.builder.settings.settingsHeader),$.each(o,function(e,t){t&&t.initLocalization()}),$(r).find(".btnClose").html(i18n.builder.settings.modalCancel),$(r).find(".btnSave").html(i18n.builder.settings.modalApply),$(r).find(".error").html(i18n.builder.settings.tabError)}}}),define("storymaps/swipe/builder/SettingsPopupTabDataModel",["dojo/topic","dojo/on","dojo/dom","storymaps/ui/SelectMapWidget/browse-dialog/js/BrowseIdDlg","dijit/registry"],function(e,t,n,r,i){return function(s,o,u){function f(){return $(o).find(".dataModel-box.selected").index()==2?"TWO_WEBMAPS":"TWO_LAYERS"}function l(){var e=[$(o).find(".inputWebmapId1").val()];return $(o).find(".inputWebmapId2").val()&&e.push($(o).find(".inputWebmapId2").val()),e}function c(){f()!="TWO_WEBMAPS"?u.removeAttr("disabled"):$(o).find(".inputWebmapId1").val().length!=32||$(o).find(".inputWebmapId2").val().length!=32?u.attr("disabled","disabled"):$(o).find(".inputWebmapId1").val()==$(o).find(".inputWebmapId2").val()?u.attr("disabled","disabled"):u.removeAttr("disabled")}function h(){return[$(o).find("#mapLayers").find(":selected").attr("value")]}function p(){w(!1),app.browseDlg.show()}function d(e){b($(e.target).parent().index()==2?1:0)}function v(){var e=$(o).find(".inputWebmapId1").val(),t=$(o).find(".inputWebmapId2").val();$(o).find(".inputWebmapId1").val(t),$(o).find(".inputWebmapId2").val(e),e==app.rootMapId?$(o).find(".inputWebmapId2").attr("disabled","disabled"):$(o).find(".inputWebmapId2").attr("disabled",!1),t==app.rootMapId?$(o).find(".inputWebmapId1").attr("disabled","disabled"):$(o).find(".inputWebmapId1").attr("disabled",!1),$(o).find("input").removeClass("miniInput"),$(o).find(".inputWebmapId1").attr("disabled")=="disabled"?$(o).find(".inputWebmapId2").addClass("miniInput"):$(o).find(".inputWebmapId1").addClass("miniInput"),$(o).find(".inputWebmapId1").attr("disabled")=="disabled"?$(o).find(".browseMaps").addClass("browseMaps2"):$(o).find(".browseMaps").removeClass("browseMaps2")}function m(e){if($(o).find("#mapLayers").children("option").length>0)return;var t=(app.map.layerIds||[]).concat(app.map.graphicsLayerIds);t.reverse(),$.each(t,function(e,t){var n=app.map.getLayer(t),r=n&&n.arcgisProps&&n.arcgisProps.title?n.arcgisProps.title:n&&n.name?n.name:t;if(!n||n._basemapGalleryLayerType=="basemap"||n._basemapGalleryLayerType=="reference"||t=="locateLayer"||t=="labels")return;if(n.layerId>=0){var i=n.id.split("_").slice(0,-1).join("_");if($.inArray(i,app.map.layerIds)>=0)return}$(o).find("#mapLayers").append('<option value="'+t+'">'+(r||t)+"</option>")});var n=0;e&&e[0]&&$.each($("#mapLayers").children("option"),function(t,r){$(r).val()==e[0]&&(n=t)});var r=$(o).find("#mapLayers").find("option").eq(n).val();$(o).find("#mapLayers").val(r)}function g(e){e=e||[],$(o).find(".inputWebmapId1").val(e[0]),$(o).find(".inputWebmapId2").val(e[1]);var t=$(o).find(".inputWebmapId1").val(),n=$(o).find(".inputWebmapId2").val();t==app.rootMapId?$(o).find(".inputWebmapId1").attr("disabled","disabled"):$(o).find(".inputWebmapId1").attr("disabled",!1),n==app.rootMapId?$(o).find(".inputWebmapId2").attr("disabled","disabled"):$(o).find(".inputWebmapId2").attr("disabled",!1),$(o).find("input").removeClass("miniInput"),$(o).find(".inputWebmapId1").attr("disabled")=="disabled"?$(o).find(".inputWebmapId2").addClass("miniInput"):$(o).find(".inputWebmapId1").addClass("miniInput"),$(o).find(".inputWebmapId1").attr("disabled")=="disabled"?$(o).find(".browseMaps").addClass("browseMaps2"):$(o).find(".browseMaps").removeClass("browseMaps2")}function y(e){var t=e=="swipe"?i18n.swipe.settingsDataModel.settingsDataModelExplainSwipe:i18n.swipe.settingsDataModel.settingsDataModelExplainSpyGlass,n=e=="swipe"?i18n.swipe.settingsDataModel.settingsDataModelWebmapSwipeId2:i18n.swipe.settingsDataModel.settingsDataModelWebmapGlassId1,r=e=="swipe"?i18n.swipe.settingsDataModel.settingsDataModelWebmapSwipeId1:i18n.swipe.settingsDataModel.settingsDataModelWebmapGlassId2,i=e=="swipe"?i18n.swipe.settingsDataModel.settingsDataModel1Explain:i18n.swipe.settingsDataModel.settingsDataModel1SpyGlassExplain,s=e=="swipe"?i18n.swipe.settingsDataModel.settingsDataModel2Explain:i18n.swipe.settingsDataModel.settingsDataModel2SpyGlassExplain;$(o).find("p").html(t),$(o).find(".control-label[for=inputWebmapId1]").html(n+":"),$(o).find(".control-label[for=inputWebmapId2]").html(r+":"),$(o).find(".model1.alert").html(i),$(o).find(".model2.alert").html(s+' <a class="webmapidtooltip">'+"<br />"+i18n.swipe.settingsDataModel.settingsDataModel2HelpTitle+"</a>"),$(o).find(".webmapidtooltip").popover({trigger:"hover",placement:"bottom",html:!0,content:'<div style="text-align: center">'+i18n.swipe.settingsDataModel.settingsDataModel2HelpContent+'<img style="margin-top: 6px" src="resources/icons/tooltip-map-id.png" width="220px" height="126px"/>'+"</div>"})}function b(e){e==0?app.mainMap=app.map:app.mainMap=app.maps[0]||app.map,$(o).find(".dataModel-box").removeClass("selected"),$(o).find(".dataModel-box").eq(e?1:0).addClass("selected selectedDataModel"),$(o).find(".dataModel-box-content").removeClass("fade"),$(o).find(".dataModel-box-content").eq(e?0:1).addClass("fade"),c()}function w(e){var t=$(o[0].parentNode.parentNode.id).selector||$(o[0].parentNode.parentNode.id);e==1?$("#"+t).show():$("#"+t).hide()}var a=null;$(o).append($("#popupView-dataModel").children().clone()),$(o).find(".inputWebmapId1").keyup(c),$(o).find(".inputWebmapId2").keyup(c),$(o).find(".inputWebmapId1").bind("paste",null,function(){setTimeout(function(){c()},250)}),$(o).find(".inputWebmapId2").bind("paste",null,function(){setTimeout(function(){c()},250)}),$(o).find(".inputWebmapId2").blur(function(){$(window).scrollTop(0)}),$(o).find(".btnSelect").fastClick(d),$(o).find(".switchMapIds").fastClick(v),$(o).find(".browseMaps").fastClick(p),e.subscribe("LAYOUT_CHANGE",y),this.init=function(e){b(e.dataModel=="TWO_WEBMAPS"?1:0),m(e.layers),g(e.webmaps),y(e.layout),c(),i.byId("browse-id-dialog")&&(i.byId("browse-id-dialog").destroy(),i.byId("browse-id-search-box").destroy(),i.byId("gallery").destroy()),app.browseDlg&&app.browseDlg.destroy();var n={portal:app.portal,galleryType:"webmap"};app.browseDlg=new r(n),t(app.browseDlg,"close",function(){app.browseDlg.get("selected")!==null&&($(".inputWebmapId1").hasClass("miniInput")?($(".inputWebmapId1").val(app.browseDlg.get("selected")),$(".inputWebmapId1").keyup()):($(".inputWebmapId2").val(app.browseDlg.get("selected")),$(".inputWebmapId2").keyup())),w(!0)}),t(app.browseDlg._grid,"onItemClick",function(e){w(!0),app.browseDlg.get("selected")!==null&&$(".miniInput").val(app.browseDlg.get("selected")),app.browseDlg.onClose()}),t(app.browseDlg,"cancel",function(){w(!0)});var s=i.byId("browse-id-dialog");s._onKey=function(e){e.keyCode==27&&dojo.stopEvent(e)},$(o).parent().parent()[0].id=="settingsPopup"&&$(".switchMapIds").addClass("settings")},this.show=function(){c()},this.save=function(){return{dataModel:f(),webmaps:l(),layers:h()}},this.initLocalization=function(){$(s).find(".wizardLabel")[0]?$(s).find(".wizardLabel").html(i18n.swipe.settingsDataModel.settingsTabDataModel):$(s).html(i18n.swipe.settingsDataModel.settingsTabDataModel),$(o).find("p").html(i18n.swipe.settingsDataModel.settingsDataModelExplainSwipe),$(o).find(".model1").html(i18n.swipe.settingsDataModel.settingsDataModelOneMap),$(o).find(".model2").html(i18n.swipe.settingsDataModel.settingsDataModelTwoMaps),$(o).find(".dataModel-box .selectedDataModel").html(i18n.swipe.settingsDataModel.settingsDataModelSelected),$(o).find(".btnSelect").html(i18n.swipe.settingsDataModel.settingsDataModelSelect),$(o).find(".layersWarning").html(i18n.swipe.settingsDataModel.settingsDataModel1Warning)}}}),define("storymaps/swipe/builder/SettingsPopupTabLayout",["dojo/topic"],function(e){return function(n,r){function s(){return $(r).find(".layout-box.selected").index()==2?"spyglass":"swipe"}function o(t){var n=$(t.target).parent().index()==2?1:0;i.selectLayout(n),e.publish("LAYOUT_CHANGE",n==0?"swipe":"spyglass")}var i=this;$(r).append($("#popupView-layout").children().clone()),$(r).find(".layout-box button").fastClick(o),this.init=function(e){i.selectLayout(e.layout=="spyglass"?1:0)},this.show=function(){},this.save=function(){return{layout:s()}},this.selectLayout=function(t){$(r).find(".layout-box").removeClass("selected"),$(r).find(".layout-box").eq(t?1:0).addClass("selected"),e.publish("LAYOUT_CHANGE",t==0?"swipe":"spyglass")},this.initLocalization=function(){$(n).find(".wizardLabel")[0]?$(n).find(".wizardLabel").html(i18n.swipe.settingsLayout.settingsTabLayout):$(n).html(i18n.swipe.settingsLayout.settingsTabLayout),$(r).find("p").html(i18n.swipe.settingsLayout.settingsLayoutExplain),$(r).find(".layout-box:nth-child(2) div").html(i18n.swipe.settingsLayout.settingsLayoutSwipe),$(r).find(".layout-box:nth-child(2) img").attr("src","resources/icons/builder-layout-swipe.png"),$(r).find(".layout-box:nth-child(3) div").html(i18n.swipe.settingsLayout.settingsLayoutSpyGlass),$(r).find(".layout-box:nth-child(3) img").attr("src","resources/icons/builder-layout-spyglass.png"),$(r).find(".layout-box .selectedLayout").html(i18n.swipe.settingsLayout.settingsLayoutSelected),$(r).find(".layout-box button").html(i18n.swipe.settingsLayout.settingsLayoutSelect)}}}),define("storymaps/swipe/builder/SettingsPopupTabLegend",["dojo/topic","storymaps/swipe/core/WebApplicationData","dojo/DeferredList","dojo/string","esri/geometry/Extent"],function(e,t,n,r,i){return function(n,i){function s(){var e=r.substitute("resources/icons/builder-preview-${layout}-${series}-${descr}-${legend}.png",{layout:_layout=="swipe"?0:1,series:l()?1:0,descr:f()?1:0,legend:a()?1:0});l()?($(i).find('[value = "description"]').attr("disabled",!0),$(".descriptionText").css("opacity",.5)):($(i).find('[value = "description"]').attr("disabled",!1),$(i).find('[value = "description"]').prop("checked",f()),$(".descriptionText").css("opacity",1)),$(i).find(".uiSimImg").attr("src",e)}function o(){var t=$(i).find('[value = "popup"]').prop("checked")?!0:!1;e.publish("POPUP_CHANGE",t),app.isPopup=t}function u(e){_layout=e,s()}function a(){return $(i).find('[value = "legend"]').prop("checked")}function f(){return $(i).find('[value = "description"]').prop("checked")}function l(){return $(i).find('[value = "bookmarks"]').prop("checked")}function c(){return $(i).find('[value = "popup"]').prop("checked")}function h(){return $(i).find('[value = "locationSearch"]').prop("checked")}function p(){return $(i).find('[value = "geolocator"]').prop("checked")}$(i).append($("#popupView-legend").children().clone()),$(i).find(".legendControls").change(s),$(i).find('[value = "popup"]').fastClick(o),e.subscribe("LAYOUT_CHANGE",u),_layout=null,_settings=null,this.init=function(e){_settings=e,$(i).find('[value = "legend"]').prop("checked",e.legend),$(i).find('[value = "description"]').prop("checked",e.description),$(i).find('[value = "bookmarks"]').prop("checked",!!e.bookmarks),$(i).find('[value = "popup"]').prop("checked",e.popup),$(i).find('[value = "locationSearch"]').prop("checked",e.locationSearch),$(i).find('[value = "geolocator"]').prop("checked",e.geolocator),s()},this.show=function(){},this.save=function(){return{legend:a(),description:f(),series:l(),popup:c(),locationSearch:h(),geolocator:p()}},this.initLocalization=function(){$(n).find(".wizardLabel")[0]?$(n).find(".wizardLabel").html(i18n.swipe.settingsLegend.settingsTabLegend):$(n).html(i18n.swipe.settingsLegend.settingsTabLegend),$(i).find("p").html(i18n.swipe.settingsLegend.settingsLegendExplain),$(i).find(".legendText").html(i18n.swipe.settingsLegend.settingsLegendEnable),$(i).find(".descriptionText").html(i18n.swipe.settingsLegend.settingsDescriptionEnable),$(i).find(".bookmarksText").html(i18n.swipe.settingsLegend.settingsBookmarksEnable),$(i).find(".popupText").html(i18n.swipe.settingsLegend.settingsPopupDisable),$(i).find(".locationSearchText").html(i18n.swipe.settingsLegend.settingsAddressSearch),$(i).find(".geolocatorText").html(i18n.swipe.settingsLegend.settingsLocateButton),$(i).find(".legendInfo").html('<a class="legendtooltip"><img src="resources/icons/builder-help.png" /></a>'),$(i).find(".seriesInfo").html('<a class="seriestooltip"><img src="resources/icons/builder-help.png" /></a>'),$(i).find(".geolocatorInfo").html('<a class="geolocatortooltip"><img src="resources/icons/builder-help.png" /></a>'),$(i).find(".legendtooltip").popover({trigger:"hover",placement:"right",html:!0,content:'<script>$(".legendtooltip").next(".popover").addClass("legendtooltip-popover");</script><div style="text-align: center">'+i18n.swipe.settingsLegend.settingsLegendHelpContent+'<img style="margin-top: 6px" src="resources/icons/tooltip-legend-configure.png" width="220px" height="110px"/>'+"</div>"}),$(i).find(".seriestooltip").popover({trigger:"hover",placement:"right",html:!0,content:'<script>$(".seriestooltip").next(".popover").addClass("seriestooltip-popover");</script>'+i18n.swipe.settingsLegend.settingsSeriesHelpContent2}),$(i).find(".geolocatortooltip").popover({trigger:"hover",placement:"top",html:!0,content:'<script>$(".geolocatortooltip").next(".popover").addClass("geolocatortooltip-popover");</script><div ><img style="float: left; margin-right: 10px; margin-top: 8px;" src="resources/icons/builder-settings-locate.png" />'+i18n.swipe.settingsLegend.settingsLocateButtonExplain+"</div>"}),$(i).find("#uiSimulator div").html(i18n.swipe.settingsLegend.preview)}}}),define("storymaps/swipe/builder/SettingsPopupTabSwipePopup",["dojo/topic"],function(e){return function(n,r){function i(){return[$(r).find(".selectPopup2").val(),$(r).find(".selectPopup1").val()]}function s(){return[$(r).find("#popup2Color").spectrum("get").toHex(),$(r).find("#popup1Color").spectrum("get").toHex()]}function o(e){var t=e=="swipe"?i18n.swipe.settingsSwipePopup.settingsSwipePopupSwipe1:i18n.swipe.settingsSwipePopup.settingsSwipePopupGlass1,n=e=="swipe"?i18n.swipe.settingsSwipePopup.settingsSwipePopupSwipe2:i18n.swipe.settingsSwipePopup.settingsSwipePopupGlass2;$(r).find(".popup1Title").html(t),$(r).find(".popup2Title").html(n)}$(r).append($("#popupView-popup").children().clone()),e.subscribe("LAYOUT_CHANGE",o),$(r).find(".selectPopup1").blur(function(){console.log("OOOO"),$(window).scrollTop(0)}),$(r).find(".selectPopup2").blur(function(){$(window).scrollTop(0)}),this.init=function(e){o(e.layout);var t=e.popupColors?e.popupColors[0]:"#"+configOptions.popupColors[0],n=e.popupColors?e.popupColors[1]:"#"+configOptions.popupColors[1];$(r).find("#popup2Color").spectrum({color:t,showButtons:!1,showPalette:!1,showSelectionPalette:!1,showPaletteOnly:!1,showInput:!0}),$(r).find("#popup1Color").spectrum({color:n,showButtons:!1,showPalette:!1,showSelectionPalette:!1,showPaletteOnly:!1,showInput:!0}),$(r).find(".selectPopup2").val(e.popupTitles?e.popupTitles[0]:""),$(r).find(".selectPopup1").val(e.popupTitles?e.popupTitles[1]:"")},this.show=function(){},this.save=function(){return{popupTitles:i(),popupColors:s()}},this.initLocalization=function(){$(n).find(".wizardLabel")[0]?$(n).find(".wizardLabel").html(i18n.swipe.settingsSwipePopup.settingsSwipePopup):$(n).html(i18n.swipe.settingsSwipePopup.settingsSwipePopup),$(r).find("p").html(i18n.swipe.settingsSwipePopup.settingsSwipePopupExplain),$(r).find(".popup1HeaderTitle").html(i18n.swipe.settingsSwipePopup.settingsSwipePopupTitle),$(r).find(".popup2HeaderTitle").html(i18n.swipe.settingsSwipePopup.settingsSwipePopupTitle),$(r).find(".popup1HeaderColor").html(i18n.swipe.settingsSwipePopup.settingsSwipePopupColor),$(r).find(".popup2HeaderColor").html(i18n.swipe.settingsSwipePopup.settingsSwipePopupColor)}}}),define("storymaps/swipe/builder/InitPopup",["storymaps/swipe/core/WebApplicationData","storymaps/swipe/builder/SettingsPopupTabDataModel","storymaps/swipe/builder/SettingsPopupTabLayout","storymaps/swipe/builder/SettingsPopupTabLegend","storymaps/swipe/builder/SettingsPopupTabSwipePopup","dojo/Deferred","dojo/topic"],function(e,t,n,r,i,s,o){return function(a){function v(e){if($(this).hasClass("disabled"))return;b($(this).index("#initPopup .tab"))}function m(){var e=$("#initPopup .tab.active").index("#initPopup .tab");return $(a).find(".btn-prev").attr("disabled",!1),e<3&&!d.hasClass("btn-success")?(b(++e),$("#initPopup .tab.active").find(".badge").addClass("badge-info"),$("#initPopup .tab").eq(e-1).find(".badge").addClass("badge-success"),e==3&&(d.addClass("btn-success"),$(a).find(".next").html(i18n.swipe.initPopup.modalApply)),!1):y()}function g(){var e=$("#initPopup .tab.active").index("#initPopup .tab");$(a).find(".btn-next").attr("disabled",!1),e==1&&$(a).find(".btn-prev").attr("disabled","disabled"),e>0&&(b(--e),d.removeClass("btn-success"),$("#initPopup .tab").eq(e+1).find(".badge").removeClass("badge-success"),$("#initPopup .tab").eq(e).find(".badge").removeClass("badge-success"),$("#initPopup .tab").eq(e+1).find(".badge").removeClass("badge-info"),$("#initPopup .tab.active").find(".badge").addClass("badge-info"),$(a).find(".next").html(i18n.swipe.initPopup.modalNext))}function y(){var t=f[0].save();if(!t)return b(0),!1;e.setLayout(t.layout);var n=f[1].save();if(!n)return b(1),!1;e.setWebmaps(n.webmaps),e.setDataModel(n.dataModel),e.setLayers(n.layers),configOptions.webmaps=n.webmaps;var r=f[2].save();if(!r)return b(2),!1;e.setLegend(r.legend),e.setDescription(r.description),e.setPopup(r.popup),e.setSeries(r.series),e.setSeriesBookmarks(r.bookmarks),e.setLocationSearch(r.locationSearch),e.setGeolocator(r.geolocator);var i=f[3].save();return i?(e.setPopupColors(i.popupColors),e.setPopupTitles(i.popupTitles),l.resolve(),!0):(b(2),!1)}function b(e){c.removeClass("active disabled"),h.hide(),c.eq(e).addClass("active"),f[e].show(),h.eq(e).show(),e==3&&$(a).find(".btnSave").html(i18n.swipe.initPopup.modalApply).removeClass("btn-primary").addClass("btn-success")}function w(e){e==0?(d.addClass("btn-success"),$(a).find(".next").html(i18n.swipe.initPopup.modalApply),$("#builderWizard").find(".tab").eq(3).addClass("disabled")):(d.removeClass("btn-success"),$("#builderWizard").find(".tab").eq(3).removeClass("disabled"),$(a).find(".next").html(i18n.swipe.initPopup.modalNext))}function E(){$(a).find("h3").html(i18n.swipe.initPopup.initHeader),$.each(f,function(e,t){t.initLocalization()}),$(a).find(".prev").html(i18n.swipe.initPopup.modalPrev),$(a).find(".next").html(i18n.swipe.initPopup.modalNext),$(a).find(".error").html(i18n.swipe.initPopup.tabError)}var f=[],l=null,c=$(a).find(".tab"),h=$(a).find(".step-pane"),p=$(a).find(".btn-prev"),d=$(a).find(".btn-next");p.click(g),d.click(m),$("#builderWizard").wizard(),$(a).find(".btn-prev").attr("disabled","disabled"),this.init=function(){f=[new n(c.eq(0),h.eq(0)),new t(c.eq(1),h.eq(1),d),new r(c.eq(2),h.eq(2)),new i(c.eq(3),h.eq(3))],$("#initPopup").addClass("started"),E(),o.subscribe("POPUP_CHANGE",w)},this.present=function(t,n){return l=new s,f[0].init({}),f[1].init({webmaps:e.getWebmaps(),layout:"swipe"}),f[2].init({}),f[3].init({layout:"swipe"}),app.isCreationLayout?(b(1),$(a).find(".btn-prev").attr("disabled",!1),f[0].selectLayout(app.isCreationLayout=="swipe"?0:1)):b(0),$(a).modal({keyboard:!1}),l}}}),define("storymaps/utils/WebMapHelper",["esri/request","esri/renderers/jsonUtils","dojo/Deferred","dojo/_base/lang","dojo/_base/array"],function(e,t,n,r,i){return{prepareWebmapItemForCloning:function(e){i.forEach(e.itemData.baseMap.baseMapLayers,function(e){delete e.errors,delete e.layerObject,delete e.resourceInfo}),i.forEach(e.itemData.operationalLayers,function(e){delete e.errors,delete e.layerObject,delete e.resourceInfo,e.featureCollection&&e.featureCollection.layers&&i.forEach(e.featureCollection.layers,function(e){delete e.layerObject}),e.featureCollection&&e.featureCollection.featureSet&&e.featureCollection.featureSet.features&&i.forEach(e.featureCollection.featureSet.features,function(e){delete e._shape,delete e._graphicsLayer}),e.type=="CSV"&&e.featureCollection&&delete e.featureCollection,i.forEach(e.layers,function(e){delete e.drawingInfo,e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.renderer&&(e.layerDefinition.drawingInfo.renderer=t.fromJson(e.layerDefinition.drawingInfo.renderer).toJson())}),e.layerDefinition&&e.layerDefinition.drawingInfo&&e.layerDefinition.drawingInfo.renderer&&(e.layerDefinition.drawingInfo.renderer=t.fromJson(e.layerDefinition.drawingInfo.renderer).toJson())})}}}),define("storymaps/builder/Builder",["esri/arcgis/Portal","storymaps/swipe/core/WebApplicationData","storymaps/builder/BuilderPanel","storymaps/builder/SettingsPopup","storymaps/swipe/builder/InitPopup","storymaps/swipe/core/SwipeHelper","storymaps/utils/Helper","storymaps/utils/WebMapHelper","dojo/_base/lang","dojo/has","esri/IdentityManager","esri/request","esri/geometry/Extent","dojo/topic","dojo/on"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function b(e,t){v=e,m=t,$(document).ready(a.hitch(this,function(){console.log("swipe.builder.Builder - init");if(!o.getAppID(v.isProd())&&!app.isDirectCreation&&!app.isGalleryCreation){console.error("swipe.builder.Builder - abort builder initialization, no appid supplied");return}$("body").addClass("builder-mode"),m.init(y),g.init(m),y.init(m),y.initLocalization(),p.subscribe("BUILDER_INCREMENT_COUNTER",g.incrementSaveCounter),p.subscribe("HEADER_EDITED",x),window.onbeforeunload=function(e){e=e||window.event;if(!g.hasPendingChange())return;return e&&(e.returnValue=i18n.builder.builder.closeWithPendingChange),i18n.builder.builder.closeWithPendingChange}})),app.cleanApp=D}function w(){var e="",n="";t.getTitle()&&(e=t.getTitle().trim()),app.data.getAppItem()&&app.data.getAppItem().title&&(n=app.data.getAppItem().title.trim()),e||(e=n,e||app.data.getWebMapItem()&&app.data.getWebMapItem().item&&app.data.getWebMapItem().item.title&&(e=app.data.getWebMapItem().item.title.trim())),app.builder.titleMatchOnLoad=n==e;if(app.isDirectCreation||app.isGalleryCreation)app.builder.titleMatchOnLoad=!0;g.updateSharingStatus()}function E(){g.resize(),m.resize()}function S(){var e=new i("#initPopup");return e.init(),e.present()}function x(e){e.src=="title"?e.value!=app.data.getWebMapItem().item.title?e.value!=t.getTitle()&&(t.setTitle(e.value),g.incrementSaveCounter()):t.setTitle(""):e.src=="subtitle"&&(e.value!=app.data.getWebMapItem().item.snippet&&e.value!=i18n.builder.header.editMe?e.value!=t.getSubtitle()&&(t.setSubtitle(e.value),g.incrementSaveCounter()):t.setSubtitle(""))}function T(e,n){if(!app.portal){console.error("Fatal error - not signed in"),O("APP");return}app.portal.signIn().then(function(){var r=M(),i=a.clone(app.data.getAppItem()),s=i.owner||l.findCredential(r).userId,u=l.findCredential(r).token;delete i.avgRating,delete i.modified,delete i.numComments,delete i.numRatings,delete i.numViews,delete i.size,i.typeKeywords||(i.typeKeywords=[]),i.typeKeywords=i.typeKeywords.concat(APPCFG.WEBAPP_KEYWORD_APP),i.typeKeywords=i.typeKeywords.concat(APPCFG.WEBAPP_KEYWORD_GENERIC);var f=$.map(["swipe","spyglass"],function(e){return"layout-"+e});i.typeKeywords=$.grep(i.typeKeywords,function(e){return $.inArray(e,f)==-1}),i.typeKeywords.push("layout-"+(app.data.getWebAppData().values.layout||"swipe")),i.typeKeywords=$.grep(i.typeKeywords,function(e,t){return t==$.inArray(e,i.typeKeywords)}),i.tags=i.tags?i.tags.join(","):"",i.typeKeywords=i.typeKeywords.join(","),i.serviceProxyParams=JSON.stringify(i.serviceProxyParams);try{var p=app.data.getWebAppData().values.series;if(!p)i.extent=JSON.stringify(app.data.getWebMapItem().item.extent);else{var d=app.data.getWebAppData().values.bookmarks;if(!d||!d.length)i.extent=JSON.stringify(app.data.getWebMapItem().item.extent);else{var v=null,m=d[0].extent.spatialReference;!m||m.wkid!=102100&&m.wkid!=4326?i.extent=JSON.stringify(app.data.getWebMapItem().item.extent):($.each(d,function(e,t){e==0?v=new h(t.extent.toJson()):v=v.union(t.extent)}),i.extent=JSON.stringify(o.serializeExtentToItem(v)))}}}catch(g){}e||(i.title=t.getTitle()),i.properties&&(i.properties=JSON.stringify(i.properties)),i.url&&i.url.match(/apps\/[a-zA-Z]+\/\?appid=/)&&(i.url=i.url.replace("/?appid=","/index.html?appid=")),i=a.mixin(i,{f:"json",token:u,overwrite:!0,text:JSON.stringify(t.get())});var y=r+"/sharing/content/users/"+s+(i.ownerFolder?"/"+i.ownerFolder:"");i.id?y+="/items/"+i.id+"/update":y+="/addItem";var b=c({url:y,handleAs:"json",content:i},{usePost:!0});b.then(n,O)},function(e){O("APP",e)})}function N(e,t){if(!app.portal){console.error("Fatal error - not signed in"),O("APP");return}var n=l.findCredential(M()).userId;app.data.setAppItem(a.mixin(o.getBlankAppJSON(),{title:e,snippet:t,uploaded:Date.now(),modified:Date.now(),owner:n,access:"private"})),app.portal.signIn().then(function(){C(function(e){if(!e||!e.success){O("WEBMAP");return}T(!0,function(e){if(!e||!e.success){O("APP");return}var t=document.location.protocol+"//"+document.location.host+document.location.pathname;t.match(/index\.html$/)||(t+="index.html"),app.data.setAppItem(a.mixin(app.data.getAppItem(),{id:e.id,item:e.item,url:t+"?appid="+e.id})),T(!1,function(e){if(!e||!e.success){O("APP");return}console.log("swipe.builder.Builder - firstSaveForDirectCreation - appid:",e.id),A({success:!0}),app.isDirectCreationFirstSave=!1,app.isCreationLayout=!1,app.isCreationSpyglass=!1,g.updateSharingStatus(),History.replaceState({},"","index.html?appid="+e.id+"&edit")})})})},function(e){O("APP",e)})}function C(e){if(app.data.initialExtentHasBeenEdited||app.isDirectCreationFirstSave){var t=M(),n=a.clone(app.data.getWebMapItem().item),r=app.data.getWebMapItem().itemData,i=l.findCredential(t).userId,s=l.findCredential(t).token;u.prepareWebmapItemForCloning({itemData:r}),n.tags=n.tags?n.tags.join(","):"",n.typeKeywords=n.typeKeywords?n.typeKeywords.join(","):"";var o={f:"json",item:n.item,title:n.title,tags:n.tags,extent:JSON.stringify(n.extent),text:JSON.stringify(r),type:n.type,typeKeywords:n.typeKeywords,overwrite:!0,thumbnailURL:n.thumbnailURL,token:s};if(app.data.initialExtentHasBeenEdited){var f=c({url:t+"/sharing/content/users/"+i+(n.ownerFolder?"/"+n.ownerFolder:"")+"/addItem",handleAs:"json",content:o},{usePost:!0});f.then(A,O)}else e({success:!0})}else A({success:!0})}function k(e,t){e!="public"&&e!="account"&&(e="public");var n=[];e=="account"?((app.data.getWebMapItem().item.access=="private"||app.data.getWebMapItem().item.access=="shared")&&app.data.getWebMapItem().item.owner==app.portal.getPortalUser().username&&n.push(app.data.getWebMapItem().item.id),app.mode=="TWO_WEBMAPS"&&(app.data.getWebMapItem2().item.access=="private"||app.data.getWebMapItem2().item.access=="shared")&&app.data.getWebMapItem2().item.owner==app.portal.getPortalUser().username&&n.push(app.data.getWebMapItem2().item.id),(app.data.getAppItem().access=="private"||app.data.getAppItem().item.access=="shared")&&n.push(app.data.getAppItem().id)):(app.data.getWebMapItem().item.access!="public"&&app.data.getWebMapItem().item.owner==app.portal.getPortalUser().username&&n.push(app.data.getWebMapItem().item.id),app.mode=="TWO_WEBMAPS"&&app.data.getWebMapItem2().item.access!="public"&&app.data.getWebMapItem2().item.owner==app.portal.getPortalUser().username&&n.push(app.data.getWebMapItem2().item.id),app.data.getAppItem().access!="public"&&n.push(app.data.getAppItem().id)),L(n.join(","),e).then(function(r){var i=r&&r.results&&r.results.length==n.length;i&&($.each(r.results,function(e,t){t.success||(i=!1)}),app.data.getWebMapItem().item.access=e,app.data.getAppItem().access=e,g.updateSharingStatus()),t(i)})}function L(e,t){var n=M(),r=l.findCredential(n).userId,i=l.findCredential(n).token,s={f:"json",token:i,items:e,groups:"",everyone:"",account:""};return t=="public"&&(s.everyone=!0),t=="account"&&(s.account=!0),c({url:n+"/sharing/content/users/"+r+"/shareItems",handleAs:"json",content:s},{usePost:!0})}function A(e){e&&e.success?(g.saveSucceeded(),app.data.updateAfterSave()):O()}function O(e,t){g.saveFailed(e,t)}function M(){return configOptions.sharingurl.split("/sharing/")[0]}function _(){$(".esriSignInDialog").find("#dijitDialogPaneContentAreaLoginText").css("display","none"),$(".esriSignInDialog").find(".dijitDialogPaneContentArea:first-child").find(":first-child").first().after("<div id='dijitDialogPaneContentAreaAtlasLoginText'>"+i18n.builder.builder.signIn+" <a href='http://"+l._arcgisUrl+"' title='"+l._arcgisUrl+"' target='_blank'>"+l._arcgisUrl+"</a> "+i18n.builder.builder.signInTwo+"</div>"),d(l,"dialog-cancel",function(e){$("#builderPanel .builder-settings").popover("hide")})}function D(){if(!app.portal){console.error("Fatal error - not signed in");return}return app.portal.signIn().then(function(){var e=M(),n=l.findCredential(e).userId,r=l.findCredential(e).token,i=a.clone(app.data.getAppItem());delete i.avgRating,delete i.modified,delete i.numComments,delete i.numRatings,delete i.numViews,delete i.size,i=a.mixin(i,{f:"json",token:r,overwrite:!0,text:JSON.stringify(t.getBlank())});var s=c({url:e+"/sharing/content/users/"+n+(i.ownerFolder?"/"+i.ownerFolder:"")+"/addItem",handleAs:"json",content:i},{usePost:!0});s.then(function(){console.log("Web Application data cleaned successfully")},function(){console.log("Web Application data cleaning has failed")})},function(e){console.error("Web Application data cleaning has failed",e)}),"Cleaning ..."}var v=null,m=null,g=new n($("#builderPanel"),T,N,C),y=new r($("#settingsPopup"),APPCFG.COLOR_SCHEMES,APPCFG.HEADER_LOGO_URL);return{init:b,resize:E,appInitComplete:w,presentInitPopup:S,shareAppAndWebmap:k}}),define("storymaps/swipe/builder/HelpPopup",[],function(){return function(t){function i(){t.find("h3").html(i18n.swipe.helpPopup.title),t.find(".btnClose").html(i18n.swipe.helpPopup.close),t.find("#help-tab1").html(i18n.swipe.helpPopup.tab1.div1+"<br /><br />"),t.find("#help-tab2").html(i18n.swipe.helpPopup.tab1.div2+"<br /><br />"),t.find("#help-tab3").html(i18n.swipe.helpPopup.tab1.div3+"<br />"),n=!0}var n=!1,r=t.find(".btnClose");this.present=function(e){n||i(),r.removeAttr("disabled"),t.find(".modal-header .close").attr("data-dismiss","modal"),$(t).modal({keyboard:!0})},this.initLocalization=function(){}}}),define("storymaps/swipe/builder/SharePopup",["storymaps/utils/Helper"],function(e){return function(n){function r(t,r){n.find("h3").html(i18n.swipe.share.firstSaveTitle);var i=app.isPortal?e.getMyStoriesURL():"//storymaps.arcgis.com/en/my-stories/";n.find(".saved-tip").html(i18n.swipe.share.manageStoryA1.replace("%LINK1%",'<a href="'+i+'" target="_blank">'+i18n.swipe.share.manageStoryA1V1+"</a>").replace("%LINK2%",'<a href="http://links.esri.com/storymaps/my_stories_blog_posts" target="_blank">'+i18n.swipe.share.manageStoryA1V2+"</a>")),n.find(".first-save").removeClass("hide")}function i(e,t,r,i){n.find(".share .not-shared .header").html(i18n.swipe.share.sharePrivateHeader),n.find(".not-shared .btn-sharePublic").html(i18n.swipe.share.sharePrivateBtn1),app.portal&&app.portal.canSharePublic!==undefined&&!app.portal.canSharePublic?n.find(".not-shared .btn-sharePublic").addClass("disabled").popover({trigger:"hover",placement:"top",html:!0,content:i18n.builder.settingsHeader.settingsLogoSocialDisabled}):n.find(".btn-sharePublic").off("click").on("click",function(){u("public",i)}),app.portal&&app.portal.isOrganization?(n.find(".not-shared .btn-shareOrga").html(i18n.swipe.share.sharePrivateBtn2),n.find(".btn-shareOrga").off("click").on("click",function(){u("account",i)})):n.find(".not-shared .btn-shareOrga").remove();var s=!1;if(app.data.getWebMapItem().item.owner!=app.portal.getPortalUser().username){var o=null;if(app.data.getWebMapItem().item.access=="account")o=i18n.swipe.share.shareWarningWith1,n.find(".not-shared .btn-sharePublic").addClass("disabled").off("click");else if(app.data.getWebMapItem().item.access=="private"||app.data.getWebMapItem().item.access=="shared")o=i18n.swipe.share.shareWarningWith2,n.find(".not-shared .btn-sharePublic, .not-shared .btn-shareOrga").addClass("disabled").off("click");o&&(s=!0,n.find(".share-warning").html(i18n.swipe.share.shareWarning.replace("%WITH%",o).replace("%LINK%",r)).show())}if(app.mode=="TWO_WEBMAPS"){var a=r.substring(0,r.length-32)+app.data.getWebMapItem2().item.id;if(app.data.getWebMapItem2().item.owner!=app.portal.getPortalUser().username){var o=null;if(app.data.getWebMapItem2().item.access=="account")o=i18n.swipe.share.shareWarningWith1,n.find(".not-shared .btn-sharePublic").addClass("disabled").off("click");else if(app.data.getWebMapItem2().item.access=="private"||app.data.getWebMapItem2().item.access=="shared")o=i18n.swipe.share.shareWarningWith2,n.find(".not-shared .btn-sharePublic, .not-shared .btn-shareOrga").addClass("disabled").off("click");o&&!s&&n.find(".share-warning").html(i18n.swipe.share.shareWarning.replace("%WITH%",o).replace("%LINK%",a)).show(),o&&s&&n.find(".share-warning").html(i18n.swipe.share.shareWarning.replace("%WITH%",o).replace("%LINK%",r)+"<br>"+"<br>"+i18n.swipe.share.shareWarning.replace("%WITH%",o).replace("%LINK%",a)).show()}}n.find(".modal-footer .error").html(i18n.swipe.share.sharePrivateErr+" "+i18n.swipe.share.shareA1.toLowerCase().replace("%shareimg%",'<img src="resources/icons/builder-share-shareBtn.png" style="vertical-align: -5px;"/>').replace("%link1%",e)),n.find(".not-shared .btn-learnmore").html(i18n.swipe.share.learnMore),n.find(".btn-learnmore").off("click").on("click",function(){window.open("https://storymaps.arcgis.com/en/app-list/swipe-spyglass/","_blank")}),n.find(".not-shared .btn-preview").html(i18n.swipe.share.sharePreviewAsUser),n.find(".btn-preview").off("click").on("click",function(){window.open(t,"_blank")})}function s(t,r,i,s){n.find(".shared-dialog .header").html(app.data.getAppItem().access=="public"?i18n.swipe.share.shareHeader1:i18n.swipe.share.shareHeader2),n.find(".share-link").html("<div>"+i18n.swipe.share.shareLinkHeader+'<div style="margin-top: 5px;">'+'<input type="text" style="height: 20px; font-size: 20px; width: 200px; text-align: center;" id="firstSavebitly1" value="'+t+'" />'+' <a class="btn collapse-btn" href="'+t+'" target="_blank" style="vertical-align: 4px">'+i18n.swipe.share.shareLinkOpen+"</a>"+"</div>"+"</div>");var o=app.isPortal?e.getMyStoriesURL():"//storymaps.arcgis.com/en/my-stories/";n.find(".shared-tip").html(i18n.swipe.share.manageStoryA1.replace("%LINK1%",'<a href="'+o+'" target="_blank">'+i18n.swipe.share.manageStoryA1V1+"</a>").replace("%LINK2%",'<a href="http://links.esri.com/storymaps/my_stories_blog_posts" target="_blank">'+i18n.swipe.share.manageStoryA1V2+"</a>")),APPCFG.HEADER_SOCIAL&&APPCFG.HEADER_SOCIAL.bitly&&APPCFG.HEADER_SOCIAL.bitly.enable?(c(t,"#firstSavebitly1"),c(t+"&edit","#firstSavebitly3")):setTimeout(function(){$("#firstSavebitly1").select()},100)}function o(e){n.find(".share").removeClass("hide"),n.find(".not-shared").toggleClass("hide",!e),n.find(".shared-dialog").toggleClass("hide",e)}function u(e,t){a(),app.builder.shareAppAndWebmap(e,function(e){e?(t(),f()):l()})}function a(){n.find(".modal-footer .footer-status").hide(),n.find(".share .btn, .btnClose").attr("disabled","disabled"),n.find(".modal-footer .success").html(i18n.swipe.share.sharePrivateProgress),n.find(".modal-footer .success").show(),n.find(".modal-footer .error").hide()}function f(){n.find(".modal-footer .success").html(i18n.swipe.share.sharePrivateOk),setTimeout(function(){n.find(".modal-footer .success").hide(),o(!1),n.find(".share .btn, .btnClose").removeAttr("disabled"),$("#firstSavebitly1").select()},1500)}function l(){n.find(".modal-footer .success").hide(),n.find(".modal-footer .error").show(),n.find(".share .btn, .btnClose").removeAttr("disabled")}function c(e,t){var r=["http://api.bitly.com/v3/shorten?callback=?","https://api-ssl.bitly.com/v3/shorten?callback=?"],i=location.protocol=="http:"?r[0]:r[1];$.getJSON(i,{format:"json",apiKey:APPCFG.HEADER_SOCIAL.bitly.key,login:APPCFG.HEADER_SOCIAL.bitly.login,longUrl:e},function(e){if(!e||!e||!e.data.url)return;n.find(t).val(e.data.url),t=="#firstSavebitly1"?$("#firstSavebitly1").select():t=="#firstSavebitly2"&&$("#firstSavebitly2").select()})}this.present=function(t){var u=document.location.protocol+"//"+document.location.host+document.location.pathname+"?appid="+app.data.getAppItem().id,a=e.getItemURL(configOptions.sharingurl,app.data.getAppItem().id),f=e.getItemURL(configOptions.sharingurl,app.data.getWebMapItem().item.id),l=e.getMyContentURL(configOptions.sharingurl);n.find(".share, .first-save, .not-shared").addClass("hide"),n.find(".modal-footer .success, .modal-footer .error").hide();if(t)r(u,l);else{var c=app.data.getAppItem().access=="private"||app.data.getAppItem().access=="shared";c?i(a,u,f,function(){s(u,a,f,l)}):s(u,a,f,l),n.find("h3").html(i18n.swipe.share.shareTitle),o(c)}n.find(".btnClose").html(i18n.swipe.helpPopup.close),n.find(".modal-header .close").attr("data-dismiss","modal"),$(n).modal({keyboard:!0}),$(".collapse.in").collapse("hide")}}}),define("storymaps/swipe/builder/InitMapPicker",["dojo/on","storymaps/swipe/core/WebApplicationData"],function(e,t){return function(r){function i(){r.find(".webmap-id-input").find("input").val().length!=32?r.find(".btnClose").attr("disabled","disabled"):r.find(".btnClose").attr("disabled",!1)}function s(){t.setWebmap(r.find(".webmap-id-input").find("input").val()),app.rootMapId=r.find(".webmap-id-input").find("input").val(),t.setWebmaps([r.find(".webmap-id-input").find("input").val()]),_loadWebMap(r.find(".webmap-id-input").find("input").val()),$("#loadingIndicator").show(),$("#loadingMessage").css("visibility","visible")}_loadWebMap=null,$(r).find(".webmap-id-input").keyup(i),$(r).find(".webmap-id-input").bind("paste",null,function(){setTimeout(function(){i()},250)}),app.builder.openMapPicker=function(){r.hide(),app.browseDlg.show()},this.present=function(e){_loadWebMap=e,r.find("h3").html(i18n.swipe.directCreation.header),r.find(".webmap-id-input").html("<div>"+i18n.swipe.directCreation.explain2+'<div style="margin-top: 10px;">'+'<input type="text" maxlength="32" style="height: 20px; font-size: 20px; width: 350px; text-align: left;" id="firstMapInput" value="" />'+' <a class="btn collapse-btn" style="vertical-align: 4px" onClick="app.builder.openMapPicker()"><i class="icon-search"></i></a>'+"</div>"+"</div>"),r.find(".btnClose").html(i18n.swipe.initPopup.modalNext),r.find(".btnClose").attr("disabled","disabled"),$(r).modal({keyboard:!1})},e(r.find(".btnClose"),"click",s)}}),define("storymaps/builder/SettingsPopupTabColors",[],function(){return function(t,n,r){function u(){return $("input[name=groupColorSchemes]:checked",n).val()}function a(e){if(!e||!e[0]||!e[1])c(1);else{var t=!1;$.each(r,function(n,r){var i=e[0]==r.headerColor&&e[1]==r.panelColor;i&&(t=!0,c(n+1))}),t||c(r.length+1)}f()}function f(){l()==r.length?($(s).spectrum("enable"),$(o).spectrum("enable")):($(s).spectrum("disable"),$(o).spectrum("disable"))}function l(){var e=-1;return $(n).find(".controls tr td:nth-child(1) input").each(function(t,n){$(n).is(":checked")&&(e=t)}),e}function c(e){$(n).find(".controls tr:nth-child("+e+") td:nth-child(1) input").attr("checked","true")}function h(e){$(e).spectrum({showButtons:!1,color:APPCFG.COLORS[0],showPalette:!1,showSelectionPalette:!1,showPaletteOnly:!1,showInput:!0})}function p(){f();if(l()==r.length)$("#headerSimulator",n).css("background-color",$(s).val());else{var e=$.grep(r,function(e){return e.name==u()})[0];$("#headerSimulator",n).css("background-color",e.headerColor)}}function d(){if(!r)return;var e=$("<table></table>"),t;return $.each(r,function(n,r){if(!r.name||!r.headerColor||!r.panelColor)return;t=$("<tr></tr>");var i=$("<input type='radio' class='radio' name='groupColorSchemes'/>");$(i).attr("value",r.name);var s=$("<td></td>");$(s).append(i),$(t).append(s),$(t).append("<td><div class='swatch' style='background-color:"+r.headerColor+"'></div></td>"),$(t).append("<td><div class='swatch' style='background-color:"+r.panelColor+"'></div></td>"),$(e).append(t)}),t=$("<tr></tr>"),$(t).append("<td><input type='radio' class='radio' name='groupColorSchemes' value='schemeCustom'/></td>"),$(t).append("<td><input id='inputCustomHeaderColor' class='colorInput' type='custom'/></td>"),$(t).append("<td><input id='inputCustomMiddleColor' class='colorInput' type='custom'/></td>"),$(e).append(t),e}r.splice(0,0,{name:"Gray",headerColor:APPCFG.COLORS[0],panelColor:APPCFG.COLORS[1]});var i=d(),s=$(i).find("#inputCustomHeaderColor"),o=$(i).find("#inputCustomMiddleColor");h(s),h(o),$(n).find("#colorScheme .controls").append(i),$(s).spectrum("set",APPCFG.COLORS[0]),$(o).spectrum("set",APPCFG.COLORS[1]),$("input[name=groupColorSchemes]",i).click(p),this.init=function(e){a(e.colors);var t=$("input[name=groupColorSchemes]",n).length;$("input[name=groupColorSchemes]",n).eq(t-1).attr("checked")=="checked"&&($(s).spectrum("set",e.colors[0]),$(o).spectrum("set",e.colors[1]))},this.show=function(){},this.save=function(){var e=u(),t;if(e=="schemeCustom")t=[$(s).val(),$(o).val()];else{var n=$.grep(r,function(t){return t.name==e})[0];t=[n.headerColor,n.panelColor]}return{colors:t}},this.initLocalization=function(){$(t).html(i18n.builder.settingsColors.settingsTabColor),$(n).find("p").html(i18n.builder.settingsColors.settingsColorExplain),$(n).find(".control-label").html(i18n.builder.settingsColors.settingsLabelColor+":")}}}),define("storymaps/builder/SettingsPopupTabHeader",["storymaps/utils/Helper"],function(e){return function(n,r,i){function a(){d()}function f(){}function l(){u=!0,$("#imgLogo",r).hide()}function c(e){if(e.keyCode==13)return u=!1,h(),!1;e.keyCode==8&&($("#logoTargetInput").focus(),$("#logoInput").focus())}function h(){var e=$.trim($("#logoInput",r).val());e&&($("#imgLogo",r).attr("src",e),$("#imgLogo",r).show())}function p(e){e.keyCode==8&&($("#logoInput").focus(),$("#logoTargetInput").focus())}function d(){var e=$("input[name=optionsLogo]:checked",r).val();$("#imgLogo",r).hide(),e=="custom"?h():e=="esri"&&($("#imgLogo",r).attr("src",i),$("#imgLogo",r).show())}var s=$(r).find("#logoInput"),o=$(r).find("#logoTargetInput"),u=!1;$(s).keydown(c),$(s).blur(h),$(o).keydown(p),$("input[type=radio]",r).click(a),$("#imgLogo",r).error(l),$("#imgLogo",r).load(f),this.init=function(e){var t=e.logoURL;s.attr("disabled","true"),o.attr("disabled","true"),$("input[name='optionsLogo']",$(r)).change(function(){var e=$("input[name='optionsLogo']:checked",$(r)).val();e=="none"||e=="esri"?(s.attr("disabled","true"),o.attr("disabled","true")):(s.removeAttr("disabled"),o.removeAttr("disabled"))}),$("#headerSimulator",r).css("background-color",e.colors[0]),t==null?($("input[name=optionsLogo]:eq(1)",r).attr("checked","checked"),s.val(""),o.val("")):t==i?($("input[name=optionsLogo]:eq(0)",r).attr("checked","checked"),$("#imgLogo",r).show(),s.val(""),o.val("")):($("input[name=optionsLogo]:eq(2)",r).attr("checked","checked"),$("#imgLogo",r).attr("src",t),$("#imgLogo",r).show(),$("#logoInput",r).val(t),o.val(e.logoTarget),s.removeAttr("disabled"),o.removeAttr("disabled")),$("#selectSocialText",r).val(e.linkText),$("#selectSocialLink",r).val(e.linkURL),$("#selectSocialText",r).blur(function(){$(window).scrollTop(0)}),$("#selectSocialLink",r).blur(function(){$(window).scrollTop(0)}),$("#logoInput",r).blur(function(){$(window).scrollTop(0)}),o.blur(function(){$(window).scrollTop(0)}),APPCFG.HEADER_SOCIAL.facebook?(!e.social||e.social.facebook)&&$(".enableFB",r).prop("checked",!0):$(".enableFB",r).attr("disabled","disabled").parent().addClass("disabled").attr("title",i18n.builder.settingsHeader.settingsLogoSocialDisabled),APPCFG.HEADER_SOCIAL.twitter?(!e.social||e.social.twitter)&&$(".enableTwitter",r).prop("checked",!0):$(".enableTwitter",r).attr("disabled","disabled").parent().addClass("disabled").attr("title",i18n.builder.settingsHeader.settingsLogoSocialDisabled),!APPCFG.HEADER_SOCIAL.bitly||!APPCFG.HEADER_SOCIAL.bitly.enable||!APPCFG.HEADER_SOCIAL.bitly.login||!APPCFG.HEADER_SOCIAL.bitly.key?$(".enableBitly",r).attr("disabled","disabled").parent().addClass("disabled").attr("title",i18n.builder.settingsHeader.settingsLogoSocialDisabled):(!e.social||e.social.bitly)&&$(".enableBitly",r).prop("checked",!0),d()},this.show=function(){},this.save=function(){var t=$("input[name=optionsLogo]:checked",r).val(),n,s;t=="none"?(n=null,s=""):t=="esri"?(n=i,s=""):(n=u?i:$("#imgLogo",r).attr("src"),s=o.val());var a=$("#selectSocialText",r).val()||"";a=a.replace(/<\/?script>/g,"");var f=$("#selectSocialLink",r).val()||"";return f=f.replace(/<\/?script>/g,""),{logoURL:n,logoTarget:e.prependURLHTTP(s),linkText:a,linkURL:e.prependURLHTTP(f),social:{facebook:$(".enableFB").prop("checked"),twitter:$(".enableTwitter").prop("checked"),bitly:$(".enableBitly").prop("checked")}}},this.initLocalization=function(){$(n).html(i18n.builder.settingsHeader.settingsTabLogo),$(r).find("p").eq(0).html(i18n.builder.settingsHeader.settingsLogoExplain),$(r).find(".logoText").eq(0).html(i18n.builder.settingsHeader.settingsLogoEsri),$(r).find(".logoText").eq(1).html(i18n.builder.settingsHeader.settingsLogoNone),$(r).find(".logoText").eq(2).html(i18n.builder.settingsHeader.settingsLogoCustom),$(r).find("#logoInput").attr("placeholder",i18n.builder.settingsHeader.settingsLogoCustomPlaceholder),$(r).find("#logoTargetInput").attr("placeholder",i18n.builder.settingsHeader.settingsLogoCustomTargetPlaceholder),$(r).find("p").eq(1).html(i18n.builder.settingsHeader.settingsLogoSocialExplain),$(r).find(".control-label[for=selectSocialText]").html(i18n.builder.settingsHeader.settingsLogoSocialText+":"),$(r).find(".control-label[for=selectSocialLink]").html(i18n.builder.settingsHeader.settingsLogoSocialLink+":"),$(r).find(".header-share-label").html(i18n.builder.builder.buttonShare)}}}),define("storymaps/builder/SettingsPopupTabExtent",["storymaps/utils/Helper","esri/map","esri/toolbars/draw","esri/toolbars/edit","esri/layers/GraphicsLayer","esri/geometry/Extent","esri/graphic","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/geometry/webMercatorUtils","esri/SpatialReference","dojo/Deferred","esri/config","dojo/_base/Color","dojo/topic","dojo/on","dojo/_base/connect","dojo/_base/event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){return function(b,w){function M(o){if(!app.maps)return;E&&E.destroy(),E=null,$(b).removeClass("alreadyOpened"),o||(o=new s({xmax:-57.98033474158346,xmin:-126.91406249996473,ymax:50.25667033538553,ymin:21.9430455334323,spatialReference:{wkid:4326}})),E=new t("extentMap",{slider:!0,center:o.getCenter(),extent:o.expand(2),autoResize:!1});var u=new i({id:"extentlayer"});v(E,"load",function(){k=new n(E),L=new r(E),m.connect(k,"onActivate",function(){u.clear(),L.deactivate(),C=!0}),m.connect(k,"onDrawEnd",function(e){D(e).then(function(t){P(t),u.add(_(e)),k.deactivate(),C=!1},function(){P(!0,!0)})}),v(L,"graphic-move-stop",function(e){D(e.graphic.geometry).then(function(e){P(e)},function(){P(!0,!0)})}),v(L,"scale-stop",function(e){D(e.graphic.geometry).then(function(e){P(e)},function(){P(!0,!0)})}),v(u,"click",function(e){C||(g.stop(e),L.activate(r.MOVE|r.SCALE,e.graphic))}),m.connect(u,"onMouseOver",function(){E.setMapCursor("pointer")}),m.connect(u,"onMouseOut",function(){E.setMapCursor("default")}),v(E,"click",function(){L.deactivate()})});var a=app.mainMap.getLayer(app.mainMap.layerIds[0]);E.addLayer(e.cloneLayer(a)),o.spatialReference.wkid!=a.spatialReference.wkid?h.defaults.geometryService.project([o],a.spatialReference).then(function(e){e&&e[0]&&(A=e[0],u.add(_(e[0])),E.addLayer(u))}):(u.add(_(o)),E.addLayer(u)),O=e.extentToPolygon(o)}function _(t){return new o(e.extentToPolygon(t),new u(u.STYLE_SOLID,new a(a.STYLE_DASHDOT,new p([255,0,0]),2),new p([255,255,0,.25])))}function D(e){var t=new c,n=function(e){t.resolve(e.xmin>0&&e.xmax<0||e.xmin>e.xmax),O=e};return e||t.reject(),e.type=="polygon"&&(e=e.getExtent()),e.spatialReference.wkid==102100&&(e=f.webMercatorToGeographic(e)),e.spatialReference.wkid!=4326?h.defaults.geometryService.project([e],new l(4326)).then(function(e){!e||!e[0]?t.reject():n(e[0])}):n(e),t}function P(e,t){$(w).find(".dateLineError").toggle(e).html(t?i18n.builder.settingsExtent.settingsExtentDateLineError2:i18n.builder.settingsExtent.settingsExtentDateLineError)}function H(){return E.getLayer("extentlayer")&&E.getLayer("extentlayer").graphics&&E.getLayer("extentlayer").graphics.length>0?E.getLayer("extentlayer").graphics[0]:null}var E=null,S=$(w).find("#extentDraw"),x=$(w).find("#extentModify"),T=$(w).find("#extentUseMainMap"),N=$(w).find("#extentApply"),C=!1,k=null,L=null,A=null,O=null;S.click(function(){k.activate(n.EXTENT)}),x.click(function(){var e=H();e&&L.activate(r.MOVE|r.SCALE,e)}),T.click(function(){k.deactivate(),C=!1;var e=E.getLayer("extentlayer");e.clear(),e.add(_(app.mainMap.extent)),E.setExtent(app.mainMap.extent.expand(2)),O=app.mainMap.extent}),N.click(function(){var e=H();e&&d.publish("CORE_UPDATE_EXTENT",e.geometry.getExtent())}),this.init=function(e){M(e.extent)},this.show=function(){$(b).hasClass("alreadyOpened")||(E.resize(),v.once(E,"update-end",function(){A?E.setExtent(A.expand(2)):E.centerAt(E.getLayer("extentlayer").graphics[0].geometry.getExtent().getCenter())}),$(b).addClass("alreadyOpened"))},this.save=function(){return $(w).find(".dateLineError").css("display")=="block"?!1:{extent:O.getExtent()}},this.initLocalization=function(){$(b).html(i18n.builder.settingsExtent.settingsTabExtent),$(w).find("p").html(i18n.builder.settingsExtent.settingsExtentExplain),$(w).find(".explain2").html(i18n.builder.settingsExtent.settingsExtentExplainBottom),$(w).find(".dateLineError").html(i18n.builder.settingsExtent.settingsExtentDateLineError),S.html(i18n.builder.settingsExtent.settingsExtentDrawBtn),x.html(i18n.builder.settingsExtent.settingsExtentModifyBtn),T.html(i18n.builder.settingsExtent.settingsExtentUseMainMap),N.html(i18n.builder.settingsExtent.settingsExtentApplyBtn)}}}),define("storymaps/swipe/builder/BuilderView",["storymaps/swipe/core/WebApplicationData","storymaps/builder/SettingsPopup","storymaps/utils/Helper","storymaps/swipe/builder/HelpPopup","storymaps/swipe/builder/SharePopup","storymaps/swipe/builder/InitMapPicker","storymaps/swipe/builder/SettingsPopupTabDataModel","storymaps/swipe/builder/SettingsPopupTabLayout","storymaps/swipe/builder/SettingsPopupTabLegend","storymaps/swipe/builder/SettingsPopupTabSwipePopup","storymaps/builder/SettingsPopupTabColors","storymaps/builder/SettingsPopupTabHeader","storymaps/builder/SettingsPopupTabExtent","dojo/topic"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return function(){function b(t){console.log("settingsPopupSave data = ",t);var r=e.getLayout();e.setLayout(t.settings[0].layout),e.setDataModel(t.settings[1].dataModel),e.setWebmaps(t.settings[1].webmaps),e.setLayers(t.settings[1].layers),e.setLegend(t.settings[2].legend),e.setDescription(t.settings[2].description),e.setSeries(t.settings[2].series),e.setSeriesBookmarks(t.settings[2].bookmarks),e.setPopup(t.settings[2].popup),e.setLocationSearch(t.settings[2].locationSearch),e.setGeolocator(t.settings[2].geolocator),e.setPopupColors(t.settings[3].popupColors),e.setPopupTitles(t.settings[3].popupTitles),e.setColors(t.settings[4].colors[0],t.settings[4].colors[1]),e.setHeaderLink(t.settings[5].linkText,t.settings[5].linkURL);var i=t.settings[5].logoURL;i?i==APPCFG.HEADER_LOGO_URL?e.setLogoURL(null):e.setLogoURL(i):e.setLogoURL(d),e.setLogoTarget(t.settings[5].logoTarget),e.setSocial(t.settings[5].social);var s=n.serializeExtentToItem(t.settings[6].extent);n.serializedExtentEquals(s,app.data.getWebMapItem().item.extent)||(app.data.getWebMapItem().item.extent=s,app.data.initialExtentHasBeenEdited=!0),r=="swipe"?app.mapSwipe.updateSettings(e.getPopupColors(),e.getPopupTitles()):app.spyGlass.updateSettings(e.getPopupColors(),e.getPopupTitles()),p.publish("BUILDER_INCREMENT_COUNTER",1),p.publish("CORE_UPDATE_UI")}function w(){var t=e.getLogoURL();return t?t==d&&(t=null):t=APPCFG.HEADER_LOGO_URL,t}function E(e){m.present(e)}function S(e){g.present(e)}function x(e){y.present(e)}function T(e){e==1?$(".settingsPopupHeader").find(".tab").eq(3).removeClass("disabled"):$(".settingsPopupHeader").find(".tab").eq(3).addClass("disabled")}var d="NO_LOGO",v=null,m=new r($("#helpPopup")),g=new i($("#sharePopup")),y=new s($("#initMapPopup"));this.init=function(e){v=e,p.subscribe("SETTINGS_POPUP_SAVE",b),p.subscribe("POPUP_CHANGE",T),app.builder.openHelpPopup=E,app.builder.openSharePopup=S,app.builder.initMapPicker=x},this.getSettingsTab=function(e,t,n,r){return[new u(e.eq(0),t.eq(0)),new o(e.eq(1),t.eq(1),n),new a(e.eq(2),t.eq(2)),new f(e.eq(3),t.eq(3)),new l(e.eq(4),t.eq(4),r.colorSchemes),new c(e.eq(5),t.eq(5),r.defaultLogoURL),new h(e.eq(6),t.eq(6))]},this.openSettingPopup=function(t){v.present([{layout:e.getLayout()},{dataModel:e.getDataModel(),layers:e.getLayers(),webmaps:e.getWebmaps(),layout:e.getLayout(),webmap:e.getWebmap()},{legend:e.getLegend(),description:e.getDescription(),bookmarks:e.getSeries(),popup:e.getPopup(),locationSearch:e.getLocationSearch(),geolocator:e.getGeolocator()},{popupColors:e.getPopupColors(),popupTitles:e.getPopupTitles(),layout:e.getLayout()},{colors:e.getColors()},{logoURL:w(),logoTarget:e.getLogoTarget(),linkText:e.getHeaderLinkText()==undefined?APPCFG.HEADER_LINK_TEXT:e.getHeaderLinkText(),linkURL:e.getHeaderLinkURL()==undefined?APPCFG.HEADER_LINK_URL:e.getHeaderLinkURL(),colors:e.getColors(),social:e.getSocial()},{extent:n.getWebMapExtentFromItem(app.data.getWebMapItem().item)}]),T(app.isPopup)},this.resize=function(){}}}),require(["storymaps/ui/loadingIndicator/LoadingIndicator","storymaps/core/Core","storymaps/swipe/core/MainView","storymaps/builder/Builder","storymaps/swipe/builder/BuilderView"],function(){}),define("storymaps/swipe/BuildConfigBuilder",function(){});